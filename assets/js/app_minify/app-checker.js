define(["jquery","jquery-ui","bootstrap","qtip","keyboard"],function(a,b){return{nodeUrl:a("#node_url").val(),baseUrl:a("#base_url").val(),theme:a("#theme").val(),socket:!1,loadingOverlay:a("#cover"),timeoutVal:1e4,ip_address:a("#ip_address").val(),init:function(){AppChecker.loadingOverlay.show(),AppChecker.initFunc(AppChecker);try{AppChecker.initSocketIO()}catch(b){AppChecker.alert(a("#server-error-message p").text())}},initSocketIO:function(){AppChecker.socket=io(AppChecker.nodeUrl,{reconnectionAttempts:2}),AppChecker.socket.on("reconnect_failed",function(){AppChecker.alert(a("#server-error-message p").text()),window.location.reload(!0)}),AppChecker.socket.on("connected",function(a){console.log("Socket.IO connected"),AppChecker.socket.emit("cm_auth",{nip:AppChecker.userId,name:AppChecker.userName,role:AppChecker.groupId,role_name:AppChecker.groupName,ip_address:AppChecker.ip_address}),AppChecker.socket.on("sm_auth",function(a){AppChecker.loadingOverlay.hide(),AppChecker.initUIEvent()}),AppChecker.socket.on("sm_notify_new_order",function(a){void 0!=a.notification&&null!=a.notification&&(AppChecker.prependNotif(a.notification),AppChecker.updateOpenNotifBar())}),AppChecker.socket.on("sm_notify_cooking_status",function(a){null!=a.notification&&(AppChecker.prependNotif(a.notification),AppChecker.updateOpenNotifBar())}),AppChecker.socket.on("sm_notify_cooking_status_refresh",function(a){}),AppChecker.socket.on("sm_notify_new_order",function(a){}),AppChecker.socket.on("sm_notify_checker",function(a){AppChecker.getDetailView()})})},initUIEvent:function(){a("#string_number").length>0&&AppChecker.initKeyboardNumber(a("#string_number")),a("#print_number").on("click",function(){string_number=a("#string_number").val(),""!=string_number&&a.ajax({url:AppChecker.baseUrl+"checker/print_number",data:{string_number:string_number}})}),a(".slide-down").length>0&&(a("nav").hide(),a("#header_store").hide()),a(document).on("click",".slide-up",function(){a(this).removeClass("slide-up").addClass("slide-down"),slide="slide-down",a.ajax({url:AppChecker.baseUrl+"checker/set_slide_setting",data:{slide:slide}}),a(this).find("i").removeClass("fa-arrow-up").addClass("fa-arrow-down"),a("nav").hide(),a("#header_store").hide()}),a(document).on("click",".slide-down",function(){a(this).removeClass("slide-down").addClass("slide-up"),slide="slide-up",a.ajax({url:AppChecker.baseUrl+"checker/set_slide_setting",data:{slide:slide}}),a(this).find("i").removeClass("fa-arrow-down").addClass("fa-arrow-up"),a("nav").show(),a("#header_store").show()}),a(document).on("click","#pagination_left .pagination a",function(){var b=a(this).attr("href");return a.ajax({url:b,dataType:"JSON",success:function(b){a("#regular_content").html(b.content)}}),!1}),a(document).on("click","#pagination_right .pagination a",function(){var b=a(this).attr("href");return a.ajax({url:b,dataType:"JSON",success:function(b){a("#additional_content").html(b.content)}}),!1}),a(document).on("click",".choice_type",function(){value=a(this).val(),is_checked=a(this).is(":checked"),a.ajax({url:AppChecker.baseUrl+"checker/set_choice_type",data:{is_checked:is_checked,value:value},success:function(a){window.location.reload()}})}),a(document).on("click",".btn-ready",function(){a(this).hasClass("active")?a(this).removeClass("active"):a(this).addClass("active"),a(this).blur()}),a(document).on("click","#btn-notif",function(b){var c={direction:"right"};a(".notification-container").toggle("slide",c,500),a(".notification-container").addClass("open-notif"),AppChecker.updateOpenNotifBar()}),a(document).on("click",".button-hide",function(b){var c={direction:"right"};a(".notification-container").toggle("slide",c,500);for(var d=a(".unseen-notif"),e=d.length-1;e>=0;e--){var f=d.eq(e).attr("data-id");AppChecker.updateNotifCounter("-"),a("#notif-"+f+" ").removeClass("unseen-notif")}}),a(".notification-container").removeClass("open-notif"),a(document).on("click",".print_list_menu",function(){order_id=a(this).attr("order-id"),cooking_status=a(this).attr("cooking-status"),AppChecker.loadingOverlay.show(),url=AppChecker.baseUrl+"checker/print_list_menu",order_menu_ids=new Array,a(this).parents("li:first").find(".kitchen-table tbody input#menu_order_id").each(function(){order_menu_ids.push(a(this).val())});var b=a.ajax({type:"POST",url:url,data:{order_id:order_id,cooking_status:cooking_status,order_menu_ids:order_menu_ids}});b.done(function(){AppChecker.loadingOverlay.hide()}),b.fail(function(){AppChecker.loadingOverlay.hide()})}),a(document).on("click",".btn-mode2-checklist",function(b){AppChecker.loadingOverlay.show(),a(this).hasClass("active")?is_check=0:is_check=1,b.preventDefault();var c=a(this).parents("tr").find("#menu_order_id"),d=c.val();order_package_menu_id=parseInt(c.attr("order_package_menu_id")),isNaN(order_package_menu_id)&&(order_package_menu_id=0);var e=this;a.ajax({type:"POST",url:AppChecker.baseUrl+"checker/update_checklist",data:{order_menu_id:d,order_package_menu_id:order_package_menu_id,is_check:is_check}}).done(function(b){a(e).hasClass("active")?a(e).removeClass("active"):a(e).addClass("active"),AppChecker.loadingOverlay.hide()}).fail(function(){AppChecker.alert("Gagal memperbaharui status. Silahkan coba lagi. Jika masalah masih terjadi mohon hubungi administrator."),AppChecker.loadingOverlay.hide()})}),a(document).on("click",".btn-mode2-post",function(){var b=(a(this).attr("url"),a(this).parents("li:first").find(".kitchen-table").attr("table-id")),c=a(this).parents("li:first").find(".kitchen-table").attr("order-id"),d=a(this).parents("li:first").find(".kitchen-table tbody tr").length,e=a(this).parents("li:first").find(".kitchen-table tbody tr .btn-mode2-checklist.active").length,f=this;if(d!=e)return AppChecker.alert("Silahkan checklist semua terlebih dahulu untuk melakukan aksi ini!"),!1;AppChecker.loadingOverlay.show();var g=[],h=[],i=3;a(this).parents("li:first").find(".kitchen-table tbody tr").each(function(b,c){g.push(a(c).find("#menu_order_id").val()),temp=a(c).find("#menu_order_id").attr("order_package_menu_id"),void 0==temp&&(temp=0),h.push(temp)}),a.ajax({type:"POST",url:AppChecker.baseUrl+"checker/posts",data:{order_menu_id:g,order_package_menu_id:h,cooking_status:i,table_id:b,order_id:c}}).done(function(c){if(""!=c){var d=JSON.parse(c);d.forEach(function(a,c){AppChecker.socket.emit("cm_notify_cooking_status",{order_menu_id:a.order_menu_id,cooking_status:a.cooking_status,status_name:a.status_name,table_id:b,order_id:a.order_id,arr_merge_table:a.arr_merge_table,notification:a.notification})})}a(f).parents("li").remove(),AppChecker.loadingOverlay.hide()})}),a(document).on("click",".btn-post-order",function(){AppChecker.loadingOverlay.show();var b=a(this).attr("url"),c=a(this).parents(".list-order-checker").attr("table-id"),d=a(this).parents(".list-order-checker").attr("order-id"),e=(a(this).parents(".list-order-checker").find(".kitchen-table tbody tr .btn-ready.active").length,[]);a(this).parents(".list-order-checker").find(".kitchen-table tbody tr .btn-ready.active").each(function(b,c){e.push(a(c).parents("tr").find("#menu_order_id").val())}),a.ajax({type:"POST",url:b,data:{order_menu_id:e,cooking_status:3,table_id:c,order_id:d}}).done(function(a){if(""!=a){var b=JSON.parse(a);AppChecker.socket.emit("cm_notify_cooking_status",{order_menu_id:b[0].order_menu_id,cooking_status:b[0].cooking_status,status_name:b[0].status_name,table_id:c,order_id:b[0].order_id,arr_merge_table:b[0].arr_merge_table,notification:b[0].notification}),AppChecker.getDetailView()}}),AppChecker.loadingOverlay.hide()}),a('[title!=""]').qtip(),AppChecker.deleteNotif()},getDetailView:function(){var b=a.ajax({type:"POST",url:AppChecker.baseUrl+"checker/get_data"});b.done(function(b){""!=b&&(a("#content_checker").html(b),a('[title!=""]').qtip())}),b.fail(function(b,c){"timeout"==c&&AppChecker.alert(a("#server-timeout-message p").text()),window.location.reload(!0)})},updateOpenNotifBar:function(){if(a(".notification-container").hasClass("open-notif"))for(var b=a(".unseen-notif"),c=0;c<b.length;c++){var d=b.eq(c).attr("data-id"),e=a.ajax({type:"POST",url:AppChecker.baseUrl+"notification/update_notif",data:{notif_id:d}});e.done(function(){})}},updateNotifCounter:function(b){var c=parseInt(a(".counter-notification").html());"+"==b?(isNaN(c)&&(a("#btn-notif").append('<div class="counter-notification">0</div>'),c=0),a(".counter-notification").html(c+1).change()):(0>c-1&&(c=1),a(".counter-notification").html(c-1).change(),0==a(".counter-notification").html()&&a(".counter-notification").hide())},prependNotif:function(b){for(var c=b.length-1;c>=0;c--)if(b[c].to_user==AppChecker.userId){a(".empty-notif").remove();var d='<div class="list-notification unseen-notif" id="notif-'+b[c].notif_id+'" data-id="'+b[c].notif_id+'" ><p class="content-notif" >'+b[c].msg+'</p><a class="button-ok-notif" href="#" data-id="'+b[c].notif_id+'"></a></div>';a("#notification-container-list").prepend(d),AppChecker.updateNotifCounter("+"),a(".counter-notification").show()}AppChecker.deleteNotif()},deleteNotif:function(){a(".button-ok-notif").on("click",function(b){AppChecker.loadingOverlay.show();var c=a(this).attr("data-id"),d=a.ajax({type:"POST",url:AppChecker.baseUrl+"notification/delete_notif",data:{notif_id:c}});d.done(function(){a("#notif-"+c).remove(),AppChecker.updateNotifCounter("-"),AppChecker.loadingOverlay.hide()})})},startTouchTimer:function(a){AppChecker.touchTimer+=a},initKeyboardNumber:function(a){var b=/mobile|android/i.test(navigator.userAgent);if(!b){var c=a.keyboard().getkeyboard();c.destroy(),a.keyboard({layout:"custom",customLayout:{"default":["1 2 3","4 5 6","7 8 9","{left} 0 {right}","{bksp} {a} {c}"]},maxLength:5,restrictInput:!1,preventPaste:!1,autoAccept:!1,lockInput:!1})}}}});