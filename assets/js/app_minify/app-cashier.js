define(["jquery","jquery-ui","payment","bootstrap","datatables","datatables-bootstrap","datetimepicker","currency","keyboard","easyautocomplete","select2","chained"],function(a,b,c){return{nodeUrl:a("#node_url").val(),baseUrl:a("#base_url").val(),socket:!1,isChangeTable:!1,isSelectTableFirst:!1,isSelectTableSecond:!1,firstTableId:"",secondTableId:"",statusTable:"",loadingOverlay:a("#cover"),overlayUI:a("#cover"),userId:a("#user_id").val(),groupId:a("#group_id").val(),groupName:a("#group_name").val(),userName:a("#user_name").val(),isEdit:!1,countMenuOld:"",orderIsView:a("#order_is_view").val(),lessPayments:a("#less_payments").val(),errorCardNumber:a("#error_card_number").val(),paymentType:1,isCheckout:a("#is_checkout").val(),inputNumber:a(".input-number"),timeoutVal:15e3,isTakeaway:a("#is_takeaway").val(),isDelivery:a("#is_delivery").val(),diningType:a("#dining_type").val(),useKitchen:a("#use_kitchen").val(),useRoleChecker:a("#use_role_checker").val(),customerpay:0,bankAccountId:0,customerCashPayment:0,totalStockAvailable:0,totalBill:parseInt(a("#totalBill").val()),leftDataOrder:[],rightDataOrder:[],enumOrder:{SINGLE:1,ALL:2},subtotalLeft:0,subtotalRight:0,subtotalTaxRight:0,subtotalTaxLeft:0,grandTotalLeft:0,grandTotalRight:0,originGrandTotalRight:0,totalTax:null!=document.getElementById("total_tax")?document.getElementById("total_tax").value:0,discountTotal:0,creditPayment:{code:0,amount:0,type:3,bankId:0,cardTypeId:0,accountId:0},debitPayment:{code:0,amount:0,type:2,bankId:0,cardTypeId:0,accountId:0},flazzPayment:{code:0,amount:0,type:11,bankId:0,accountId:0},cashPayment:{code:0,amount:0,type:1},voucherPayment:{code:0,amount:0,type:4},complimentPayment:{code:0,amount:0,hpp:0,type:5,total_price:0},pendingbill:{code:0,amount:0,type:6,total_price:0,code_name:"",is_banquet:0},pendingbillEmployee:{code:0,amount:0,type:7,total_price:0,code_name:""},downPaymentBill:{code:0,amount:0,type:10,total_price:0,code_name:""},categoryPromoDiscounts:[],categoryPromoCc:[],promoDiscountName:"",promoCcName:"",paymentBalance:0,totLeftPromoDisc:0,totRightPromoDisc:0,totLeftPromoCc:0,totRightPromoCc:0,subTotalDiscountLeft:0,subTotalDiscountRight:0,totalHppLeft:0,totalHppRight:0,nearestRound:a("#nearest_round").val(),voucherMethod:null!=document.getElementById("voucher_method")?document.getElementById("voucher_method").value:1,isRoundUp:a("#is_round_up").val(),discountMember:0,orginTotalLeft:0,orginTotalRight:0,taxes:[],discountMemberId:0,discountMemberPercentage:0,kembalian:0,voucherQuantity:0,voucherName:"",taxServiceMethod:null!=document.getElementById("tax_service_method")?document.getElementById("tax_service_method").value:1,init:function(){console.log("App Cashier inited.."),AppCashier.discountTotal=a("#discount-total").attr("data-price"),AppCashier.loadingOverlay.show(),AppCashier.initFunc(AppCashier),AppCashier.initSetLeftOrder(),AppCashier.reservationProcess(),AppCashier.pettyCashProcess(),AppCashier.initSetRightOrder(),AppCashier.updateTaxInfo(),AppCashier.getOnlineReservation(),a("#ddl_bank_account_card").chained("#ddl_bank"),a("#ddl_flazz_bank_account_card").chained("#ddl_flazz_bank"),a(".promo-cc-right, .promo-cc-left").hide(),a(document).ready(function(){a("#reload_reservation_order").click(function(){a.ajax({url:AppCashier.baseUrl+"reservation/reload_reservation_order",dataType:"JSON",data:{reservation_id:a("#reservation_id").val()},success:function(b){a("#table-bill-list tbody").html(b.content),AppCashier.reservationSubtotal()}})})}),a(document).on("click",".remove_reservation_menu",function(b){a(this).parents("tr").remove(),AppCashier.reservationSubtotal(),b.preventDefault()}),is_delivery=a("#is_delivery").val(),isNaN(is_delivery)&&(is_delivery=0);var b=a("#is_refund").length;(1==is_delivery||1==b)&&AppCashier.split_all_right();try{AppCashier.initSocketIO()}catch(c){AppCashier.alert(a("#server-error-message p").text()),window.location.reload(!0)}a("#total-payment-left").find(".payment-text").parent().remove(),AppCashier.initListFilter()},initListFilter:function(){var a={valueNames:["name"]};new List("menus",a)},initSocketIO:function(){AppCashier.socket=io(AppCashier.nodeUrl,{reconnectionAttempts:2}),AppCashier.socket.on("reconnect_failed",function(){AppCashier.alert(a("#server-error-message p").text()),window.location.reload(!0)}),AppCashier.socket.on("connected",function(b){console.log("Socket.IO connected"),AppCashier.socket.emit("cm_auth",{nip:AppCashier.userId,name:AppCashier.userName,role:AppCashier.groupId,role_name:AppCashier.groupName}),AppCashier.socket.on("sm_auth",function(a){AppCashier.loadingOverlay.hide(),AppCashier.initUIEvent()}),AppCashier.socket.on("sm_notify_cooking_status",function(b){var c=a("#status_menu_"+b.order_menu_id),d=b.status_name;c.html(d),6==b.cooking_status&&a("#bgsound_notification").get(0).play(),null!=b.notification&&(AppCashier.prependNotif(b.notification),AppCashier.updateOpenNotifBar())}),AppCashier.socket.on("sm_notify_menu_available_status",function(a){"1"==AppCashier.isTakeaway&&(1==a.available?AppCashier.alert("Pesan dari kitchen : Menu "+a.menu_name+" habis"):AppCashier.alert("Pesan dari kitchen : Menu "+a.menu_name+" tersedia"))}),AppCashier.socket.on("sm_notify_new_order",function(a){AppCashier.updateStockMenu(a.arr_menu_outlet)})})},initUIEvent:function(){a("#hidden_menu").on("click",function(a){document.getElementById("hidden_menu_dv").className="col-md-4",document.getElementById("hidden_order_dv").className="panel-wrapper hidden-xs"}),a("#hidden_order").on("click",function(a){document.getElementById("hidden_menu_dv").className="col-md-4 hidden-xs",document.getElementById("hidden_order_dv").className="panel-wrapper "}),a("#refund_date").datetimepicker({sideBySide:!0,useCurrent:!0,format:"YYYY-MM-DD"}),a(document).on("click",".reservation_print",function(){reservation_id=a(this).attr("reservation_id"),a("#popup-reservation-template-note").show(),a("#popup-reservation-template-note select").select2(),a("#popup-reservation-template-note").find("#print_reservation_id").val(reservation_id)}),a(".btn-cancel-reservation").on("click",function(){a("#popup-reservation-template-note").find("#print_reservation_id").val(""),a("#popup-reservation-template-note").hide()}),a(".delete_order_all").on("click",function(b){return user_confirmation=a(this).attr("feature_confirmation"),void 0==user_confirmation&&(user_confirmation=""),""!=user_confirmation?(AppNav.showConfirmationPIN(user_confirmation,".delete_order_all","click",1),!1):(order_id=a(this).attr("order_id"),void a.ajax({url:AppTable.baseUrl+"table/delete_order",type:"POST",dataType:"JSON",data:{order_id:order_id},success:function(a){1==a.status?window.location.href=AppTable.baseUrl+"table":AppTable.alert("Data ini terkait dengan reservasi,silahkan hapus melalui menu reservasi!")}}))}),a(".post_to_ready").on("click",function(b){return user_confirmation=a(this).attr("feature_confirmation"),void 0==user_confirmation&&(user_confirmation=""),""!=user_confirmation?(AppNav.showConfirmationPIN(user_confirmation,".post_to_ready","click",1),!1):void(window.location.href=a(this).attr("href"))}),a("#promo_id").on("change",function(b){if(0==a("#promo_id").val())a(".promo-discount").remove(),AppCashier.promoDiscountName="",AppCashier.setPromoDiscount(AppCashier.promoDiscountName,!0),AppCashier.categoryPromoDiscounts=[],AppCashier.getSubtotal(),AppCashier.setSubTotal(),AppCashier.setGrandTotal(),AppCashier.setKembalian(),AppCashier.updateTaxInfo();else{AppCashier.promoDiscountName=a("#promo_id :selected").html();var c=AppCashier.baseUrl+"cashier/get_detail_promo_menu",d=(a("#category_id").val(),a("#promo_id").val()),e=a.ajax({type:"POST",url:c,data:{promo_id:d}});e.done(function(a){var b=JSON.parse(a);console.log("GET DATA DETAIL PROMO MENU"),AppCashier.categoryPromoDiscounts=[];for(var c=0;c<b.length;c++)AppCashier.categoryPromoDiscounts.push(b[c]);AppCashier.setPromoDiscount(AppCashier.promoDiscountName,!1),AppCashier.complimentPayment.amount=0,AppCashier.setSubTotal(),AppCashier.setGrandTotal(),AppCashier.setKembalian(),AppCashier.updateTaxInfo()}),e.fail(function(a,b){}),e.always(function(){})}}),a(".btn-number").on("click",function(b){b.preventDefault();var c=a(this).attr("data-field"),d=a(this).attr("data-type"),e=a("input[name='"+c+"']"),f=parseInt(e.val());isNaN(f)?e.val(1):"minus"==d?(f>e.attr("min")&&e.val(f-1).change(),parseInt(e.val())==e.attr("min")):"plus"==d&&(f<e.attr("max")&&e.val(f+1).change(),parseInt(e.val())==e.attr("max"))}),AppCashier.inputNumber.focusin(function(){a(this).data("oldValue",a(this).val())}),AppCashier.inputNumber.on("keydown",function(a){}),AppCashier.inputNumber.on("change",function(b){var c=parseInt(a(this).attr("min")),d=parseInt(a(this).attr("max")),e=parseInt(a(this).val()),f=a(this).attr("name");e>=c?a(".btn-number[data-type='minus'][data-field='"+f+"']").removeAttr("disabled"):""!=a(this).data("oldValue")?a(this).val(a(this).data("oldValue")):a(this).val(c),d>=e?a(".btn-number[data-type='plus'][data-field='"+f+"']").removeAttr("disabled"):""!=a(this).data("oldValue")?a(this).val(a(this).data("oldValue")):a(this).val(d)}),a(".btn-cancel").on("click",function(b){b.preventDefault(),AppCashier.clearALLInput(),AppCashier.hideAllPopup(),AppCashier.voucherPayment.amount=0,4==AppCashier.paymentType&&(AppCashier.voucherPayment.amount=0,AppCashier.customerpay=0,a(".voucherPayment").remove(),AppCashier.setKembalian()),5==AppCashier.paymentType&&AppCashier.resetComplimentPayment()}),a(".btn-cancel-new-order").on("click",function(b){b.preventDefault(),a("#form-input-order").get(0).reset(),a("#form-input-order").find("textarea").val(""),a("#new-order-checkout").hide()}),a(".get_menus").on("click",function(b){AppCashier.loadingOverlay.show();var c=a(this).children(),d=a(this).attr("href"),e=a(this).data("category"),f=a("#menu-view-type").val(),g=a.ajax({type:"POST",url:d,data:{category_id:e,menu_type:f}});g.done(function(b){if(""!=b){var d=JSON.parse(b);a(".container-menus").html(d.content);var e=a("#btn-category-list").hasClass("active")?a(c[0]).text():a(c[1]).text();a(".category-name").text("Menu - Category "+e),AppCashier.loadingOverlay.hide()}else window.location.reload(!0)}),g.fail(function(b,c){"timeout"==c&&AppCashier.alert(a("#server-timeout-message p").text()),window.location.reload(!0)}),g.always(function(){}),b.preventDefault()}),a(document).on("click",".add-order-menu",function(b){document.activeElement.blur();var c=a(this).data("id"),d=a(this).data("name"),e=a(this).data("price");return a(".menu-name").text(d),a("#menu_id_selected").val(c),a("#menu_price_selected").val(e),a("#is_already_process").val("0"),a("#dinein_takeaway").removeAttr("checked"),a(".btn-save").show(),AppCashier.totalStockAvailable=parseInt(a(".total-available-"+c).html()),0==AppCashier.totalStockAvailable&&"0"==a("#zero_stock_order").val()?(a(this).css("color","red"),!1):(AppCashier.isEdit=!1,AppCashier.countMenuOld=a(".count-order").val(),AppCashier.getMenuDetail(c,!1,!1,this),void b.preventDefault())}),a(document).on("click",".btn-new-order",function(b){a("#new-order-checkout").show(),b.preventDefault()}),a(".btn-save").on("click",function(b){if(b.preventDefault(),"1"==a("#is_already_process").val()&&"1"!=AppCashier.isCheckout)return!1;var c=0,d=a(".count-order").val();if(AppCashier.isEdit){c=a("#menu_order_id_selected").val();var e=parseInt(a("#temp_total_ordered").val())+AppCashier.totalStockAvailable;if(parseInt(e)<parseInt(d)&&"0"==a("#zero_stock_order").val())return AppCashier.alert("Jumlah pesanan melebihi stok."),!1;d-=a("#temp_total_ordered").val()}else if(c=a("#menu_id_selected").val(),AppCashier.totalStockAvailable<parseInt(d)&&"0"==a("#zero_stock_order").val())return AppCashier.alert("Jumlah pesanan melebihi stok."),!1;var f=a("#order_id").val(),g="",h="",i=a(".order-notes").val();a(".chk_dish:checked").each(function(){h+=a(this).val()+","}),h=h.slice(0,-1),a(".options :selected").each(function(b,c){g+=a(c).val()+","}),g=g.slice(0,-1);var j=a.ajax({type:"POST",url:AppCashier.baseUrl+"cashier/save_order_menu",data:{menu_id:c,order_id:f,count:d,option:g,side_dish:h,notes:i,is_edit:AppCashier.isEdit,isCheckout:AppCashier.isCheckout,outlet_id:a(".total-available-"+a("#menu_id_selected").val()).data("outlet")}});j.done(function(b){if(""!=b){var c=JSON.parse(b);c.status===!0?(a(".bill-table tbody").html(c.order_list),a(".total-payment tbody").html(c.order_bill),AppCashier.socket.emit("cm_notify_new_order",{arr_menu_outlet:c.arr_menu_outlet,room:"waiter"}),AppCashier.updateStockMenu(c.arr_menu_outlet)):""!=c.msg&&AppCashier.alert(c.msg),a(".popup-block").hide(),AppCashier.isEdit=!1,AppCashier.countOld="",a("#form-input-order").get(0).reset(),a("#form-input-order").find("textarea").val("")}else window.location.reload(!0)}),j.fail(function(b,c){"timeout"==c&&AppCashier.alert(a("#server-timeout-message p").text()),window.location.reload(!0)}),j.always(function(){})}),a(".btn-delete-order").on("click",function(b){b.preventDefault();var c=a("#menu_order_id_selected").val(),d=a("#order_id").val(),e=a.ajax({type:"POST",url:AppCashier.baseUrl+"cashier/delete_order_menu",data:{menu_id:c,order_id:d,count:a(".count-order").val()}});e.done(function(b){if(""!=b){var c=JSON.parse(b);c.status===!0&&(a(".bill-table tbody").html(c.order_list),a(".total-payment tbody").html(c.order_bill)),a(".popup-block").hide(),a("#form-input-order").get(0).reset(),a("#form-input-order").find("textarea").val(""),AppCashier.socket.emit("cm_notify_new_order",{arr_menu_outlet:c.arr_menu_outlet,room:"kitchen"}),AppCashier.updateStockMenu(c.arr_menu_outlet)}else window.location.reload(!0)}),e.fail(function(b,c){"timeout"==c&&AppCashier.alert(a("#server-timeout-message p").text()),window.location.reload(!0)}),e.always(function(){})});var b=0,c="";a(".bill-table").on("click","tbody  > tr",function(){c=a(this).parents("table:first").attr("id"),"bill-table-left"===c?(a(this).parents("table:first").find("tbody  > tr.tOrder").removeClass("highlight-bill-left"),a(this).addClass("highlight-bill-left"),a(this).find("td").addClass("highlight")):(a(this).parents("table:first").find("tbody  > tr.tOrder").removeClass("highlight-bill-right"),a(this).addClass("highlight-bill-right"),a(this).find("td").addClass("highlight"))}).bind("mouseup",function(){a(this).find("td").removeClass("highlight"),clearTimeout(b)}),a(document).on("mouseup touchend","#table-bill-list-checkout",function(b){a(this).find("td").removeClass("highlight"),a(this).find("tr").removeClass("highlight-bill-left"),a(this).find("tr").removeClass("highlight-bill-right")}),a(document).on("mouseup touchend",".add-order-menu",function(b){a(this).css("color","#333")}),a("#split-single-right").on("click",function(b){var c=AppCashier.extractDataOrder(a(".highlight-bill-left").get(0));return 0!=a("#reservation_id").val()?void AppCashier.alert("Split bill tidak dapat dilakukan karena terkait reservasi"):"undefined"==typeof c.product_id?void AppCashier.alert("Silahkan pilih menu pesanan terlebih dahulu"):(user_confirmation=a(this).attr("feature_confirmation"),void 0==user_confirmation&&(user_confirmation=""),""!=user_confirmation?void AppNav.showConfirmationPIN(user_confirmation,"#split-single-right","click",1):(AppCashier.sendToRight(c,AppCashier.enumOrder.SINGLE,a(".highlight-bill-left").get(0)),AppCashier.getSubtotal(),AppCashier.setSubTotal(),AppCashier.updateTaxInfo(),AppCashier.setGrandTotal(),a("#done-payment").prop("disabled",!0),void(9==AppCashier.cashPayment.type&&AppCashier.bonPayment())))}),a("#split-all-right").on("click",function(a){AppCashier.split_all_right()}),a("#split-single-left").on("click",function(b){var c=AppCashier.extractDataOrder(a(".highlight-bill-right").get(0));return"undefined"==typeof c.product_id?void AppCashier.alert("Silahkan pilih menu pesanan terlebih dahulu"):(user_confirmation=a(this).attr("feature_confirmation"),void 0==user_confirmation&&(user_confirmation=""),""!=user_confirmation?void AppNav.showConfirmationPIN(user_confirmation,"#split-single-left","click",1):(AppCashier.sendToLeft(c,AppCashier.enumOrder.SINGLE,a(".highlight-bill-right").get(0)),AppCashier.getSubtotal(),AppCashier.setSubTotal(),AppCashier.updateTaxInfo(),AppCashier.setGrandTotal(),a("#done-payment").prop("disabled",!0),void(9==AppCashier.cashPayment.type&&AppCashier.bonPayment())))}),a("#split-all-left").on("click",function(b){for(var c=a("#bill-table-right > tbody"),d=0;d<a(c).children().length;d++){var e=a(c).children()[d],f=AppCashier.extractDataOrder(e);AppCashier.sendToLeft(f,AppCashier.enumOrder.ALL,e)}AppCashier.removeAllRightElement(),AppCashier.resetHighlight(),AppCashier.getSubtotal(),AppCashier.setSubTotal(),AppCashier.updateTaxInfo(),AppCashier.setGrandTotal(),a("#input-payment").val(""),a("#input-payment").trigger("change"),AppCashier.resetComplimentPayment(),AppCashier.promoDiscountName="",AppCashier.setPromoDiscount(AppCashier.promoDiscountName,!0),AppCashier.setPromoCc(AppCashier.promoCcName,!0),AppCashier.categoryPromoDiscounts=[],AppCashier.categoryPromoCc=[],a("#done-payment").prop("disabled",!0),9==AppCashier.cashPayment.type&&AppCashier.bonPayment()}),a("#btn-reset-takeaway").on("click",function(b){function c(){AppCashier.loadingOverlay.show();var b=d.attr("href"),c=a("#order_id").val(),e=a.ajax({type:"POST",url:b,data:{order_id:c}});e.done(function(a){window.location.reload(!0)}),e.fail(function(b,c){"timeout"==c&&AppCashier.alert(a("#server-timeout-message p").text()),window.location.reload(!0)}),e.always(function(){})}var d=a(this);AppCashier.confirm("Apakah anda yakin akan reset pesanan ini?",c),b.preventDefault()}),a("#btn-process-takeaway").on("click",function(b){var c=a("#customer_name").val(),d=a("#customer_phone").val(),e=a(".bill-table > tbody  > tr").length;if(""==c)return AppCashier.alert("Silahkan isi nama pelanggan terlebih dahulu"),!1;if(0==e)return AppCashier.alert("No Orders!"),!1;AppCashier.loadingOverlay.show();var f=a(this).attr("href"),g=a("#order_id").val(),h=a.ajax({type:"POST",url:f,data:{order_id:g,customer_name:c,customer_phone:d}});h.done(function(a){var b=JSON.parse(a);AppCashier.socket.emit("cm_notify_new_order",{number_guest:b.number_guest,order_id:g,room:"kasir"}),setTimeout(function(){window.location=b.url_redir},100)}),h.fail(function(b,c){"timeout"==c&&AppCashier.alert(a("#server-timeout-message p").text()),window.location.reload(!0)}),h.always(function(){}),b.preventDefault()}),"1"==AppCashier.orderIsView?a("#btn-reset-takeaway").hide():a("#btn-reset-takeaway").show(),AppCashier.resizePanel(),a(document).ajaxStop(function(){AppCashier.resizePanel()}),AppCashier.paymentProcess(),a(window).on({orientationchange:function(a){AppCashier.resizePanel()},resize:function(a){AppCashier.resizePanel()}}),a("#btn-notif").on("click",function(b){var c={direction:"right"};a(".notification-container").toggle("slide",c,500),a(".notification-container").addClass("open-notif"),AppCashier.updateOpenNotifBar()}),a(".button-hide").on("click",function(b){var c={direction:"right"};a(".notification-container").toggle("slide",c,500);for(var d=a(".unseen-notif"),e=d.length-1;e>=0;e--){var f=d.eq(e).attr("data-id");AppCashier.updateNotifCounter("-"),a("#notif-"+f+" ").removeClass("unseen-notif")}}),a(".notification-container").removeClass("open-notif"),AppCashier.deleteNotif(),a("#save_reservasi").on("click",function(a){a.preventDefault(),App.addReservation(function(a){AppCashier.socket.emit("cm_new_reservation",{reservation_id:a.reservation_id,detail_order:a.detail_order,table_id:a.table_id,table_number:a.table_number,reservation_date:a.reservation_date,customer_name:a.customer_name,order_id:a.order_id,operator_name:a.operator_name}),window.location=AppCashier.baseUrl+"reservation/add"})}),a("#save_exit_reservasi").on("click",function(a){a.preventDefault(),App.addReservation(function(a){AppCashier.socket.emit("cm_new_reservation",{reservation_id:a.reservation_id,detail_order:a.detail_order,table_id:a.table_id,table_number:a.table_number,reservation_date:a.reservation_date,customer_name:a.customer_name,order_id:a.order_id,operator_name:a.operator_name}),window.location=AppCashier.baseUrl+"reservation"})}),a("#edit_reservasi").on("click",function(b){b.preventDefault(),App.editReservation(function(b){AppCashier.socket.emit("cm_edit_reservation",{reservation_id:b.reservation_id,detail_order:b.detail_order,table_id:b.table_id,table_number:b.table_number,reservation_date:b.reservation_date,customer_name:b.customer_name,order_id:b.order_id,operator_name:b.operator_name}),window.location=AppCashier.baseUrl+"reservation/edit/"+a("#reservation_id").val()})}),a("#edit_exit_reservasi").on("click",function(a){a.preventDefault(),App.editReservation(function(a){AppCashier.socket.emit("cm_edit_reservation",{reservation_id:a.reservation_id,detail_order:a.detail_order,table_id:a.table_id,table_number:a.table_number,reservation_date:a.reservation_date,customer_name:a.customer_name,order_id:a.order_id,operator_name:a.operator_name}),window.location=AppCashier.baseUrl+"reservation"})})},addReservation:function(b){var c=a.ajax({type:"POST",url:AppCashier.baseUrl+"reservation/add_reservation",data:a("#from_reservasi").serialize()});c.success(function(a){try{var a=JSON.parse(a);a.success?(App.alertSuccessMessageReservation(a.message),b(a)):App.alertErrorMessageReservation(a.message)}catch(c){App.alertErrorMessageReservation("Internal Server Error")}})},editReservation:function(b){var c=a.ajax({type:"POST",url:AppCashier.baseUrl+"reservation/edit_reservation",data:a("#from_reservasi").serialize()});c.success(function(a){console.log(a);try{var a=JSON.parse(a);a.success?(App.alertSuccessMessageReservation(a.message),b(a)):App.alertErrorMessageReservation(a.message)}catch(c){App.alertErrorMessageReservation("Internal Server Error")}})},alertErrorMessageReservation:function(b){var c='<div class="alert alert-danger" role="alert">';c+=b,c+="</div",a(".result").html(c),a(window).scrollTop(0)},alertSuccessMessageReservation:function(b){var c='<div class="alert alert-success" role="alert">';c+=b,c+="</div",a(".result").html(c),a(window).scrollTop(0)},split_all_right:function(){for(var b=a("#bill-table-left > tbody"),c=0;c<a(b).children().length;c++){var d=a(b).children()[c],e=AppCashier.extractDataOrder(d);AppCashier.sendToRight(e,AppCashier.enumOrder.ALL,d)}a("#done-payment").prop("disabled",!0),AppCashier.removeAllLeftElement(),AppCashier.resetHighlight(),AppCashier.getSubtotal(),AppCashier.setSubTotal(),AppCashier.updateTaxInfo(),AppCashier.setGrandTotal(),9==AppCashier.cashPayment.type&&AppCashier.bonPayment()},updateOpenNotifBar:function(){if(a(".notification-container").hasClass("open-notif"))for(var b=a(".unseen-notif"),c=b.length-1;c>=0;c--){var d=b.eq(c).attr("data-id"),e=a.ajax({type:"POST",url:AppCashier.baseUrl+"notification/update_notif",data:{notif_id:d}});e.done(function(){})}},updateNotifCounter:function(b){var c=parseInt(a(".counter-notification").html());"+"==b?(isNaN(c)&&(a("#btn-notif").append('<div class="counter-notification">0</div>'),c=0),a(".counter-notification").html(c+1).change()):(a(".counter-notification").html(c-1).change(),0==a(".counter-notification").html()&&a(".counter-notification").hide())},prependNotif:function(b){for(var c=b.length-1;c>=0;c--)if(b[c].to_user==AppCashier.userId){var d='<div class="list-notification unseen-notif" id="notif-'+b[c].notif_id+'" data-id="'+b[c].notif_id+'" ><p class="content-notif" >'+b[c].msg+'</p><a class="button-ok-notif" href="#" data-id="'+b[c].notif_id+'"></a></div>';a("#notification-container").prepend(d),AppCashier.updateNotifCounter("+"),a(".counter-notification").show(),AppCashier.deleteNotif()}},deleteNotif:function(){a(".button-ok-notif").on("click",function(b){AppCashier.loadingOverlay.show();var c=a(this).attr("data-id"),d=a.ajax({type:"POST",url:AppCashier.baseUrl+"notification/delete_notif",data:{notif_id:c}});d.done(function(){a("#notif-"+c).remove(),AppCashier.updateNotifCounter("-"),AppCashier.loadingOverlay.hide()})})},resizePanel:function(){a(".bill-theme-con").height(),a(".total-payment").height(),a(".bill-mover").height()+73,a("#paymentAmount").height()},editOrderMenuDetail:function(b){var c=b.children();a(".menu-name").text(a(c[0]).text()),a("#menu_id_selected").val(a(c[3]).text()),a("#menu_order_id_selected").val(a(c[7]).text()),a("#is_already_process").val(a(c[9]).text()),a("#temp_total_ordered").val(a(c[10]).text()),a("#price-menu").val(a(c[2]).attr("data-price")),AppCashier.totalStockAvailable=parseInt(a(".total-available-"+a(c[4]).text()).html()),AppCashier.getMenuDetail(a(c[3]).text(),!0,c),AppCashier.isEdit=!0},getMenuDetail:function(b,c,d,e){var f=0;if(c&&(f=a(d[7]).text()),0==c&&void 0!=e&&0==parseInt(a(e).data("option-count"))&&0==parseInt(a(e).data("side-dish-count")))parsedObject={options:"<h5 style='color:#898989'>Tidak ada opsi untuk menu ini</h5>",order_menu_data:[],side_dish:"<h5 style='color:#898989'>Tidak ada side dish untuk menu ini</h5>"},a(".side-dish").html(parsedObject.side_dish),a(".menu-option").html(parsedObject.options),a(".side-dish").parents(".dark-theme-con").css("height","198px"),a(".side-dish").parents("#form-input-order").find(".order-note").css("height","225px"),a(".side-dish").parents("#form-input-order").find(".popup-order-panel").css("height","310px"),0==a("#dinein_takeaway").length?a(".order-notes").css("height","162px"):a(".order-notes").css("height","126px"),a(".side-dish").parents("table:first").find("tr:eq(3)").hide(),a(".side-dish").parents("table:first").find("tr:eq(4)").hide(),a("#menu_cooking_status").val("1"),a(".btn-delete-order").hide(),a("#popup-new-order").show();else{var g=a.ajax({type:"POST",url:AppCashier.baseUrl+"table/get_menu_accessories",data:{menu_id:b,menu_order_id:f}});g.done(function(b){if(""!=b){var e=JSON.parse(b);a(".side-dish").html(e.side_dish),a(".menu-option").html(e.options),0==a(".side-dish tr").length?(a(".side-dish").parents(".dark-theme-con").css("height","198px"),a(".side-dish").parents("#form-input-order").find(".order-note").css("height","225px"),a(".side-dish").parents("#form-input-order").find(".popup-order-panel").css("height","310px"),0==a("#dinein_takeaway").length?a(".order-notes").css("height","162px"):a(".order-notes").css("height","126px"),a(".side-dish").parents("table:first").find("tr:eq(3)").hide(),a(".side-dish").parents("table:first").find("tr:eq(4)").hide()):(a(".side-dish").parents(".dark-theme-con").css("height","310px"),a(".side-dish").parents("#form-input-order").find(".order-note").css("height","auto"),a(".side-dish").parents("#form-input-order").find(".popup-order-panel").css("height","390px"),0==a("#dinein_takeaway").length?a(".order-notes").css("height","274px"):a(".order-notes").css("height","238px"),a(".side-dish").parents("table:first").find("tr:eq(3)").show(),a(".side-dish").parents("table:first").find("tr:eq(4)").show()),c?(a(".count-order").val(a(d[1]).text()),a(".order-notes").val(a(d[4]).text()),a("#menu_cooking_status").val(a(d[8]).text()),"1"==a(d[9]).text()&&"1"!=AppCashier.isCheckout?(a(".btn-delete-order").hide(),a(".btn-save").hide()):(a(".btn-delete-order").show(),a(".btn-save").show())):(a("#menu_cooking_status").val("1"),a(".btn-delete-order").hide()),a("#popup-new-order").show()}else window.location.reload(!0)}),g.fail(function(b,c){"timeout"==c&&AppCashier.alert(a("#server-timeout-message p").text()),window.location.reload(!0)}),g.always(function(){})}},paymentProcess:function(){var b=a("#input-payment"),c=/mobile|android/i.test(navigator.userAgent);c&&a(document).on("focus","#input-payment",function(a){b.blur()});var d=("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,"click");a(document).on(d,"#cash-payment",function(c){AppCashier.disablePaymentButton(!1),AppCashier.customerpay==AppCashier.grandTotalRight&&a(".clearNumber:not(#btn-feature-confirmation-clear)").trigger("click"),AppCashier.rightDataOrder.length>0&&AppCashier.activateNumberButton(!0),b.trigger("change"),b.off(),b.payment("restrictNumeric"),b.on("change keyup",function(b){var b=window.event||b,c=b.charCode||b.keyCode;if(void 0!==b)switch(c){case 16:break;case 17:break;case 18:break;case 27:this.value="";break;case 35:break;case 36:break;case 37:break;case 38:break;case 39:break;case 40:break;case 78:break;case 110:break;case 190:break;default:a(this).formatCurrency({symbol:"Rp ",colorize:!0,negativeFormat:"-%s%n",roundToDecimalPlace:-1,groupDigits:!0,eventOnDecimalsEntered:!0})}}),AppCashier.paymentType=1,AppCashier.resetInputPayment(),AppCashier.deactivatePaymentMethod(),a(this).addClass("active"),a("#input-payment").attr("placeholder","Masukan nominal")}),a(document).on(d,"#pending-bill-print",function(b){AppCashier.loadingOverlay.show();var c=a("#order_id").val(),d=a.ajax({type:"POST",url:AppCashier.baseUrl+"cashier/print_pending_bill",data:{order_id:c}});d.done(function(a){AppCashier.loadingOverlay.hide()}),d.fail(function(b,c){"timeout"==c&&AppCashier.alert(a("#server-timeout-message p").text()),window.location.reload(!0)}),d.always(function(){}),AppCashier.deactivatePaymentMethod(),a(this).addClass("active"),a("#input-payment").attr("placeholder","")}),a(document).on(d,"#print-checkout-bill",function(b){var c=0,d=a("#order_id").val(),e=(a("#totalBill").val(),0);if(c>0){var f=a.ajax({type:"POST",url:AppCashier.baseUrl+"cashier/print_bill",data:{order_id:d,payment_type:AppCashier.paymentType,payment_value:c,payment_desc:e}});f.done(function(a){AppCashier.loadingOverlay.hide()}),f.fail(function(b,c){"timeout"==c&&AppCashier.alert(a("#server-timeout-message p").text()),window.location.reload(!0)}),f.always(function(){})}AppCashier.deactivatePaymentMethod(),a(this).addClass("active"),a("#input-payment").attr("placeholder","")}),a(document).on(d,"#print-bill",function(c){AppCashier.loadingOverlay.show();var d=0,e=a("#order_id").val(),f=a("#totalBill").val(),g=0;if("1"==AppCashier.paymentType?(g=AppCashier.customerpay,isNaN(g)&&(g=0),f>g?AppCashier.alert(AppCashier.lessPayments):d=g):(g=b.val(),d=f),d>0){var h=a.ajax({type:"POST",url:AppCashier.baseUrl+"cashier/print_bill",data:{order_id:e,payment_type:AppCashier.paymentType,payment_value:d,payment_desc:g}});h.done(function(a){AppCashier.loadingOverlay.hide()}),h.fail(function(b,c){"timeout"==c&&AppCashier.alert(a("#server-timeout-message p").text()),window.location.reload(!0)}),h.always(function(){})}AppCashier.deactivatePaymentMethod(),a(this).addClass("active"),a("#input-payment").attr("placeholder","")}),a(document).on(d,"#reset-payment",function(c){AppCashier.loadingOverlay.show(),b.val(""),b.trigger("change"),a("#done-payment").prop("disabled",!0),a("#paymentAmount").html(""),a("#cash-payment").trigger("click"),AppCashier.loadingOverlay.hide(),AppCashier.deactivatePaymentMethod(),a("#cash-payment").addClass("active"),a("#input-payment").attr("placeholder","Masukan nominal")}),a(document).on(d,".payment-ok",function(a){return 5===AppCashier.paymentType&&(AppCashier.paymentType=1),void AppCashier.newPaymentProcess(b)}),a("#done-payment, .btn-preview-bill").on(d,function(b){b.preventDefault(),b.stopImmediatePropagation(),AppCashier.loadingOverlay.show();var c=a(this).attr("data-type"),d="",e=0,f=a("#order_id").val();AppCashier.grandTotalRight;payment_value=AppCashier.paymentBalance;var g=[];if("done"==c)d=AppCashier.baseUrl+"cashier/payment_bill";else{if(AppCashier.subtotalRight<0)return void AppCashier.alert("Silahkan pilih data pesanan terlebih dahulu!");AppCashier.loadingOverlay.show(),d=AppCashier.baseUrl+"cashier/print_preview_bill"}var h=!1;if(AppCashier.cashPayment.amount>0&&AppCashier.kembalian>0&&AppCashier.cashPayment.amount>AppCashier.kembalian&&(AppCashier.cashPayment.amount-=AppCashier.kembalian,h=!0),down_payment=parseFloat(a("#reservation_id").attr("down_payment")),isNaN(down_payment)&&(down_payment=0),down_payment>0&&g.push(AppCashier.downPaymentBill),AppCashier.debitPayment.amount>0&&g.push(AppCashier.debitPayment),AppCashier.cashPayment.amount>0&&g.push(AppCashier.cashPayment),AppCashier.creditPayment.amount>0&&g.push(AppCashier.creditPayment),
AppCashier.flazzPayment.amount>0&&g.push(AppCashier.flazzPayment),AppCashier.voucherPayment.amount>0&&g.push(AppCashier.voucherPayment),AppCashier.complimentPayment.amount>0&&g.push(AppCashier.complimentPayment),0!=AppCashier.pendingbill.amount&&g.push(AppCashier.pendingbill),AppCashier.pendingbillEmployee.amount>0&&g.push(AppCashier.pendingbillEmployee),0==g.length&&g.push({code:0,amount:0,type:1}),1==h&&"done"!=c&&(AppCashier.cashPayment.amount+=AppCashier.kembalian),delivery_cost_id=a("#delivery_cost_id").val(),delivery_cost=a("input#delivery_cost").val(),(isNaN(delivery_cost_id)||void 0==delivery_cost_id)&&(delivery_cost_id=""),(isNaN(delivery_cost)||void 0==delivery_cost)&&(delivery_cost=0),receipt_number=a("#is_refund").length>0?a("#is_refund").val():"",0==e){var i=a.ajax({type:"POST",url:d,data:{order_id:f,payment_type:AppCashier.paymentType,customer_payment:AppCashier.customerpay,payment_total:AppCashier.subtotalRight,promo_id:a("#promo_id :selected").val(),promo_cc_id:a("#promo_cc_id").val(),promo_total:AppCashier.totRightPromoDisc,promo_cc:AppCashier.totRightPromoCc,promo_name:AppCashier.promoDiscountName,promo_cc_name:AppCashier.promoCcName,compliment_code:AppCashier.complimentPayment.code,compliment_total:AppCashier.complimentPayment.hpp,delivery_cost_id:delivery_cost_id,delivery_cost:delivery_cost,taxes:JSON.stringify(AppCashier.taxes),data_bayar:JSON.stringify(AppCashier.rightDataOrder),payment_option:JSON.stringify(g),sub_total_2:AppCashier.subtotalRight,round_total:AppCashier.roundRightTotal,is_round_up:AppCashier.isRoundUp,discount_member_total:AppCashier.discountMember,discount_member_id:AppCashier.discountMemberId,discount_member_percentage:AppCashier.discountMemberPercentage,origin_grand_total:AppCashier.originGrandTotalRight,down_payment:a("#reservation_id").attr("down_payment"),grand_total:AppCashier.grandTotalRight,customer_cash_payment:AppCashier.customerCashPayment,pending_bill:JSON.stringify(AppCashier.pendingbill),pending_bill_employee:JSON.stringify(AppCashier.pendingbillEmployee),voucher_quantity:AppCashier.voucherQuantity,receipt_number:receipt_number,kembalian:AppCashier.kembalian,down_payment:AppCashier.downPaymentBill.amount,user_unlock_member_bill:a("#user_unlock_member_bill").val()}});"done"==c?(i.done(function(b){if(3==AppCashier.diningType){var c=a("#is_refund").length,d=JSON.stringify(AppCashier.leftDataOrder);AppCashier.hybridProcess(c,d)}else{var e=JSON.parse(b);e.status===!0?(AppCashier.socket.emit("cm_empty_table",{number_guest:e.number_guest,table_status:e.table_status,status_name:e.status_name,status_class:e.status_class,table_id:e.table_id,order_id:e.order_id,url_redir:e.url_redir,arr_merge_table:e.arr_merge_table,room:"kasir"}),setTimeout(function(){window.location=e.url_redir},100)):AppCashier.alert("Pembayaran gagal dilakukan!")}AppCashier.loadingOverlay.hide()}),i.fail(function(b,c){"timeout"==c&&AppCashier.alert(a("#server-timeout-message p").text()),AppCashier.alert("Request Pembayaran Gagal Dilakukan!")}),i.always(function(){})):AppCashier.loadingOverlay.hide()}}),a("#cash-payment").trigger("click"),a("#cash-payment").trigger("touchend"),a(document).on(d,".btn-calc-direct",function(c){var d=parseInt(a(this).attr("data-value"));""==b.val()&&b.val("0");var e=b.val().slice(3).replace(/\,/g,""),f=parseFloat(e);isNaN(f)&&(f=0),b.val(d+f),b.trigger("change")}),a(document).on(d,".number",function(c){b.val(a.trim(b.val())+a.trim(a(c.target).text())),b.trigger("change")}),a(document).on(d,".deleteNumber",function(a){b.val(b.val().slice(0,-1)),b.trigger("change")}),a(document).on(d,".clearNumber:not(#btn-feature-confirmation-clear)",function(a){switch(AppCashier.paymentType){case 1:AppCashier.cashPayment.amount=0;break;case 2:AppCashier.debitPayment.amount=0;break;case 3:AppCashier.creditPayment.amount=0;break;case 4:AppCashier.voucherPayment.amount=0;break;case 5:AppCashier.complimentPayment.amount=0;break;case 11:AppCashier.flazzPayment.amount=0}AppCashier.customerpay=AppCashier.cashPayment.amount+AppCashier.debitPayment.amount+AppCashier.creditPayment.amount+AppCashier.flazzPayment.amount+AppCashier.voucherPayment.amount+AppCashier.downPaymentBill.amount,AppCashier.setKembalian(),b.val(""),b.trigger("change"),AppCashier.setPaymentBill()}),a(document).on(d,".btn-exactly",function(c){switch(AppCashier.paymentType){case 1:d=parseInt(AppCashier.grandTotalRight-AppCashier.complimentPayment.hpp-AppCashier.voucherPayment.amount-AppCashier.creditPayment.amount-AppCashier.debitPayment.amount-AppCashier.downPaymentBill.amount),AppCashier.downPaymentBill.amount>=AppCashier.grandTotalRight?AppCashier.cashPayment.amount=0:AppCashier.cashPayment.amount=d,b.val(AppCashier.cashPayment.amount<0?0:AppCashier.cashPayment.amount);break;case 2:if(0===AppCashier.debitPayment.code)return;d=parseInt(AppCashier.grandTotalRight-AppCashier.complimentPayment.hpp-AppCashier.voucherPayment.amount-AppCashier.creditPayment.amount-AppCashier.cashPayment.amount-AppCashier.downPaymentBill.amount),AppCashier.downPaymentBill.amount>=AppCashier.grandTotalRight?AppCashier.debitPayment.amount=0:AppCashier.debitPayment.amount=d,b.val(AppCashier.debitPayment.amount<0?0:AppCashier.debitPayment.amount);break;case 3:if(0===AppCashier.creditPayment.code)return;d=parseInt(AppCashier.grandTotalRight-AppCashier.complimentPayment.hpp-AppCashier.voucherPayment.amount-AppCashier.cashPayment.amount-AppCashier.debitPayment.amount-AppCashier.downPaymentBill.amount),AppCashier.downPaymentBill.amount>=AppCashier.grandTotalRight?AppCashier.creditPayment.amount=0:AppCashier.creditPayment.amount=d,b.val(AppCashier.creditPayment.amount<0?0:AppCashier.creditPayment.amount);break;case 4:if(0===AppCashier.voucherPayment.amount||0===AppCashier.voucherPayment.code)return;b.val(AppCashier.voucherPayment.amount<0?0:AppCashier.voucherPayment.amount);break;case 5:d=parseInt(AppCashier.grandTotalRight-AppCashier.complimentPayment.hpp-AppCashier.cashPayment.amount-AppCashier.debitPayment.amount-AppCashier.creditPayment.amount-AppCashier.downPaymentBill.amount),AppCashier.downPaymentBill.amount>=AppCashier.grandTotalRight?AppCashier.complimentPayment.amount=0:AppCashier.complimentPayment.amount=d,b.val(AppCashier.complimentPayment.amount<0?0:AppCashier.complimentPayment.amount);break;case 11:AppCashier.flazzPayment.amount=parseInt(AppCashier.grandTotalRight-AppCashier.voucherPayment.amount-AppCashier.cashPayment.amount-AppCashier.debitPayment.amount),b.val(AppCashier.flazzPayment.amount<0?0:AppCashier.flazzPayment.amount)}AppCashier.customerpay=AppCashier.cashPayment.amount+AppCashier.debitPayment.amount+AppCashier.creditPayment.amount+AppCashier.voucherPayment.amount+AppCashier.downPaymentBill.amount;var d=AppCashier.customerpay;AppCashier.customerpay>=AppCashier.grandTotalRight?AppCashier.customerpay=d:AppCashier.customerpay=AppCashier.grandTotalRight-AppCashier.customerpay,AppCashier.setPaymentBill(),AppCashier.setKembalian(),b.trigger("change"),b.focus(),a("#done-payment").prop("disabled",!0)}),a(document).on("keypress","#input-payment",function(b){b.keyCode==a.ui.keyCode.ENTER&&a(".payment-ok").trigger("click")}),a("#btn-category-list").on("click",function(b){return a("#list-category-text").show(),a("#thumb-category-text").hide(),a("#btn-category-thumb").removeClass("active"),a("#btn-category-list").addClass("active"),!1}),a("#btn-category-thumb").on("click",function(b){return a("#thumb-category-text").show(),a("#list-category-text").hide(),a("#btn-category-list").removeClass("active"),a("#btn-category-thumb").addClass("active"),!1}),a("#btn-menu-list").on("click",function(b){return a("#list-menu-text").show(),a("#thumb-menu-text").hide(),a("#btn-menu-thumb").removeClass("active"),a("#btn-menu-list").addClass("active"),a("#menu-view-type").val("list"),!1}),a("#btn-menu-thumb").on("click",function(b){return a("#thumb-menu-text").show(),a("#list-menu-text").hide(),a("#btn-menu-list").removeClass("active"),a("#btn-menu-thumb").addClass("active"),a("#menu-view-type").val("thumb"),!1}),a(document).on(d,"#btn-discount",function(b){b.preventDefault(),a("#is_single_discount").val("0"),a("#discount-name").val("");var c=a("#subtotal-price").attr("data-price"),d=c.replace(/\./g,"");AppCashier.discount(parseInt(d))}),a(document).on(d,"#btn-discount-single",function(b){b.preventDefault(),a("#is_single_discount").val("1"),a("#discount-name").val("");var c=a("#price-menu").val(),d=c.replace(/\./g,"");AppCashier.discount(parseInt(d))}),a("#input-discount-percent").on("change keyup",function(b){var c=parseInt(a("#input-discount-percent").val()),d=parseInt(a("#subtotal-price-discount").attr("data-price"));isNaN(c)?a("#input-discount-amount").val(0):a("#input-discount-amount").val(AppCashier.convertToAmount(d,c))}),a("#input-discount-amount").on("change keyup",function(b){var c=parseInt(a("#input-discount-amount").val()),d=parseInt(a("#subtotal-price-discount").attr("data-price"));isNaN(c)?a("#input-discount-percent").val(0):a("#input-discount-percent").val(AppCashier.convertToPercent(d,c))}),a("#ddl_discount").on("change",function(b){var c=a(this).children(":selected"),d=c.attr("data-type"),e=c.attr("data-discount"),f=parseInt(a("#subtotal-price-discount").attr("data-price"));if(a("#discount-name").val(c.attr("data-name")),"percent"==d){a("#input-discount-percent").val(e).change();var g=AppCashier.convertToAmount(f,e);a("#input-discount-amount").val(g).change(),a("#form-discount-name").hide()}else if("amount"==d){a("#input-discount-amount").val(e);var g=AppCashier.convertToPercent(f,e);a("#input-discount-percent").val(Math.ceil(g)),a("#form-discount-name").hide()}else a("#input-discount-amount").val("0"),a("#input-discount-percent").val("0"),"other"==e?a("#form-discount-name").show():a("#form-discount-name").hide()}),a(".btn-save-discount").on("click",function(b){a(".popup-discount").hide(),a(".popup-block").hide();var c=0;c=parseInt(a("#input-discount-amount").val());var d=a("#discount-name").val();if(""==d&&(d=a("#input-discount-name").val()),"1"==a("#is_single_discount").val()){var e=a("#menu_order_id_selected").val(),f=a.ajax({type:"POST",url:AppCashier.baseUrl+"cashier/save_order_menu_discount",data:{order_id:e,discount_price:c,discount_name:d,type:"menu"}});f.done(function(b){if(""!=b){var c=JSON.parse(b);c.status===!0?(a(".bill-table tbody").html(c.order_list),a(".total-payment tbody").html(c.order_bill)):""!=c.msg&&AppCashier.alert(c.msg),a(".popup-block").hide(),AppCashier.isEdit=!1,AppCashier.countOld="",a("#form-input-order").get(0).reset(),a("#form-input-order").find("textarea").val("")}else window.location.reload(!0)}),f.fail(function(b,c){"timeout"==c&&AppCashier.alert(a("#server-timeout-message p").text()),window.location.reload(!0)}),f.always(function(){})}else{var g=a("#order_id").val(),f=a.ajax({type:"POST",url:AppCashier.baseUrl+"cashier/save_order_menu_discount",data:{order_id:g,discount_price:c,discount_name:d,type:"order"}});f.done(function(b){if(""!=b){var c=JSON.parse(b);c.status===!0?(a(".bill-table tbody").html(c.order_list),a(".total-payment tbody").html(c.order_bill)):""!=c.msg&&AppCashier.alert(c.msg),a(".popup-block").hide(),AppCashier.isEdit=!1,AppCashier.countOld="",a("#form-input-order").get(0).reset(),a("#form-input-order").find("textarea").val("")}else window.location.reload(!0)}),f.fail(function(b,c){"timeout"==c&&AppCashier.alert(a("#server-timeout-message p").text()),window.location.reload(!0)}),f.always(function(){})}}),a(document).on("click","#btn-compliment",function(b){if(0==AppCashier.rightDataOrder.length)return void AppCashier.alert("Silahkan pilih data pesanan yang akan dibayar!");if(user_confirmation=a(this).attr("feature_confirmation"),void 0==user_confirmation&&(user_confirmation=""),""!=user_confirmation)return AppNav.showConfirmationPIN(user_confirmation,"#btn-compliment","click",1),!1;var c=a(".popup-compliment");a(".select2").select2(),a("#value").removeAttr("class"),a("#value").addClass("form-control compliment-payment-val");var d=a("#compliment_code :selected").val();a("#value").val(d),a("#subtitle").html("<b></b>"),a("#select-bank").hide(),a("#select-bank-account-card").hide(),c.find(".title-popup").text("Input Otorisasi"),a("#confirm_type").val("compliment"),a("#form-payment").attr("action",a(this).attr("data-url")),c.find("#btn-ok-input").removeAttr("data-id"),c.find("#btn-ok-input").attr("data-id","btn-compliment-payment"),c.find("#btn-ok-input-default").hide(),c.show(),AppCashier.paymentType=5}),a("#credit-payment").on("click",function(b){1==AppCashier.paymentType&&AppCashier.customerpay==AppCashier.grandTotalRight&&(AppCashier.customerpay=0,a(".cashPayment").remove(),AppCashier.setKembalian());var c=a(".popup-input");a("#payment_value");a("#value").removeAttr("class"),a("#value").addClass("form-control only_numeric credit-payment-val"),a(".credit-payment-val").attr("maxlength","16"),a("#subtitle").html("<b>NOMOR KARTU :</b>"),a("#select-bank").show(),a("#promo_cc").find("option").length>1?a("#select-promo-cc").show():a("#select-promo-cc").hide(),a("#select-bank-account-card").show(),AppCashier.validationNumber(a(".credit-payment-val")),a(".credit-payment-val").val(""),c.find(".title-popup").text("Input Data Kartu Kredit"),c.find("form").attr("href",AppCashier.baseUrl),a("#confirm_type").val("credit"),AppCashier.subtotalRight>0&&AppCashier.disableNumberButton(!1),5==AppCashier.paymentType&&AppCashier.complimentActionButton(),c.find("#btn-ok-input").removeAttr("data-id"),c.find("#btn-ok-input").attr("data-id","btn-credit-payment"),c.find("#btn-ok-input-default").show(),AppCashier.paymentType=3,AppCashier.complimentPayment.amount<0&&AppCashier.resetInputPayment(),AppCashier.deactivatePaymentMethod(),a(this).addClass("active"),c.show(),a("#popup-ajax").attr("style","display:none")}),a("#debit-payment").on("click",function(b){var c=a(".popup-input");a("#payment_value");a("#value").removeAttr("class"),a("#value").addClass("form-control only_numeric debit-payment-val"),a(".debit-payment-val").attr("maxlength","16"),a("#subtitle").html("<b>NOMOR KARTU :</b>"),a("#promo_cc").val("0"),a("#select-promo-cc").hide(),AppCashier.validationNumber(a(".debit-payment-val")),a("#select-bank").show(),a("#select-bank-account-card").show(),a(".debit-payment-val").val(""),c.find(".title-popup").text("Input Data Kartu Debit"),c.find("form").attr("href",AppCashier.baseUrl),a("#confirm_type").val("debit"),c.find("#btn-ok-input").removeAttr("data-id"),c.find("#btn-ok-input").attr("data-id","btn-debit-payment"),c.find("#btn-ok-input-default").show(),AppCashier.subtotalRight>0&&AppCashier.disableNumberButton(!1),5==AppCashier.paymentType&&AppCashier.complimentActionButton(),a("#value").focus(),AppCashier.paymentType=2,AppCashier.deactivatePaymentMethod(),a(this).addClass("active"),c.show(),AppCashier.complimentPayment.amount<0&&AppCashier.resetInputPayment(),a("#popup-ajax").attr("style","display:none")}),a("#flazz-payment").on("click",function(b){var c=a(".popup-input-flazz");a("#payment_value");a("#value_flazz").removeAttr("class"),a("#value_flazz").addClass("form-control only_numeric flazz-payment-val"),a(".flazz-payment-val").val(""),c.find(".title-popup").text("Input Data Kartu Flazz"),c.find("form").attr("href",AppCashier.baseUrl),a("#confirm_type_flazz").val("flazz"),a("#promo_cc").val("0"),a("#select-promo-cc").hide(),c.find("#btn-ok-input-flazz").removeAttr("data-id"),c.find("#btn-ok-input-flazz").attr("data-id","btn-flazz-payment"),c.find("#btn-ok-input-default").show(),AppCashier.subtotalRight>0&&AppCashier.disableNumberButton(!1),5==AppCashier.paymentType&&AppCashier.complimentActionButton(),a("#valueflazz").focus(),AppCashier.paymentType=11,AppCashier.deactivatePaymentMethod(),a(this).addClass("active"),c.show(),AppCashier.complimentPayment.amount<0&&AppCashier.resetInputPayment()}),a("#voucher-payment").on("click",function(b){if(AppCashier.voucherPayment.amount>0)return void AppCashier.alert("Voucher Sudah Di input");if(1===parseInt(AppCashier.voucherMethod)){var c=a(".popup-input");c.find(".title-popup").text("Input Data Voucher"),a("#subtitle").html("<b>NOMOR VOUCHER :</b>"),a("#select-bank").hide(),a("#select-bank-account-card").hide()}else{var c=a(".popup-voucher"),d=a("#voucher_category :selected").val();a("#value").val(d)}a("#promo_cc").val("0"),a("#select-promo-cc").hide(),a("#form-payment").attr("action",a(this).attr("data-url")),a("#confirm_type").val("voucher"),c.find("#btn-ok-input").removeAttr("data-id"),c.find("#btn-ok-input").attr("data-id","btn-voucher-payment"),c.find("#btn-ok-input-default").hide(),a("#value").removeAttr("class"),a("#value").addClass("form-control voucher-payment-val"),AppCashier.disableNumberButton(!0),AppCashier.paymentType=4,AppCashier.deactivatePaymentMethod(),a(this).addClass("active"),c.show(),a("#popup-ajax").attr("style","display:none")}),a(document).on("click","#bon-payment",function(){return 0==AppCashier.rightDataOrder.length?void AppCashier.alert("Silahkan pilih data pesanan yang akan dibayar!"):(user_confirmation=a(this).attr("feature_confirmation"),void 0==user_confirmation&&(user_confirmation=""),""!=user_confirmation?(AppNav.showConfirmationPIN(user_confirmation,"#bon-payment","click",1),!1):void AppCashier.bonPayment())}),a(document).on("click","#member-payment",function(){if(0==AppCashier.rightDataOrder.length)return void AppCashier.alert("Silahkan pilih data pesanan yang akan dibayar!");if(user_confirmation=a(this).attr("feature_confirmation"),void 0==user_confirmation&&(user_confirmation=""),""!=user_confirmation)return AppNav.showConfirmationPIN(user_confirmation,"#member-payment","click",1),!1;a(".select2").select2();var b=a(".popup-member");b.show(),a("#btn-ok-member").on("click",function(a){App.setMemberPayment()})}),a("#search_member").on("click",function(){var b=a(".popup-data-member");b.show()}),a(".btn-cancel-search-member").on("click",function(b){b.preventDefault(),a(".popup-data-member").hide()}),a("#datatable-data-member").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:a("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"name"},{data:"member_id"},{data:"birth_date"},{data:"city"},{data:"email"},{data:"mobile_phone"},{data:"actions"}],columnDefs:[{targets:6,orderable:!1,bSearchable:!1,"class":"center-tr"}],order:[[0,"asc"]]}),a(document).on("click",".choose_member",function(){a(".popup-data-member").hide(),member_id=a(this).attr("member_id"),member_name=a(this).attr("member_name"),member_code=a(this).attr("member_code"),a("#member_id_val").val(member_id),a("#search_member").val(member_name+" ("+member_code+")")}),a(document).on("click","#btn-company",function(b){if(0==AppCashier.rightDataOrder.length)return void AppCashier.alert("Silahkan pilih data pesanan yang akan dibayar!");if(user_confirmation=a(this).attr("feature_confirmation"),void 0==user_confirmation&&(user_confirmation=""),""!=user_confirmation)return AppNav.showConfirmationPIN(user_confirmation,"#btn-company","click",1),!1;var c=a(".popup-order-company");c.find(".title-popup").text("Pending Bill"),c.find("form").attr("href",AppCashier.baseUrl),c.find("#btn-ok-input").removeAttr("data-id"),c.find("#btn-ok-input").attr("data-id","btn-company"),c.find("#btn-ok-input-default").hide(),c.show()}),a("#btn-ok-compliment, #btn-ok-voucher").on("click",function(b){a("#form-payment").trigger("submit")}),a("#btn-ok-input-default").on("click",function(b){target=a(this).attr("target"),value=a(this).attr("value"),a(target).val(value)}),a(".btn-ok-input").on("click",function(b){a(".popup-order-company").hide(),AppCashier.setPendingBill()}),a("#btn-ok-confirm").on("click",function(b){var c=a("#confirm_type").val(),d=a("#text-code");if(a("#popup-confirm").show(),"compliment"==c){if(0==AppCashier.complimentType){if(!(AppCashier.totalHppRight>0))return void AppCashier.alert("Compliment tidak dapat digunakan!");if(0!=AppCashier.complimentPayment.is_cogs&&AppCashier.complimentPayment.limit<AppCashier.totalHppRight&&AppCashier.totalHppRight<AppCashier.subtotalRight)return void AppCashier.alert("Compliment tidak dapat digunakan!")}}else"voucher"==c&&(1==AppCashier.voucherMethod?d.text("Kode Voucher: "+AppCashier.voucherPayment.code):d.text("Kode Voucher: "+AppCashier.voucherName));AppCashier.hideAllPopup(),AppCashier.clearALLInput()}),a("#btn-ok-input,#btn-ok-input-flazz").on("click",function(b){var c=a(this).attr("data-id");switch(c){case"btn-credit-payment":AppCashier.setCreditPayment();break;case"btn-debit-payment":AppCashier.setDebitPayment();break;case"btn-flazz-payment":AppCashier.setFlazzPayment();break;case"btn-member-payment":AppCashier.setMemberPayment();break;case"btn-compliment-payment":a("#form-payment").trigger("submit");break;case"btn-voucher-payment":AppCashier.grandTotalRight>0?a("#form-payment").trigger("submit"):AppCashier.alert("Jumlah Order Yang akan Di bayar tidak ada, silahkan pilih menu order")}}),a("#form-payment").on("submit",function(b){if(b.preventDefault(),AppCashier.complimentType=1,4==AppCashier.paymentType){var c=a("#value").val(),d={code:c,order_id:a("#order_id").val()};if(2==AppCashier.voucherMethod)var e=a("#voucher_category").val(),f=a("#voucher_quantity").val(),d={voucher_category:e,voucher_quantity:f,order_id:a("#order_id").val()}}else var c=a("#compliment_code option:selected").val(),d={code:c,order_id:a("#order_id").val()};var g=a.ajax({type:"POST",url:a(this).attr("action"),data:d});g.done(function(b){if(""!=b){var d=JSON.parse(b);if(AppCashier.complimentPayment.is_cogs=parseInt(d.is_cogs),1==d.status){if(AppCashier.complimentPayment.limit=parseInt(d.cogs_limit),0==AppCashier.complimentPayment.limit&&1==AppCashier.complimentPayment.is_cogs)return void AppCashier.alert("Compliment Tidak Mencukupi");if(a(".popup-input").hide(),a("#popup-confirm").show(),a("#popup-confirm-content").html(d.msg),5===AppCashier.paymentType){AppCashier.complimentPayment.amount=0,priceText=a("#subtotal-price").attr("data-price"),price=priceText.replace(/\./g,"");var e=a('input[name="compliment_type"]:checked').val();e&&(AppCashier.complimentType=1,1===AppCashier.complimentPayment.is_cogs?(AppCashier.complimentPayment.code=c,AppCashier.complimentPayment.amount=AppCashier.orginTotalRight,AppCashier.complimentPayment.limit<AppCashier.subtotalRight?AppCashier.complimentPayment.hpp=AppCashier.complimentPayment.limit:AppCashier.complimentPayment.hpp=AppCashier.subtotalRight):(AppCashier.complimentPayment.code=c,AppCashier.complimentPayment.amount=AppCashier.orginTotalRight,AppCashier.complimentPayment.hpp=AppCashier.orginTotalRight)),AppCashier.complimentTypeClassEvent(price,c),AppCashier.setCompliment()}if(4==AppCashier.paymentType){if(AppCashier.grandTotalRight<parseInt(d.minimum_order))return a("#text-code").text(""),a("#popup-confirm").hide(),void AppCashier.alert("Voucher Tidak Bisa digunakan, minimum order: "+d.minimum_order);1==AppCashier.voucherMethod?AppCashier.voucherPayment.code=c:(AppCashier.voucherPayment.code=parseInt(d.voucher_category),AppCashier.voucherQuantity=parseInt(d.voucher_quantity),AppCashier.voucherName=d.voucher_name),AppCashier.voucherPayment.amount=parseInt(d.nominal),AppCashier.voucherPayment.amount>AppCashier.grandTotalRight&&(AppCashier.voucherPayment.amount=AppCashier.grandTotalRight,AppCashier.cashPayment.amount=0,AppCashier.creditPayment.amount=0,AppCashier.debitPayment.amount=0,a(".cashPayment").remove(),a(".creditPayment").remove(),a(".debitPayment").remove()),AppCashier.voucherPayment.amount>AppCashier.grandTotalRight?AppCashier.customerpay=AppCashier.grandTotalRight:AppCashier.customerpay+=AppCashier.voucherPayment.amount}AppCashier.setPaymentBill(),AppCashier.setKembalian(),AppCashier.setGrandTotal()}else AppCashier.alert(d.msg);a("#value").val("")}else window.location.reload(!0)}),g.fail(function(a,b){})})},hybridProcess:function(b,c){var d=a("#order_id").val();if(1!=b||void 0==b)var e=AppCashier.baseUrl+"table/process_order",f={order_id:d};else var e=AppCashier.baseUrl+"table/refund_void",f={data_refund:c,order_id:d};var g=a.ajax({type:"POST",url:e,data:f});g.done(function(c){if(""!=c&&"0"!=c&&1!=b){var d=JSON.parse(c);if(AppCashier.socket.emit("cm_notify_new_order",{number_guest:d.number_guest,table_status:d.table_status,status_name:d.status_name,status_class:d.status_class,table_id:d.table_id,table_name:d.table_name,order_id:d.order_id,arr_merge_table:d.arr_merge_table,floor_id:d.floor_id,room:"waiter",notification:d.notification,outlets:d.outlets}),1==AppCashier.useKitchen){var e=a(".bill-table > tbody  > tr");e.each(function(){var b=a(this).find(".status_menu_order").html();if(b==all_cooking_status[0]){var b=a(this).find(".status_menu_order").html(all_cooking_status[1]),c=a(this).children();a(c[9]).text("1"),a(c[10]).text("1")}}),d.status_menu.forEach(function(b,c,d){a("#status_menu_"+b.id).html(b.cooking_status_name)})}else{var e=a(".bill-table > tbody  > tr");e.each(function(){var b=a(this).find(".status_menu_order").html();if("New"==b){var b=a(this).find(".status_menu_order").html("Ready"),c=a(this).children();a(c[9]).text("1"),a(c[10]).text("3")}}),d.status_menu.forEach(function(b,c,d){a("#status_menu_"+b.id).html(b.cooking_status_name)}),1==AppCashier.useRoleChecker&&AppCashier.socket.emit("cm_notify_checker",{})}AppCashier.loadingOverlay.hide(),setTimeout(function(){window.location=d.url_redir},100)}else window.location=AppCashier.baseUrl+"table"}),g.fail(function(b,c){"timeout"==c&&AppCashier.alert(a("#server-timeout-message p").text()),window.location.reload(!0)}),g.always(function(){})},complimentTypeClassEvent:function(b,c){a(".complimentTypeClass").click(function(){var b=a(this).val();0==b?(AppCashier.complimentType=0,1===AppCashier.complimentPayment.is_cogs?(AppCashier.complimentPayment.code=c,AppCashier.complimentPayment.amount=AppCashier.totalHppRight,AppCashier.complimentPayment.limit<AppCashier.totalHppRight?AppCashier.complimentPayment.hpp=AppCashier.complimentPayment.limit:AppCashier.complimentPayment.hpp=AppCashier.totalHppRight):(AppCashier.complimentPayment.code=c,AppCashier.complimentPayment.amount=AppCashier.totalHppRight,AppCashier.complimentPayment.hpp=AppCashier.totalHppRight)):1==b&&(AppCashier.complimentType=1,1===AppCashier.complimentPayment.is_cogs?(AppCashier.complimentPayment.code=c,AppCashier.complimentPayment.amount=AppCashier.orginTotalRight,AppCashier.complimentPayment.limit<AppCashier.subtotalRight?AppCashier.complimentPayment.hpp=AppCashier.complimentPayment.limit:AppCashier.complimentPayment.hpp=AppCashier.subtotalRight):(AppCashier.complimentPayment.code=c,AppCashier.complimentPayment.amount=AppCashier.orginTotalRight,AppCashier.complimentPayment.hpp=AppCashier.orginTotalRight))})},resetInputDiscount:function(){a("#input-discount-amount").val(""),a("#input-discount-percent").val("")},convertToAmount:function(a,b){return a*b/100},convertToPercent:function(a,b){return b/a*100},discount:function(b){a("#subtotal-price-discount").attr("data-price",b).change(),a("#subtotal-price-discount").html(AppCashier.formatRupiah(b)),a(".popup-discount").show()},disableNumberButton:function(b){a(".btn-calc:not(.btn-pin-confirmation)").prop("disabled",b),a(".btn-calc-direct").prop("disabled",b)},disableAllPaymentButton:function(b){a(".btn-calc:not(.btn-pin-confirmation)").prop("disabled",b),a(".btn-calc-direct").prop("disabled",b),a(".btn-metode").prop("disabled",b),a("#input-payment").prop("disabled",!0)},disablePaymentButton:function(b){a(".number25").prop("disabled",b),a(".number50").prop("disabled",b),a(".number75").prop("disabled",b),a(".number100").prop("disabled",b)},activateNumberButton:function(b){a(".btn-calc").prop("disabled",!1),a(".btn-calc-direct").prop("disabled",!1)},complimentActionButton:function(){a("#input-payment").val(AppCashier.customerpay),a("#input-payment").trigger("change"),AppCashier.disableNumberButton(!0),a(".btn-calc:not(.btn-pin-confirmation)").prop("disabled",!0),AppCashier.disablePaymentButton(!0),a(".payment-ok").prop("disabled",!1),a("#done-payment").prop("disabled",!0)},formatRupiah:function(a){var b=a.toFixed(2).split("."),c=b[0].split("").reverse(),d="",e=0;for(x in c)e++,d=e%3==1&&1!=e?c[x]+"."+d:c[x]+d;return d},deactivatePaymentMethod:function(b){a("#cash-payment").removeClass("active"),a("#voucher-payment").removeClass("active"),a("#member-payment").removeClass("active"),a("#debit-payment").removeClass("active"),a("#flazz-payment").removeClass("active"),a("#credit-payment").removeClass("active"),a("#pending-bill-print").removeClass("active"),a("#print-bill").removeClass("active")},updateStockMenu:function(b){for(var c=0;c<b.length;c++)a(".total-available-"+b[c].id).html(b[c].total_available)},extractDataOrder:function(b){var c={};c.product_id=a(b).attr("id"),c.menu_id=a(b).attr("menu_id"),c.category_id=a(b).attr("data-category"),c.use_taxes=a(b).attr("data-use_taxes");for(var d=0;d<a(b).children().length;d++){var e=a(a(b).children()[d]);switch(d){case 0:c.product_name=e.text();case 1:c.product_amount=parseInt(e.text());case 2:c.product_price=e.attr("data-price"),c.menu_hpp=e.attr("data-menu-hpp")}}return c.origin_price=c.product_price,c},bonPayment:function(){AppCashier.resetInputPayment(),AppCashier.resetPayment(),AppCashier.resetPaymentUI(),AppCashier.getSubtotal(),AppCashier.setSubTotal(),AppCashier.updateTaxInfo(),AppCashier.setGrandTotal(),a(".btn-exactly").click(),a(".payment-ok").click(),AppCashier.cashPayment.type=9,a("tr.cashPayment td:eq(1)").html("<b>BON</b>"),AppCashier.disableAllPaymentButton(!0),a("#member-payment").prop("disabled",!0),a("#btn-compliment").prop("disabled",!0),a("#btn-company").prop("disabled",!0),a("#promo_id").prop("disabled",!0)},initSetLeftOrder:function(){for(var b=a("#bill-table-left > tbody"),c=0;c<a(b).children().length;c++){var d=a(b).children()[c],e=AppCashier.extractDataOrder(d);AppCashier.leftDataOrder.push(e)}AppCashier.getSubtotal(),AppCashier.setSubTotal()},initSetRightOrder:function(){a("#total-payment-right").find("#subtotal-price").html(AppCashier.moneyFormat(AppCashier.subtotalRight,"Rp ")),a("#total-payment-right").find("#total-price").html(AppCashier.moneyFormat(AppCashier.subtotalRight,"Rp ")),AppCashier.getSubtotal(),AppCashier.setSubTotal()},findLeftOrder:function(a){for(var b=0;b<AppCashier.leftDataOrder.length;b++)if(a.product_id==AppCashier.leftDataOrder[b].product_id)return AppCashier.leftDataOrder[b];return!1},findRightOrder:function(a){for(var b=0;b<AppCashier.rightDataOrder.length;b++)if(a.product_id==AppCashier.rightDataOrder[b].product_id)return AppCashier.rightDataOrder[b];return!1},resetHighlight:function(){a("#bill-table-right").find("tbody  > tr.tOrder").removeClass("highlight-bill-right"),a("#bill-table-left").find("tbody  > tr.tOrder").removeClass("highlight-bill-left")},sendToLeft:function(b,c,d){var e=AppCashier.findRightOrder(b),f=AppCashier.findLeftOrder(b),g=d;if(f){c===AppCashier.enumOrder.SINGLE?f.product_amount+=1:f.product_amount+=b.product_amount;for(var h=a("#bill-table-left").find("tbody  > tr.tOrder"),i=0;i<a(h).length;i++){var j=a(h)[i];if(a(j).attr("id")===e.product_id){var k=f.product_amount*f.product_price;a(j).children().eq(1).html(f.product_amount),a(j).children().eq(2).html(AppCashier.moneyFormat(k,"Rp "))}}}else{c===AppCashier.enumOrder.SINGLE&&(b.product_amount=1),AppCashier.leftDataOrder.push(b);var l=a(g).clone();a(l).children().eq(1).html(b.product_amount);var k=b.product_amount*b.product_price;a(l).children().eq(2).html(AppCashier.moneyFormat(k,"Rp ")),a(l).removeClass("highlight-bill-right"),a("#bill-table-left").append(a(l))}if(e)if(c===AppCashier.enumOrder.SINGLE)if(e.product_amount-=1,0===e.product_amount)a(g).remove(),a.each(AppCashier.rightDataOrder,function(a){return AppCashier.rightDataOrder[a].product_id===e.product_id?(AppCashier.rightDataOrder.splice(a,1),!1):void 0});else{a(g).children().eq(1).html(e.product_amount);var k=e.product_amount*e.product_price;a(g).children().eq(2).html(AppCashier.moneyFormat(k,"Rp "))}else AppCashier.resetPayment(),a.each(AppCashier.rightDataOrder,function(a){return AppCashier.rightDataOrder[a].product_id===e.product_id?(AppCashier.rightDataOrder.splice(a,1),
!1):void 0})},sendToRight:function(b,c,d){var e=AppCashier.findRightOrder(b),f=AppCashier.findLeftOrder(b),g=d;if(e){c===AppCashier.enumOrder.SINGLE?e.product_amount+=1:e.product_amount+=b.product_amount;for(var h=a("#bill-table-right").find("tbody  > tr.tOrder"),i=0;i<a(h).length;i++){var j=a(h)[i];if(a(j).attr("id")===f.product_id){a(j).children().eq(1).html(e.product_amount);var k=e.product_amount*e.product_price;a(j).children().eq(2).html(AppCashier.moneyFormat(k,"Rp "))}}}else{c===AppCashier.enumOrder.SINGLE&&(b.product_amount=1),AppCashier.rightDataOrder.push(b);var l=a(g).clone();a(l).children().eq(1).html(b.product_amount);var k=b.product_amount*b.product_price;a(l).children().eq(2).html(AppCashier.moneyFormat(k,"Rp ")),a(l).removeClass("highlight-bill-left"),a(l).find("td").removeClass("highlight"),a("#bill-table-right").append(a(l))}if(f)if(c===AppCashier.enumOrder.SINGLE)if(f.product_amount-=1,0===f.product_amount)a(g).remove(),a.each(AppCashier.leftDataOrder,function(a){return AppCashier.leftDataOrder[a].product_id===f.product_id?(AppCashier.leftDataOrder.splice(a,1),!1):void 0});else{a(g).children().eq(1).html(f.product_amount);var k=f.product_amount*f.product_price;a(g).children().eq(2).html(AppCashier.moneyFormat(k,"Rp "))}else a.each(AppCashier.leftDataOrder,function(a){return AppCashier.leftDataOrder[a].product_id===f.product_id?(AppCashier.leftDataOrder.splice(a,1),!1):void 0})},removeAllLeftElement:function(){a("#bill-table-left > tbody  > tr").each(function(){a(this).remove()})},removeAllRightElement:function(){a("#bill-table-right > tbody  > tr").each(function(){a(this).remove()})},clearALLInput:function(){a("#form-input-order").get(0).reset(),a("#value").val(""),a("#form-input-order").find("textarea").val("")},hideAllPopup:function(){a("#popup-confirm").hide(),a(".popup-block").hide(),a(".popup-discount").hide()},getLeftDataOrder:function(){for(var a="",b=0;b<AppCashier.leftDataOrder.length;b++){var c=AppCashier.leftDataOrder[b].product_amount,d=AppCashier.leftDataOrder[b].product_price,e=AppCashier.leftDataOrder[b].product_name,f=d*c;a+="<tr><td style='width:10%;'>"+(b+1)+"</td><td style='width:60%;'>"+e+"</td><td style='width:30%;text-align:right;'>"+AppCashier.moneyFormat(f,"Rp")+"</td></tr>"}return a},getRightDataOrder:function(){for(var a="",b=0;b<AppCashier.rightDataOrder.length;b++){var c=AppCashier.rightDataOrder[b].product_amount,d=AppCashier.rightDataOrder[b].product_price,e=AppCashier.rightDataOrder[b].product_name,f=d*c;a+="<tr><td style='width:10%;'>"+(b+1)+"</td><td style='width:60%;'>"+e+"</td><td style='width:30%;text-align:right;'>"+AppCashier.moneyFormat(f,"Rp")+"</td></tr>"}return a},moneyFormat:function(a,b){return b+" "+a.toFixed(0).replace(/./g,function(a,b,c){return b>0&&","!==a&&(c.length-b)%3===0?"."+a:a})},getSubtotal:function(){console.log("GET subtotal"),AppCashier.subtotalLeft=0,AppCashier.subtotalRight=0,AppCashier.orginTotalLeft=0,AppCashier.orginTotalRight=0,AppCashier.totalHppLeft=0,AppCashier.totalHppRight=0;for(var a=0;a<AppCashier.leftDataOrder.length;a++){var b=AppCashier.leftDataOrder[a].product_amount,c=AppCashier.leftDataOrder[a].origin_price,d=AppCashier.leftDataOrder[a].menu_hpp,e=c*b;AppCashier.subtotalLeft+=e,AppCashier.orginTotalLeft+=e,AppCashier.totalHppLeft+=d}for(var f=0;f<AppCashier.rightDataOrder.length;f++){var g=AppCashier.rightDataOrder[f].product_amount,h=AppCashier.rightDataOrder[f].origin_price,d=AppCashier.rightDataOrder[f].menu_hpp,i=h*g;AppCashier.subtotalRight+=i,AppCashier.orginTotalRight+=i,AppCashier.totalHppRight+=g*parseInt(d)}"GET SUBTOTAL"+AppCashier.subtotalRight},setCompliment:function(){var b=a("#input-payment"),c=a(".payment-ok");AppCashier.discountMemberId=0,AppCashier.discountMemberPercentage=0,AppCashier.discountMember=0,AppCashier.viewCompliment=0,AppCashier.setPromoDiscount("",!0),AppCashier.setPromoCc("",!0),a(".promo-discount-right, .promo-discount-left").remove(),a(".promo-cc-right, .promo-cc-left").remove(),a(".promo-compliment-right,.promo-compliment-left").remove(),AppCashier.categoryPromoDiscounts=[],AppCashier.categoryPromoCc=[],AppCashier.subTotalDiscountLeft=AppCashier.orginTotalLeft,AppCashier.subTotalDiscountRight=AppCashier.orginTotalRight,AppCashier.subTotalDiscountRight<0&&(AppCashier.subTotalDiscountRight=0),AppCashier.subTotalDiscountLeft<0&&(AppCashier.subTotalDiscountLeft=0),a("#promo_id").val(0),a("#promo_id").prop("disabled",!0),a("#promo_cc").val(0),a("#promo_cc").prop("disabled",!0),a(".discount-member").remove(),AppCashier.voucherPayment.amount=0,AppCashier.resetTaxInfo(),AppCashier.getSubtotal(),AppCashier.subtotalRight=AppCashier.subTotalDiscountRight,AppCashier.setGrandTotal(),AppCashier.setKembalian();var d=a('input[name="compliment_type"]:checked').val();if(d&&(AppCashier.complimentType=1,1==AppCashier.complimentPayment.is_cogs?AppCashier.complimentPayment.limit<AppCashier.orginTotalRight?(AppCashier.customerpay=AppCashier.orginTotalRight-AppCashier.complimentPayment.limit,AppCashier.viewCompliment=AppCashier.complimentPayment.limit,AppCashier.disableNumberButton(!1),a(".btn-metode").prop("disabled",!1),c.prop("disabled",!1)):(AppCashier.customerpay=AppCashier.orginTotalRight,AppCashier.viewCompliment=AppCashier.orginTotalRight,AppCashier.disableNumberButton(!0),a(".btn-metode").prop("disabled",!0)):(AppCashier.resetTaxInfo(),AppCashier.customerpay=AppCashier.orginTotalRight,AppCashier.viewCompliment=AppCashier.orginTotalRight,AppCashier.disableNumberButton(!0),a(".btn-metode").prop("disabled",!0))),AppCashier.setComplimentEvent(b,c),a(".voucherPayment").remove(),AppCashier.rightDataOrder.length>0){a("#total-payment-right").find("#sub-total-2").html(AppCashier.moneyFormat(AppCashier.subtotalRight,"Rp ")),a(".promo-compliment-right").remove();var e="<tr class='promo-compliment-right'><td> </td><td><b>Compliment</b></td><td class='tb-align-right'>"+AppCashier.moneyFormat(AppCashier.viewCompliment,"Rp ")+"</td></tr>";a(".payment-method").after(e)}},setComplimentEvent:function(b,c){a(".complimentTypeClass").click(function(){var b=a(this).val();0==b?(AppCashier.complimentType=0,1==AppCashier.complimentPayment.is_cogs?AppCashier.complimentPayment.limit<AppCashier.totalHppRight?(AppCashier.customerpay=AppCashier.totalHppRight-AppCashier.complimentPayment.limit,AppCashier.viewCompliment=AppCashier.complimentPayment.limit,AppCashier.disableNumberButton(!1),a(".btn-metode").prop("disabled",!1),c.prop("disabled",!1)):(AppCashier.customerpay=AppCashier.totalHppRight,AppCashier.viewCompliment=AppCashier.totalHppRight,AppCashier.disableNumberButton(!0),a(".btn-metode").prop("disabled",!0)):(AppCashier.resetTaxInfo(),AppCashier.customerpay=AppCashier.grandTotalRight,a(".btn-metode").prop("disabled",!0))):1==b&&(AppCashier.complimentType=1,1==AppCashier.complimentPayment.is_cogs?AppCashier.complimentPayment.limit<AppCashier.orginTotalRight?(AppCashier.customerpay=AppCashier.orginTotalRight-AppCashier.complimentPayment.limit,AppCashier.viewCompliment=AppCashier.complimentPayment.limit,AppCashier.disableNumberButton(!1),a(".btn-metode").prop("disabled",!1),c.prop("disabled",!1)):(AppCashier.customerpay=AppCashier.orginTotalRight,AppCashier.viewCompliment=AppCashier.orginTotalRight,AppCashier.disableNumberButton(!0),a(".btn-metode").prop("disabled",!0)):(AppCashier.resetTaxInfo(),AppCashier.customerpay=AppCashier.orginTotalRight,AppCashier.viewCompliment=AppCashier.orginTotalRight,AppCashier.disableNumberButton(!0),a(".btn-metode").prop("disabled",!0)))})},resetComplimentPayment:function(){AppCashier.paymentType=1,AppCashier.complimentPayment.amount=0,AppCashier.complimentPayment.hpp=0,a(".promo-compliment-right").remove(),AppCashier.customerpay=0,AppCashier.activateNumberButton(!0),AppCashier.disableAllPaymentButton(!1),AppCashier.setPromoDiscount("",!0),AppCashier.setPromoCc("",!0),AppCashier.getSubtotal(),AppCashier.setSubTotal(),AppCashier.updateTaxInfo(),AppCashier.setKembalian()},setSubTotal:function(){console.log("SET subtotal"),a("#total-payment-left").find("#subtotal-price").html(AppCashier.moneyFormat(AppCashier.orginTotalLeft,"Rp ")),a("#single-bill").find("#subtotal-price").html(AppCashier.moneyFormat(AppCashier.orginTotalLeft,"Rp ")),a("#total-payment-right").find("#subtotal-price").html(AppCashier.moneyFormat(AppCashier.orginTotalRight,"Rp ")),a("#custom-bill").find("#subtotal-price").html(AppCashier.moneyFormat(AppCashier.orginTotalRight,"Rp ")),AppCashier.updateDiscountMember(),AppCashier.setPromoDiscount(AppCashier.promoDiscountName,!1),AppCashier.setPromoCc(AppCashier.promoCcName,!1),AppCashier.rightDataOrder.length>0?AppCashier.subtotalRight=AppCashier.orginTotalRight-AppCashier.totRightPromoDisc-AppCashier.totRightPromoCc-AppCashier.discountMember-AppCashier.complimentPayment.amount:(a("#promo_id").val(0),a("#promo_cc").val(0)),a("#total-payment-left").find("#sub-total-2").html(AppCashier.moneyFormat(AppCashier.subtotalLeft,"Rp ")),a("#total-payment-right").find("#sub-total-2").html(AppCashier.moneyFormat(AppCashier.subtotalRight,"Rp ")),AppCashier.complimentPayment.amount>0?AppCashier.resetTaxInfo():(AppCashier.updateDiscount(),AppCashier.updateTaxInfo())},updateTaxInfo:function(){if(AppCashier.subtotalTaxRight=0,AppCashier.subtotalTaxLeft=0,AppCashier.taxes=[],!(AppCashier.complimentPayment.amount>0)){var b=a("#total-payment-left").find("#tax-price"),c=0,d=0,e=0;for(x=0;x<AppCashier.leftDataOrder.length;x++)product_price=parseFloat(AppCashier.leftDataOrder[x].product_price),(isNaN(product_price)||void 0==product_price)&&(product_price=0),product_amount=parseFloat(AppCashier.leftDataOrder[x].product_amount),(isNaN(product_amount)||void 0==product_amount)&&(product_amount=0),use_taxes=parseInt(AppCashier.leftDataOrder[x].use_taxes),(isNaN(use_taxes)||void 0==use_taxes)&&(use_taxes=1),0==use_taxes&&(c+=product_amount*product_price);for(var f=0;f<b.length;f++)1==a(b[f]).attr("service")&&(d+=a(b[f]).attr("percentage")*AppCashier.subtotalLeft/100);e=AppCashier.subtotalLeft-c;for(var g=0;g<b.length;g++){var h=0;if(AppCashier.paymentType!=AppCashier.pendingbillEmployee.type)if(1==AppCashier.taxServiceMethod)h=a(b[g]).attr("percentage")*AppCashier.subtotalLeft/100,h-=a(b[g]).attr("percentage")*c/100,0>h&&(h=0);else{var i=0;service=a(b[g]).attr("service"),1==service?(d=e*a(b[g]).attr("percentage")/100,h+=d):(i=e+d,h=i*a(b[g]).attr("percentage")/100),0>h&&(h=0)}a(b[g]).html(AppCashier.moneyFormat(h,"Rp ")),AppCashier.subtotalTaxLeft+=h}var j=parseFloat(a("#total-payment-left #delivery_cost").attr("cost"));isNaN(j)&&(j=0),AppCashier.subtotalTaxLeft+=j;var k=a("#total-payment-right").find("#tax-price"),l=0,m=0,n=0;for(x=0;x<AppCashier.rightDataOrder.length;x++)product_price=parseFloat(AppCashier.rightDataOrder[x].product_price),(isNaN(product_price)||void 0==product_price)&&(product_price=0),product_amount=parseFloat(AppCashier.rightDataOrder[x].product_amount),(isNaN(product_amount)||void 0==product_amount)&&(product_amount=0),use_taxes=parseInt(AppCashier.rightDataOrder[x].use_taxes),(isNaN(use_taxes)||void 0==use_taxes)&&(use_taxes=1),0==use_taxes&&(l+=product_amount*product_price);for(var f=0;f<k.length;f++)1==a(k[f]).attr("service")&&(m+=a(k[f]).attr("percentage")*AppCashier.subtotalRight/100);n=AppCashier.subtotalRight-l;for(var f=0;f<k.length;f++){var o=0;if(AppCashier.paymentType!=AppCashier.pendingbillEmployee.type)if(1==AppCashier.taxServiceMethod)o=a(k[f]).attr("percentage")*AppCashier.subtotalRight/100,o-=a(k[f]).attr("percentage")*l/100,0>o&&(o=0);else{var i=0;service=a(k[f]).attr("service"),1==service?(m=n*a(k[f]).attr("percentage")/100,o+=m):(i=n+m,o=i*a(k[f]).attr("percentage")/100),0>o&&(o=0)}var p={};p.tax_name=a(k[f]).attr("tax-origin-name")+" ("+a(k[f]).attr("percentage")+"%)",p.tax_percentage=a(k[f]).attr("percentage"),p.account_id=a(k[f]).attr("account-id"),p.tax_total=o,AppCashier.taxes.push(p),a(k[f]).html(AppCashier.moneyFormat(o,"Rp ")),AppCashier.subtotalTaxRight+=o}var j=parseFloat(a("#total-payment-right #delivery_cost").attr("cost"));isNaN(j)&&(j=0),AppCashier.subtotalTaxRight+=j,AppCashier.setKembalian()}},setGrandTotal:function(){down_payment=parseFloat(a("#reservation_id").attr("down_payment")),isNaN(down_payment)&&(down_payment=0),AppCashier.downPaymentBill.code=a("#reservation_id").val(),AppCashier.downPaymentBill.amount=down_payment,AppCashier.originGrandTotalRight=parseInt(AppCashier.subtotalTaxRight+AppCashier.subtotalRight),AppCashier.grandTotalRight=parseInt(Math.round(AppCashier.subtotalTaxRight)+Math.round(AppCashier.subtotalRight)),AppCashier.grandTotalLeft=parseInt(Math.round(AppCashier.subtotalTaxLeft)+Math.round(AppCashier.subtotalLeft)),AppCashier.grandTotalRight<0&&(AppCashier.grandTotalRight=0),AppCashier.grandTotalLeft<0&&(AppCashier.grandTotalLeft=0);var b=AppCashier.grandTotalLeft,c=AppCashier.grandTotalRight;if(1==AppCashier.isRoundUp){if(AppCashier.leftDataOrder.length>0&&AppCashier.grandTotalLeft%parseInt(AppCashier.nearestRound)>0){AppCashier.grandTotalLeft+=parseInt(AppCashier.nearestRound)-AppCashier.grandTotalLeft%AppCashier.nearestRound;var d=AppCashier.grandTotalLeft-b;1e3==AppCashier.nearestRound&&d>500&&(d-=AppCashier.nearestRound,AppCashier.grandTotalLeft=b+d),AppCashier.complimentPayment.amount>0&&(AppCashier.grandTotalRight-=AppCashier.roundRightTotal,d=0),a("#total-payment-left").find("#pembulatan").html((0>d?"- ":"")+"Rp "+Math.abs(d).toFixed(0)),AppCashier.roundRightTotal=d.toFixed(0)}else a("#total-payment-left").find("#pembulatan").html("Rp 0"),AppCashier.roundRightTotal=0;AppCashier.rightDataOrder.length>0&&AppCashier.grandTotalRight%parseInt(AppCashier.nearestRound)>0?(AppCashier.grandTotalRight+=parseInt(AppCashier.nearestRound)-AppCashier.grandTotalRight%AppCashier.nearestRound,AppCashier.grandTotalRight-=(AppCashier.grandTotalRight%AppCashier.nearestRound).toFixed(0),AppCashier.roundRightTotal=AppCashier.grandTotalRight-c,1e3==AppCashier.nearestRound&&AppCashier.roundRightTotal>500&&(AppCashier.roundRightTotal=AppCashier.roundRightTotal-AppCashier.nearestRound,AppCashier.grandTotalRight=c+AppCashier.roundRightTotal),AppCashier.complimentPayment.amount>0&&(AppCashier.grandTotalRight-=AppCashier.roundRightTotal,AppCashier.roundRightTotal=0),a("#total-payment-right").find("#pembulatan").html((AppCashier.roundRightTotal<0?"- ":"")+"Rp "+Math.abs(AppCashier.roundRightTotal).toFixed(0)),AppCashier.roundRightTotal=AppCashier.roundRightTotal.toFixed(0)):(a("#total-payment-right").find("#pembulatan").html("Rp 0"),AppCashier.roundRightTotal=0)}else{if(AppCashier.leftDataOrder.length>0&&AppCashier.grandTotalLeft%parseInt(AppCashier.nearestRound)>0){AppCashier.grandTotalLeft-=(AppCashier.grandTotalLeft%AppCashier.nearestRound).toFixed(0);var d=AppCashier.grandTotalLeft-b;AppCashier.complimentPayment.amount>0&&(AppCashier.grandTotalRight-=d,d=0),a("#total-payment-left").find("#pembulatan").html("Rp "+d),AppCashier.roundRightTotal=d}else a("#total-payment-left").find("#pembulatan").html("Rp 0"),AppCashier.roundRightTotal=0;AppCashier.rightDataOrder.length>0&&AppCashier.grandTotalRight%parseInt(AppCashier.nearestRound)>0?(AppCashier.grandTotalRight-=(AppCashier.grandTotalRight%AppCashier.nearestRound).toFixed(0),AppCashier.roundRightTotal=AppCashier.grandTotalRight-c,AppCashier.complimentPayment.amount>0&&(AppCashier.grandTotalRight-=AppCashier.roundRightTotal,AppCashier.roundRightTotal=0),a("#total-payment-right").find("#pembulatan").html("Rp "+AppCashier.roundRightTotal.toFixed(0)),AppCashier.roundRightTotal=AppCashier.roundRightTotal.toFixed(0)):(a("#total-payment-right").find("#pembulatan").html("Rp 0"),AppCashier.roundRightTotal=0)}a("#total-payment-left").find("#total-price").html(AppCashier.moneyFormat(AppCashier.grandTotalLeft,"Rp ")),a("#single-bill").find("#grand-total").html(AppCashier.moneyFormat(AppCashier.grandTotalLeft,"Rp ")),a("#single-bill").find("#total-price").html(AppCashier.moneyFormat(AppCashier.grandTotalLeft,"Rp ")),a("#total-payment-right").find("#total-price").html(AppCashier.moneyFormat(AppCashier.grandTotalRight,"Rp ")),a("#custom-bill").find("#total-price").html(AppCashier.moneyFormat(AppCashier.subtotalRight,"Rp ")),AppCashier.setDiscountPendingBill()},number_format:function(a,b,c,d){a=(a+"").replace(/[^0-9+\-Ee.]/g,"");var e=isFinite(+a)?+a:0,f=isFinite(+b)?Math.abs(b):0,g="undefined"==typeof d?",":d,h="undefined"==typeof c?".":c,i="",j=function(a,b){var c=Math.pow(10,b);return""+(Math.round(a*c)/c).toFixed(b)};return i=(f?j(e,f):""+Math.round(e)).split("."),i[0].length>3&&(i[0]=i[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,g)),(i[1]||"").length<f&&(i[1]=i[1]||"",i[1]+=new Array(f-i[1].length+1).join("0")),i.join(h)},reservationSubtotal:function(){return order_type=a("#order_type").val(),tax_service_method=a("#tax_service_method").val(),0==a("#reservation-menu-tab").length?!1:(subtotal=0,subtotal_taxes=0,total_per_taxes=[],total_services=0,total_non_services=0,total_taxes=0,total_non_taxes=0,service_dinein=0,service_takeaway=0,service_delivery=0,a("input#tax-price-dinein").each(function(b,c){service=a(this).attr("service"),1==service&&(service_dinein=parseInt(a(this).attr("percentage")))}),a("input#tax-price-takeaway").each(function(b,c){service=a(this).attr("service"),1==service&&(service_takeaway=parseInt(a(this).attr("percentage")))}),a("input#tax-price-delivery").each(function(b,c){service=a(this).attr("service"),1==service&&(service_delivery=parseInt(a(this).attr("percentage")))}),a(".bill-table tbody tr").each(function(){total_sidedish=parseFloat(a(this).attr("total_sidedish")),isNaN(total_sidedish)&&(total_sidedish=0),is_taxes=parseInt(a(this).attr("is_taxes")),qty=parseInt(a(this).find(".qty").val()),isNaN(qty)&&(qty=0),price=parseFloat(a(this).attr("price")),isNaN(price)&&(price=0),subtotal+=qty*price+total_sidedish,1==order_type?a("input#tax-price-dinein").each(function(b,c){percentage=parseFloat(a(this).attr("percentage")),service=parseInt(a(this).attr("service")),total_per_taxes[b]=0,1==tax_service_method?(total_per_taxes[b]+=total_sidedish*percentage/100,total_per_taxes[b]+=1==is_taxes?qty*price*percentage/100:0):1==service?(total_services=subtotal*service_dinein/100,total_non_services+=1!=is_taxes?qty*price*percentage/100:0,total_services-=total_non_services,subtotal_taxes+=1==is_taxes?qty*price:0,total_per_taxes[b]=total_services):(new_subtotal=subtotal_taxes+total_services,total_taxes=new_subtotal*percentage/100,total_per_taxes[b]=total_taxes)}):2==order_type?a("input#tax-price-takeaway").each(function(b,c){percentage=parseFloat(a(this).attr("percentage")),service=parseInt(a(this).attr("service")),total_per_taxes[b]=0,1==tax_service_method?(total_per_taxes[b]+=total_sidedish*percentage/100,total_per_taxes[b]+=1==is_taxes?qty*price*percentage/100:0):1==service?(total_services=subtotal*service_takeaway/100,total_non_services+=1!=is_taxes?qty*price*percentage/100:0,total_services-=total_non_services,subtotal_taxes+=1==is_taxes?qty*price:0,total_per_taxes[b]=total_services):(new_subtotal=subtotal_taxes+total_services,total_taxes=new_subtotal*percentage/100,total_per_taxes[b]=total_taxes)}):a("input#tax-price-delivery").each(function(b,c){percentage=parseFloat(a(this).attr("percentage")),service=parseInt(a(this).attr("service")),total_per_taxes[b]=0,1==tax_service_method?(total_per_taxes[b]+=total_sidedish*percentage/100,total_per_taxes[b]+=1==is_taxes?qty*price*percentage/100:0):1==service?(total_services=subtotal*service_delivery/100,total_non_services+=1!=is_taxes?qty*price*percentage/100:0,total_services-=total_non_services,subtotal_taxes+=1==is_taxes?qty*price:0,total_per_taxes[b]=total_services):(new_subtotal=subtotal_taxes+total_services,total_taxes=new_subtotal*percentage/100,total_per_taxes[b]=total_taxes)})}),total=parseFloat(subtotal),html="<tr>",html+='<td style="width:40%"></td>',html+='<td style="width:30%"><b>Subtotal</b></td>',html+='<td style="width:30%" class="tb-align-right">Rp '+AppCashier.number_format(subtotal,0)+"</td>",html+="</tr>",1==order_type?a("input#tax-price-dinein").each(function(b,c){percentage=a(this).attr("percentage"),tax_name=a(this).attr("tax-name"),html+="<tr>",html+='<td style="width:40%"></td>',html+='<td style="width:30%"><b>'+tax_name+" ("+percentage+"%)</b></td>",html+='<td style="width:30%" class="tb-align-right">Rp '+AppCashier.number_format(total_per_taxes[b],0)+"</td>",html+="</tr>",total+=total_per_taxes[b]}):2==order_type?a("input#tax-price-takeaway").each(function(b,c){percentage=a(this).attr("percentage"),tax_name=a(this).attr("tax-name"),html+="<tr>",html+='<td style="width:40%"></td>',html+='<td style="width:30%"><b>'+tax_name+" ("+percentage+"%)</b></td>",html+='<td style="width:30%" class="tb-align-right">Rp '+AppCashier.number_format(total_per_taxes[b],0)+"</td>",html+="</tr>",total+=total_per_taxes[b]}):a("input#tax-price-delivery").each(function(b,c){percentage=a(this).attr("percentage"),tax_name=a(this).attr("tax-name"),html+="<tr>",html+='<td style="width:40%"></td>',html+='<td style="width:30%"><b>'+tax_name+" ("+percentage+"%)</b></td>",html+='<td style="width:30%" class="tb-align-right">Rp '+AppCashier.number_format(total_per_taxes[b],0)+"</td>",html+="</tr>",total+=total_per_taxes[b]}),3==a(".order_type_reservation:checked").val()&&(reservation_delivery_cost_id=a("#reservation_delivery_cost_id").val(),delivery_cost=parseFloat(a("#reservation_delivery_cost_id option:selected").data("delivery_cost")),is_percentage=parseFloat(a("#reservation_delivery_cost_id option:selected").data("is_percentage")),isNaN(delivery_cost)&&(delivery_cost=0),1==is_percentage&&(delivery_cost=parseFloat(subtotal)*(delivery_cost/100)),html+="<tr>",html+='<td style="width:40%"></td>',html+='<td style="width:30%"><b>Ongkir</b></td>',html+='<td style="width:30%" class="tb-align-right">Rp '+AppCashier.number_format(delivery_cost,0)+"</td>",html+="</tr>",total+=delivery_cost),html+="<tr>",html+='<td style="width:40%"></td>',html+='<td style="width:30%"><b>Total</b></td>',html+='<td style="width:30%" class="tb-align-right">Rp '+AppCashier.number_format(total,0)+"</td>",html+="</tr>",void a(".total-payment tbody").html(html))},pettyCashProcess:function(){a("#dataTables-petty-cash").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:a("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"name"},{data:"description"},{data:"amount"},{data:"actions"}],columnDefs:[{targets:3,orderable:!1,bSearchable:!1,"class":"center-tr"}],order:[[0,"desc"]]});a(document).on("click",".btn-petty-cash-delete",function(){return user_confirmation=a(this).attr("feature_confirmation"),void 0==user_confirmation&&(user_confirmation=""),""!=user_confirmation?(AppNav.showConfirmationPIN(user_confirmation,"#dataTables-petty-cash tbody tr:eq("+a(this).parents("tr").index()+") .btn-petty-cash-delete","click",1),!1):(url=a(this).attr("href"),AppCashier.confirm("Anda yakin ingin menghapus data ini?",function(){window.location.href=url}),!1)});a("#dataTables-balance").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:a("#dataProcessBalanceUrl").val(),iDisplayLength:10,columns:[{data:"name"},{data:"description"},{data:"amount"},{data:"actions"}],columnDefs:[{targets:3,orderable:!1,bSearchable:!1,"class":"center-tr"}],order:[[0,"desc"]]})},reservationProcess:function(){var b=AppCashier.baseUrl+"reservation/get_table_reservation",c=a.ajax({type:"POST",url:b,data:{book_date:a("#book_date").val()}});c.done(function(b){if(""!=b){var c=JSON.parse(b);a("#ddl_table").html(c.msg)}else window.location.reload(!0)}),is_delivery=a("#is_delivery").val(),void 0==is_delivery&&(is_delivery=0),is_takeaway=a("#is_takeaway").val(),void 0==is_takeaway&&(is_takeaway=0),url_autocomplete=AppCashier.baseUrl+"reservation/get_customer_auto_complete?is_delivery="+is_delivery+"&is_takeaway="+is_takeaway,options={url:url_autocomplete,getValue:"customer_name",template:{type:"description",fields:{description:"customer_address"}},list:{onSelectItemEvent:function(){var b=a("#customer_name").getSelectedItemData();a("#customer_address").val(b.customer_address),a("#customer_phone,#phone").val(b.customer_phone)},match:{enabled:!0}},theme:"plate-dark"},a("#reservation_delivery_cost_id").on("change",function(){AppCashier.reservationSubtotal()}),a(".order_type_reservation").on("click",function(){value=a(this).val(),a("#order_type").val(value),a("#reservation_delivery_cost_id").val("").hide(),1==value?(a("#ddl_table").parents(".form-group:first").show(),a("#customer_count").parents(".form-group:first").show()):(a("#ddl_table").val(""),a("#ddl_table").parents(".form-group:first").hide(),a("#customer_count").parents(".form-group:first").hide(),3==value&&a("#reservation_delivery_cost_id").val("").show()),AppCashier.reservationSubtotal()}),AppCashier.reservationSubtotal(),a("#btn-save-reservation").on("click",function(b){b.preventDefault(),AppCashier.loadingOverlay.show();var c=a("#menu_id_selected").val(),d=a(".count-order").val(),e="",f="",g=a(".order-notes").val();a(".chk_dish:checked").each(function(){f+=a(this).val()+","}),f=f.slice(0,-1),a(".options :selected").each(function(b,c){e+=a(c).val()+","}),e=e.slice(0,-1);var h=a.ajax({type:"POST",url:AppCashier.baseUrl+"reservation/temp_save_order_menu",data:{menu_id:c,count:d,option:e,side_dish:f,notes:g,outlet_id:a(".total-available-"+a("#menu_id_selected").val()).data("outlet")}});h.done(function(b){if(""!=b){var c=JSON.parse(b);c.status===!0?(a(".bill-table tbody").append(c.order_list),AppCashier.reservationSubtotal(),a(".popup-block").hide(),a("#form-input-order").get(0).reset(),a("#form-input-order").find("textarea").val(""),a(".remove_reservation_menu").unbind("click").bind("click",function(){a(this).parents("tr").remove(),AppCashier.reservationSubtotal()})):window.location.reload(!0)}AppCashier.loadingOverlay.hide()})}),a(".btn-cancel-dine-in, .btn-cancel").on("click",function(b){b.preventDefault(),void 0!=a("#form-input-order").get(0)&&a("#form-input-order").get(0).reset(),a("#form-input-order").find("textarea").val(""),a(".popup-block").hide()});var d=a("#dataTables-reservation").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:a("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"customer_name"},{data:"phone"},{data:"book_date"},{data:"status_reservasi"},{data:"order_type"},{data:"customer_count"},{data:"book_note"},{data:"table_name"},{data:"down_payment"},{data:"actions"}],columnDefs:[{targets:6,orderable:!1,bSearchable:!1,"class":"center-tr"},{targets:7,orderable:!1,bSearchable:!1,"class":"center-tr"},{targets:8,orderable:!1,bSearchable:!1,"class":"center-tr"},{targets:9,orderable:!1,bSearchable:!1,"class":"center-tr"}],order:[[2,"desc"]]});Date.prototype.addHours=function(a){return this.setHours(this.getHours()+a),this};new Date;a("#panel_calendar").datetimepicker({sideBySide:!0,useCurrent:!1,format:"YYYY-MM-DD HH:mm",minDate:new Date}),a("#panel_calendar").on("dp.change",function(b){var c=AppCashier.baseUrl+"reservation/get_table_reservation",d=a.ajax({type:"POST",url:c,data:{book_date:a("#book_date").val()}});d.done(function(b){if(""!=b){var c=JSON.parse(b);a("#ddl_table").html(c.msg)}else window.location.reload(!0)})}),a("#dataTables-reservation tbody").on("click",".btn-reserv-delete",function(b){if(user_confirmation=a(this).attr("feature_confirmation"),void 0==user_confirmation&&(user_confirmation=""),""!=user_confirmation)return void AppNav.showConfirmationPIN(user_confirmation,"#dataTables-reservation tbody tr:eq("+a(this).parents("tr").index()+") .btn-reserv-delete","click",1);var c=(a(this).attr("data-status"),""),e=a(this).attr("data-id");c="Hapus Status Reserved",a(".btn-save-replace-reserv").attr("data-status","3");var f=a.ajax({type:"POST",url:AppCashier.baseUrl+"table/get_reserved_note",data:{}});f.done(function(b){if(""!=b){var d=JSON.parse(b);a("#popup-reservation-note").show(),a("#reservation-note").html(d.msg),a("#popup-reservation-note").find(".title-name").text(c),a("#custom-note").on("click",function(b){b.preventDefault(),a("#custom").prop("checked",!0),a("#custom").attr("checked","checked")})}else window.location=AppCashier.baseUrl}),a(".btn-close-reserv").on("click",function(b){b.preventDefault(),a(".popup-block").hide()}),a(".btn-save-replace-reserv").unbind("click").bind("click",function(b){b.preventDefault();var c=a.ajax({type:"POST",url:AppCashier.baseUrl+"table/update_reservation_status",data:{reservation_id:e,status:3,note:a("#form-reservation-note").serialize()}});c.done(function(b){var c=JSON.parse(b);1==c.status?(a("#popup-reservation-note").hide(),d.api().ajax.reload(),a(".alert-success").html("Berhasil Menghapus Data")):AppCashier.alert(c.msg)}),c.fail(function(){window.location.reload(!0)})})})},updateDiscount:function(){var b=a("#total-payment-left").find("#discount-percent"),c=a("#total-payment-left").find("#discount-total");if(0==parseInt(AppCashier.subtotalLeft))var d=0,e=0;else var d=parseInt(AppCashier.discountTotal)/AppCashier.subtotalLeft,e=AppCashier.discountTotal;100*d>100&&(d=1),a(c).html(AppCashier.moneyFormat(parseInt(e),"Rp ")),a(b).html(Math.ceil(100*d));var f=a("#total-payment-right").find("#discount-percent"),g=a("#total-payment-right").find("#discount-total");if(0==parseInt(AppCashier.subtotalRight))var h=0,i=0;else var h=parseInt(AppCashier.discountTotal)/AppCashier.subtotalRight,i=AppCashier.discountTotal;100*h>100&&(h=1),a(g).html(AppCashier.moneyFormat(parseInt(i),"Rp ")),a(f).html(Math.ceil(100*h)),AppCashier.subtotalRight>0?AppCashier.activateNumberButton(!0):AppCashier.disableNumberButton(!0)},setCreditPayment:function(){if(void 0==a("#ddl_bank").val()||0==a("#ddl_bank").val()||""==a("#ddl_bank").val())return void AppCashier.alert("Pilih Nama Bank terlebih dahulu");if(a("#value").val().length<=0)return void AppCashier.alert("Nomor Kartu Kredit Harus Diisi");if(a("#value").val().length>16)return void AppCashier.alert("Nomor Kartu Kredit Harus 16 digit");var b=a(".popup-input");if(AppCashier.creditPayment.accountId=b.find("#ddl_bank option:selected").attr("data-account-id"),AppCashier.creditPayment.bankId=b.find("#ddl_bank option:selected").val(),AppCashier.creditPayment.code=a("#value").val(),AppCashier.creditPayment.cardTypeId=a("#ddl_bank_account_card").val(),0==a("#promo_cc").val());else{a(".promo-cc-right, .promo-cc-left").show(),AppCashier.promoCcName=a("#promo_cc :selected").html();var c=AppCashier.baseUrl+"cashier/get_detail_promo_menu",d=(a("#category_id").val(),a("#promo_cc").val()),e=a.ajax({type:"POST",url:c,data:{promo_id:d}});e.done(function(b){var c=JSON.parse(b);console.log("GET DATA DETAIL PROMO MENU"),AppCashier.categoryPromoCc=[];for(var e=0;e<c.length;e++)AppCashier.categoryPromoCc.push(c[e]);a("#promo_cc_id").val(d),AppCashier.setPromoCc(AppCashier.promoCcName,!1),AppCashier.complimentPayment.amount=0,AppCashier.setSubTotal(),AppCashier.setGrandTotal(),AppCashier.setKembalian(),AppCashier.updateTaxInfo()}),e.fail(function(a,b){}),e.always(function(){})}b.hide()},setDebitPayment:function(){if(void 0==a("#ddl_bank").val()||0==a("#ddl_bank").val()||""==a("#ddl_bank").val())return void AppCashier.alert("Pilih Nama Bank terlebih dahulu");if(a("#value").val().length<=0)return void AppCashier.alert("Nomor Kartu Debit Harus Diisi");if(a("#value").val().length>16)return void AppCashier.alert("Nomor Kartu Debit Harus 16 digit");var b=a(".popup-input");AppCashier.debitPayment.accountId=b.find("#ddl_bank option:selected").attr("data-account-id"),AppCashier.debitPayment.bankId=b.find("#ddl_bank option:selected").val(),AppCashier.debitPayment.code=a("#value").val(),AppCashier.debitPayment.cardTypeId=a("#ddl_bank_account_card").val(),b.hide()},setFlazzPayment:function(){if(void 0==a("#ddl_flazz_bank").val()||0==a("#ddl_flazz_bank").val()||""==a("#ddl_flazz_bank").val())return void AppCashier.alert("Pilih Nama Bank terlebih dahulu");if(a("#value_flazz").val().length<=0)return void AppCashier.alert("Nomor Kartu Flazz Harus Diisi");if(a("#value_flazz").val().length>16)return void AppCashier.alert("Nomor Kartu Debit Harus 16 digit");var b=a(".popup-input-flazz");
AppCashier.flazzPayment.accountId=b.find("#ddl_flazz_bank option:selected").attr("data-account-id"),AppCashier.flazzPayment.bankId=b.find("#ddl_flazz_bank option:selected").val(),AppCashier.flazzPayment.code=a("#value_flazz").val(),AppCashier.flazzPayment.cardTypeId=a("#ddl_flazz_bank_account_card").val(),b.hide()},newPaymentProcess:function(b){if(down_payment=parseFloat(a("#reservation_id").attr("down_payment")),isNaN(down_payment)&&(down_payment=0),0===AppCashier.grandTotalRight&&0==down_payment)return AppCashier.alert("Jumlah Order Yang akan Di bayar tidak ada, silahkan pilih menu order"),void AppCashier.resetInputPayment();var c=b.val().slice(3).replace(/\,/g,"");switch(0===c.length&&(c=0),AppCashier.paymentType){case 1:if(AppCashier.voucherPayment.amount>0&&AppCashier.voucherPayment.amount>App.grandTotalRight)return;AppCashier.cashPayment.amount=parseInt(c),AppCashier.customerCashPayment=AppCashier.cashPayment.amount,a(".cashPayment").remove();var d="<tr class='cashPayment'><td> </td><td><b>"+(1==AppCashier.cashPayment.type?"Cash":"BON")+"</b></td><td class='tb-align-right'>"+AppCashier.moneyFormat(AppCashier.cashPayment.amount,"Rp ")+"</td></tr>";break;case 2:if(0===AppCashier.debitPayment.code)return;var e=parseInt(c)+AppCashier.creditPayment.amount+AppCashier.flazzPayment.amount+AppCashier.complimentPayment.hpp+AppCashier.cashPayment.amount;if(e>AppCashier.grandTotalRight)return void AppCashier.alert("Bayaran Kartu Tidak Boleh Lebih Dari Grand Total");AppCashier.debitPayment.amount=parseInt(c),a(".debitPayment").remove();var d="<tr class='debitPayment'><td> </td><td><b>Debit</b></td><td class='tb-align-right'>"+AppCashier.moneyFormat(AppCashier.debitPayment.amount,"Rp ")+"</td></tr>";break;case 3:if(0===AppCashier.creditPayment.code)return;var e=AppCashier.debitPayment.amount+AppCashier.flazzPayment.amount+parseInt(c)+AppCashier.complimentPayment.hpp+AppCashier.cashPayment.amount;if(e>AppCashier.grandTotalRight)return void AppCashier.alert("Bayaran Kartu Tidak Boleh Lebih Dari Grand Total");AppCashier.creditPayment.amount=parseInt(c),a(".creditPayment").remove();var d="<tr class='creditPayment'><td> </td><td><b>Credit</b></td><td class='tb-align-right'>"+AppCashier.moneyFormat(AppCashier.creditPayment.amount,"Rp ")+"</td></tr>";break;case 11:if(0===AppCashier.flazzPayment.code)return;var e=AppCashier.debitPayment.amount+AppCashier.creditPayment.amount+parseInt(c)+AppCashier.complimentPayment.hpp+AppCashier.cashPayment.amount;if(e>AppCashier.grandTotalRight)return void AppCashier.alert("Bayaran Kartu Tidak Boleh Lebih Dari Grand Total");AppCashier.flazzPayment.amount=parseInt(c),a(".flazzPayment").remove();var d="<tr class='flazzPayment'><td> </td><td><b>Flazz</b></td><td class='tb-align-right'>"+AppCashier.moneyFormat(AppCashier.flazzPayment.amount,"Rp ")+"</td></tr>"}a(".payment-method").after(d),AppCashier.customerpay=AppCashier.cashPayment.amount+AppCashier.debitPayment.amount+AppCashier.creditPayment.amount+AppCashier.voucherPayment.amount+AppCashier.flazzPayment.amount+AppCashier.downPaymentBill.amount,AppCashier.setPaymentBill(),AppCashier.setGrandTotal(),5!=AppCashier.paymentType&&AppCashier.setKembalian(),a(".btn-preview-bill").prop("disabled",!0)},getDataCategoryLeft:function(){for(var a=[],b=0;b<AppCashier.leftDataOrder.length;b++)a.push(AppCashier.leftDataOrder[b].category_id);return a},getDataCategoryRight:function(){for(var a=[],b=0;b<AppCashier.rightDataOrder.length;b++)a.push(AppCashier.rightDataOrder[b].category_id);return a},array_unique:function(a){for(var b=[],c=0;c<a.length;c++)-1==b.indexOf(a[c])&&b.push(a[c]);return b},setPromoDiscount:function(b,c){console.log("SET PROMO discount"),a("#promo_id").prop("disabled",!1),a(".promo-compliment-right,.promo-compliment-left").remove();var d=0,e=0,f=0;if(AppCashier.categoryPromoDiscounts.length>0)if(void 0!=AppCashier.categoryPromoDiscounts[0].menu_id){for(var g=0;g<AppCashier.leftDataOrder.length;g++)for(var h=0;h<AppCashier.categoryPromoDiscounts.length;h++){AppCashier.leftDataOrder[g].product_price=AppCashier.leftDataOrder[g].origin_price;var i=AppCashier.leftDataOrder[g],j=AppCashier.categoryPromoDiscounts[h],k=AppCashier.leftDataOrder[g].origin_price;AppCashier.leftDataOrder[g].product_price;if(parseInt(i.menu_id)===parseInt(j.menu_id)){var l=a("#bill-table-left").find("tbody  > tr#"+i.product_id+"> td.price-menu");if(!c){d+=k*parseInt(j.discount)/100*i.product_amount;break}AppCashier.leftDataOrder[g].product_price=k}}for(var m=0;m<AppCashier.rightDataOrder.length;m++)for(var h=0;h<AppCashier.categoryPromoDiscounts.length;h++){AppCashier.rightDataOrder[m].product_price=AppCashier.rightDataOrder[m].origin_price;var i=AppCashier.rightDataOrder[m],j=AppCashier.categoryPromoDiscounts[h],k=AppCashier.rightDataOrder[m].origin_price;AppCashier.rightDataOrder[m].product_price;if(parseInt(i.menu_id)===parseInt(j.menu_id)){var l=a("#bill-table-right").find("tbody  > tr#"+i.product_id+"> td.price-menu");if(!c){e+=k*parseInt(j.discount)/100*i.product_amount,f=j.discount;break}AppCashier.rightDataOrder[m].product_price=k,l.html(AppCashier.moneyFormat(AppCashier.rightDataOrder[m].origin_price*i.product_amount,"Rp "))}}}else{for(var g=0;g<AppCashier.leftDataOrder.length;g++)for(var h=0;h<AppCashier.categoryPromoDiscounts.length;h++){AppCashier.leftDataOrder[g].product_price=AppCashier.leftDataOrder[g].origin_price;var i=AppCashier.leftDataOrder[g],j=AppCashier.categoryPromoDiscounts[h],k=AppCashier.leftDataOrder[g].origin_price;AppCashier.leftDataOrder[g].product_price;if(parseInt(i.category_id)===parseInt(j.category_id)){var l=a("#bill-table-left").find("tbody  > tr#"+i.product_id+"> td.price-menu");if(!c){d+=k*parseInt(j.discount)/100*i.product_amount;break}AppCashier.leftDataOrder[g].product_price=k}}for(var m=0;m<AppCashier.rightDataOrder.length;m++)for(var h=0;h<AppCashier.categoryPromoDiscounts.length;h++){AppCashier.rightDataOrder[m].product_price=AppCashier.rightDataOrder[m].origin_price;var i=AppCashier.rightDataOrder[m],j=AppCashier.categoryPromoDiscounts[h],k=AppCashier.rightDataOrder[m].origin_price;AppCashier.rightDataOrder[m].product_price;if(parseInt(i.category_id)===parseInt(j.category_id)){var l=a("#bill-table-right").find("tbody  > tr#"+i.product_id+"> td.price-menu");if(!c){e+=k*parseInt(j.discount)/100*i.product_amount,f=j.discount;break}AppCashier.rightDataOrder[m].product_price=k,l.html(AppCashier.moneyFormat(AppCashier.rightDataOrder[m].origin_price*i.product_amount,"Rp "))}}}if(AppCashier.rightDataOrder.length>0){if(c===!1)if(0==a("#promo_id").val()){a(".promo-discount-right").remove();var n="<tr class='promo-discount-right'><td> </td><td><b></b></td><td class='tb-align-right'></td></tr>";a("#total-payment-right").find(".discount-order-list").after(n)}else{a(".promo-discount-right").remove();var n="<tr class='promo-discount-right'><td> </td><td><b>Promo "+b+" "+f+"%</b></td><td class='tb-align-right'>"+AppCashier.moneyFormat(e,"Rp ")+"</td></tr>";a("#total-payment-right").find(".discount-order-list").after(n)}}else{a(".promo-discount-right").remove();var n="<tr class='promo-discount-right'><td> </td><td><b></b></td><td class='tb-align-right'></td></tr>";a("#total-payment-right").find(".discount-order-list").after(n)}AppCashier.totRightPromoDisc=e,AppCashier.totLeftPromoDisc=d},setPromoCc:function(b,c){console.log("SET PROMO CC"),a("#promo_cc").prop("disabled",!1),a(".promo-compliment-right,.promo-compliment-left").remove();var d=0,e=0,f=0;if(AppCashier.categoryPromoCc.length>0)if(priceText=a("#subtotal-price").attr("data-price"),price=priceText.replace(/\./g,""),subtotal=parseInt(price),subtotal<AppCashier.categoryPromoCc[0].min_order)AppCashier.rightDataOrder.length>0&&(AppCashier.alert("Promo tidak dapat digunakan. Minimum order tidak mencukupi."),b="",f=0,e=0);else if(void 0!=AppCashier.categoryPromoCc[0].menu_id){for(var g=0;g<AppCashier.leftDataOrder.length;g++)for(var h=0;h<AppCashier.categoryPromoCc.length;h++){AppCashier.leftDataOrder[g].product_price=AppCashier.leftDataOrder[g].origin_price;var i=AppCashier.leftDataOrder[g],j=AppCashier.categoryPromoCc[h],k=AppCashier.leftDataOrder[g].origin_price;AppCashier.leftDataOrder[g].product_price;if(parseInt(i.menu_id)===parseInt(j.menu_id)){var l=a("#bill-table-left").find("tbody  > tr#"+i.product_id+"> td.price-menu");if(!c){d+=k*parseInt(j.discount)/100*i.product_amount;break}AppCashier.leftDataOrder[g].product_price=k}}for(var m=0;m<AppCashier.rightDataOrder.length;m++)for(var h=0;h<AppCashier.categoryPromoCc.length;h++){AppCashier.rightDataOrder[m].product_price=AppCashier.rightDataOrder[m].origin_price;var i=AppCashier.rightDataOrder[m],j=AppCashier.categoryPromoCc[h],k=AppCashier.rightDataOrder[m].origin_price;AppCashier.rightDataOrder[m].product_price;if(parseInt(i.menu_id)===parseInt(j.menu_id)){var l=a("#bill-table-right").find("tbody  > tr#"+i.product_id+"> td.price-menu");if(!c){e+=k*parseInt(j.discount)/100*i.product_amount,f=j.discount;break}AppCashier.rightDataOrder[m].product_price=k,l.html(AppCashier.moneyFormat(AppCashier.rightDataOrder[m].origin_price*i.product_amount,"Rp "))}}}else{for(var g=0;g<AppCashier.leftDataOrder.length;g++)for(var h=0;h<AppCashier.categoryPromoCc.length;h++){AppCashier.leftDataOrder[g].product_price=AppCashier.leftDataOrder[g].origin_price;var i=AppCashier.leftDataOrder[g],j=AppCashier.categoryPromoCc[h],k=AppCashier.leftDataOrder[g].origin_price;AppCashier.leftDataOrder[g].product_price;if(parseInt(i.category_id)===parseInt(j.category_id)){var l=a("#bill-table-left").find("tbody  > tr#"+i.product_id+"> td.price-menu");if(!c){d+=k*parseInt(j.discount)/100*i.product_amount;break}AppCashier.leftDataOrder[g].product_price=k}}for(var m=0;m<AppCashier.rightDataOrder.length;m++)for(var h=0;h<AppCashier.categoryPromoCc.length;h++){AppCashier.rightDataOrder[m].product_price=AppCashier.rightDataOrder[m].origin_price;var i=AppCashier.rightDataOrder[m],j=AppCashier.categoryPromoCc[h],k=AppCashier.rightDataOrder[m].origin_price;AppCashier.rightDataOrder[m].product_price;if(parseInt(i.category_id)===parseInt(j.category_id)){var l=a("#bill-table-right").find("tbody  > tr#"+i.product_id+"> td.price-menu");if(!c){e+=k*parseInt(j.discount)/100*i.product_amount,f=j.discount;break}AppCashier.rightDataOrder[m].product_price=k,l.html(AppCashier.moneyFormat(AppCashier.rightDataOrder[m].origin_price*i.product_amount,"Rp "))}}}if(AppCashier.rightDataOrder.length>0){if(c===!1)if(0>=e){a(".promo-cc-right").remove();var n="<tr class='promo-cc-right'><td> </td><td><b></b></td><td class='tb-align-right'></td></tr>";a("#total-payment-right").find(".discount-order-list").after(n)}else{a(".promo-cc-right").remove();var n="<tr class='promo-cc-right'><td> </td><td><b>Promo "+b+" "+f+"%</b></td><td class='tb-align-right'>"+AppCashier.moneyFormat(e,"Rp ")+"</td></tr>";a("#total-payment-right").find(".discount-order-list").after(n)}}else{a(".promo-cc-right").remove();var n="<tr class='promo-cc-right'><td> </td><td><b></b></td><td class='tb-align-right'></td></tr>";a("#total-payment-right").find(".discount-order-list").after(n)}AppCashier.totRightPromoCc=e,AppCashier.totLeftPromoCc=d},resetInputPayment:function(){var b,c=a("#input-payment");switch(AppCashier.paymentType){case 1:b=AppCashier.cashPayment.amount;break;case 2:b=AppCashier.debitPayment.amount;break;case 3:b=AppCashier.creditPayment.amount;break;case 5:b=AppCashier.customerpay;break;case 11:b=AppCashier.flazzPayment.amount}0==b?c.val(""):c.val(b),c.trigger("change")},setKembalian:function(){AppCashier.setGrandTotal();var b=AppCashier.voucherPayment.amount-AppCashier.grandTotalRight;if(AppCashier.pendingbillEmployee.amount>0&&(AppCashier.customerpay=AppCashier.grandTotalRight),5==AppCashier.paymentType||AppCashier.complimentPayment.hpp>0){var c=AppCashier.complimentPayment.hpp+AppCashier.cashPayment.amount+AppCashier.creditPayment.amount+AppCashier.debitPayment.amount+AppCashier.flazzPayment.amount,d=c-AppCashier.grandTotalRight;d==AppCashier.customerpay&&(d=0,AppCashier.cashPayment.amount=0,AppCashier.creditPayment.amount=0,AppCashier.debitPayment.amount=0,AppCashier.flazzPayment.amount=0,a(".cashPayment").remove(),a(".debitPayment").remove(),a(".creditPayment").remove(),a(".flazzPayment").remove()),AppCashier.paymentBalance=d,a(".payment-sisa").html(AppCashier.moneyFormat(AppCashier.paymentBalance,"Rp "))}else{var d=AppCashier.customerpay-AppCashier.grandTotalRight;AppCashier.paymentBalance=d}if(AppCashier.downPaymentBill.amount>0){var d=AppCashier.downPaymentBill.amount-AppCashier.grandTotalRight;if(AppCashier.paymentBalance=d,AppCashier.customerpay>=AppCashier.grandTotalRight){var d=AppCashier.customerpay-AppCashier.grandTotalRight;AppCashier.paymentBalance=d}}d>=0&&(AppCashier.paymentBalance=0),a(".payment-sisa").html(AppCashier.moneyFormat(AppCashier.paymentBalance,"Rp ")),b>0&&b>AppCashier.grandTotalRight&&(d-=b),(AppCashier.grandTotalRight<=0||0>=d)&&(d=0),a("#total-payment-right").find(".payment-text").html(AppCashier.moneyFormat(d,"Rp ")),AppCashier.paymentBalance<0?a("#done-payment").prop("disabled",!0):AppCashier.rightDataOrder.length>0&&a("#done-payment").prop("disabled",!1),AppCashier.kembalian=d},setPaymentBill:function(){switch(AppCashier.paymentType){case 1:if(a(".cashPayment").remove(),AppCashier.cashPayment.amount<=0)return;var b="<tr class='cashPayment'><td> </td><td><b>Cash</b></td><td class='tb-align-right'>"+AppCashier.moneyFormat(AppCashier.cashPayment.amount,"Rp ")+"</td></tr>";break;case 2:if(a(".debitPayment").remove(),AppCashier.debitPayment.amount<=0||0===AppCashier.debitPayment.code)return;var b="<tr class='debitPayment'><td> </td><td><b>Debit</b> ("+AppCashier.debitPayment.code+")</td><td class='tb-align-right'>"+AppCashier.moneyFormat(AppCashier.debitPayment.amount,"Rp ")+"</td></tr>";break;case 3:if(a(".creditPayment").remove(),AppCashier.creditPayment.amount<=0||0===AppCashier.creditPayment.code)return;var b="<tr class='creditPayment'><td> </td><td><b>Credit</b>("+AppCashier.creditPayment.code+")</td><td class='tb-align-right'>"+AppCashier.moneyFormat(AppCashier.creditPayment.amount,"Rp ")+"</td></tr>";break;case 4:if(a(".voucherPayment").remove(),AppCashier.voucherPayment.amount<=0||0===AppCashier.voucherPayment.code)return;var b="<tr class='voucherPayment'><td> </td><td><b>Voucher</b>("+AppCashier.voucherPayment.code+")</td><td class='tb-align-right'>"+AppCashier.moneyFormat(AppCashier.voucherPayment.amount,"Rp ")+"</td></tr>";break;case 6:a(".pendingbill").remove();var b="<tr class='pendingbill'><td> </td><td><b>Pending</b></td><td class='tb-align-right'>"+AppCashier.moneyFormat(AppCashier.pendingbill.amount,"Rp ")+"</td></tr>";AppCashier.paymentType=1;break;case 7:a(".pendingbillEmployee").remove();var b="<tr class='pendingbillEmployee'><td> </td><td><b>Pending Karyawan ("+AppCashier.pendingbillEmployee.code_name+")</b></td><td class='tb-align-right'>"+AppCashier.moneyFormat(AppCashier.pendingbillEmployee.amount,"Rp ")+"</td></tr>";AppCashier.paymentType=1;break;case 8:a(".pendingbill").remove();var b="<tr class='pendingbill'><td> </td><td><b>Sisa</b></td><td class='tb-align-right'>"+AppCashier.moneyFormat(-1*AppCashier.pendingbill.amount,"Rp ")+"</td></tr>";AppCashier.paymentType=1;break;case 11:if(a(".flazzPayment").remove(),AppCashier.flazzPayment.amount<=0||0===AppCashier.flazzPayment.code)return;var b="<tr class='flazzPayment'><td> </td><td><b>Flazz</b>("+AppCashier.flazzPayment.code+")</td><td class='tb-align-right'>"+AppCashier.moneyFormat(AppCashier.flazzPayment.amount,"Rp ")+"</td></tr>"}a("#total-payment-right").find(".payment-method").before(b)},resetPayment:function(){a(".cashPayment, .debitPayment, .creditPayment, .voucherPayment, .discount-member, .pendingbill").remove(),AppCashier.cashPayment.amount=0,AppCashier.debitPayment.amount=0,AppCashier.creditPayment.amount=0,AppCashier.flazzPayment.amount=0,AppCashier.voucherPayment.amount=0,AppCashier.complimentPayment.amount=0,AppCashier.complimentPayment.hpp=0,AppCashier.complimentPayment.limit=0,AppCashier.complimentPayment.is_cogs=0,AppCashier.pendingbill.amount=0,AppCashier.customerpay=0,AppCashier.discountMemberId=0,AppCashier.discountMember=0,AppCashier.updateDiscountMember(),AppCashier.grandTotalRight=0,AppCashier.subtotalTaxRight=0,AppCashier.subtotalRight=0,AppCashier.orginTotalRight=0,AppCashier.totRightPromoDisc=0,AppCashier.totRightPromoCc=0,a("#text-code").text("")},resetPaymentUI:function(){a(".cashPayment, .debitPayment, .creditPayment, .flazzPayment, .voucherPayment, .discount-member, .pendingbill,.pendingbillEmployee").remove(),AppCashier.pendingbillEmployee.amount=0,AppCashier.pendingbill.amount=0},setDiscountPendingBill:function(){a(".pendingbillEmployee").remove(),AppCashier.pendingbillEmployee.amount>0&&(AppCashier.disableNumberButton(!0),AppCashier.pendingbillEmployee.amount=AppCashier.grandTotalRight,AppCashier.pendingbillEmployee.code=a("#profile option:selected").val(),AppCashier.pendingbillEmployee.code_name=a("#profile option:selected").text(),AppCashier.customerpay=AppCashier.grandTotalRight,AppCashier.paymentType=AppCashier.pendingbillEmployee.type,App.setPaymentBill()),AppCashier.pendingbill.amount>0&&(AppCashier.disableNumberButton(!0),1==AppCashier.pendingbill.is_banquet||(AppCashier.paymentType=AppCashier.pendingbill.type,App.setPaymentBill(),AppCashier.customerpay=parseInt(AppCashier.grandTotalRight)))},setPendingBill:function(){var b=a(".nav-tabs .active").attr("data-id");if(AppCashier.resetPaymentUI(),AppCashier.disableNumberButton(!0),"company"==b){var c=AppCashier.baseUrl+"cashier/get_order_company",d={order_company_id:a("#order_company option:selected").val()},e=a.ajax({type:"POST",url:c,data:d});e.done(function(a){var b=JSON.parse(a);if(b.status)if(AppCashier.pendingbill.code=b.data.id,AppCashier.pendingbill.code_name=b.data.company_name,AppCashier.pendingbill.is_banquet=parseInt(b.data.is_use_banquet),1==AppCashier.pendingbill.is_banquet){if(AppCashier.grandTotalRight<parseInt(b.data.down_payment))return void AppCashier.alert(b.data.company_name+" terdaftar untuk pemesanan banquet<br> dengan minimal order sebesar : "+AppCashier.moneyFormat(parseInt(b.data.down_payment),"Rp "));AppCashier.grandTotalRight-=AppCashier.subtotalTaxRight,AppCashier.resetTaxInfo(),AppCashier.customerpay=AppCashier.grandTotalRight,parseInt(b.data.down_payment)>0&&(AppCashier.cashPayment.amount=parseInt(b.data.down_payment),AppCashier.customerCashPayment=AppCashier.cashPayment.amount,AppCashier.paymentType=AppCashier.cashPayment.type,App.setPaymentBill());var c=AppCashier.grandTotalRight-b.data.down_payment;AppCashier.pendingbill.amount=parseInt(c),AppCashier.paymentType=AppCashier.pendingbill.type,App.setPaymentBill(),App.setKembalian()}else{AppCashier.updateTaxInfo(),AppCashier.customerpay=AppCashier.grandTotalRight;var c=AppCashier.grandTotalRight-b.data.down_payment;parseInt(b.data.down_payment)>0&&c>=0&&(AppCashier.cashPayment.amount=parseInt(b.data.down_payment),AppCashier.customerCashPayment=AppCashier.cashPayment.amount,AppCashier.paymentType=AppCashier.cashPayment.type,App.setPaymentBill()),0>c?AppCashier.pendingbill.type=8:AppCashier.pendingbill.type=6,AppCashier.pendingbill.amount=parseInt(c),AppCashier.paymentType=AppCashier.pendingbill.type,AppCashier.customerpay=parseInt(AppCashier.grandTotalRight),App.setPaymentBill(),App.setKembalian(),0>c?AppCashier.pendingbill.amount=parseInt(AppCashier.grandTotalRight):AppCashier.pendingbill.amount=parseInt(c)}})}else{AppCashier.paymentType=AppCashier.pendingbillEmployee.type,AppCashier.pendingbillEmployee.amount=AppCashier.grandTotalRight,AppCashier.pendingbillEmployee.code=a("#profile option:selected").val(),AppCashier.pendingbillEmployee.code_name=a("#profile option:selected").text(),AppCashier.customerpay=AppCashier.grandTotalRight;var f=AppCashier.pendingbillEmployee.code,c=AppCashier.baseUrl+"cashier/get_member_detail_by_db_id",e=a.ajax({type:"POST",url:c,data:{member_id:f}});e.done(function(a){var b=JSON.parse(a);if(b.status){if(0==AppCashier.orginTotalRight)return void AppCashier.alert("Data Order Tidak ada");AppCashier.orginTotalRight*parseInt(b.percentage)/100;AppCashier.discountMemberId=f,AppCashier.discountMemberPercentage=b.percentage,AppCashier.updateDiscountMember(),AppCashier.setSubTotal(),AppCashier.setGrandTotal(),AppCashier.setKembalian(),AppCashier.hideAllPopup(),AppCashier.updateTaxInfo(),App.setPaymentBill()}else AppCashier.alert(b.msg)})}},setMemberPayment:function(){if(AppCashier.complimentPayment.amount>0)App.alert("Sudah Menggunakan Compliment"),AppCashier.hideAllPopup();else{var b=a("#member_id_val").val(),c=AppCashier.baseUrl+"cashier/get_member_detail",d=a.ajax({type:"POST",url:c,data:{member_id:b}});d.done(function(a){var c=JSON.parse(a);if(c.status){if(0==AppCashier.orginTotalRight)return void AppCashier.alert("Data Order Tidak ada");AppCashier.orginTotalRight*parseInt(c.percentage)/100;AppCashier.discountMemberId=b,AppCashier.discountMemberPercentage=c.percentage,AppCashier.updateDiscountMember(),AppCashier.setSubTotal(),AppCashier.setGrandTotal(),AppCashier.setKembalian(),AppCashier.hideAllPopup()}else AppCashier.discountMemberId=0,AppCashier.discountMember=0,AppCashier.discountMemberPercentage=0,AppCashier.alert(c.msg)})}},resetTaxInfo:function(){AppCashier.subtotalTaxRight=0,AppCashier.subtotalTaxLeft=0;for(var b=a("#total-payment-left").find("#tax-price"),c=0;c<b.length;c++)a(b[c]).html(AppCashier.moneyFormat(0,"Rp "));for(var d=a("#total-payment-right").find("#tax-price"),e=0;e<d.length;e++)a(d[e]).html(AppCashier.moneyFormat(0,"Rp "));for(var f=a("#total-payment-left").find("#pembulatan"),c=0;c<f.length;c++)a(f[c]).html(AppCashier.moneyFormat(0,"Rp "));for(var g=a("#total-payment-right").find("#pembulatan"),e=0;e<g.length;e++)a(g[e]).html(AppCashier.moneyFormat(0,"Rp "));AppCashier.setKembalian(),AppCashier.setGrandTotal()},validationNumber:function(b){b.on("keydown",function(c){return"form-control compliment-payment-val"==b.attr("class")||"form-control voucher-payment-val"==b.attr("class")||"form-control member-payment-val"==b.attr("class")?!0:void(-1!==a.inArray(c.keyCode,[46,8,9,27,13])||65==c.keyCode&&c.ctrlKey===!0||c.keyCode>=35&&c.keyCode<=39||(c.shiftKey||c.keyCode<48||c.keyCode>57)&&(c.keyCode<96||c.keyCode>105)&&c.preventDefault())})},updateDiscountMember:function(){if(!(AppCashier.complimentPayment.amount>0)&&0!==AppCashier.discountMemberId){AppCashier.discountMember=AppCashier.discountMemberPercentage/100*AppCashier.orginTotalRight,a(".discount-member").remove();var b="<tr class='discount-member'><td> </td><td><b>Diskon Member ("+AppCashier.discountMemberPercentage+"%)</b></td><td class='tb-align-right'>"+AppCashier.moneyFormat(AppCashier.discountMember,"Rp ")+"</td></tr>";a("#total-payment-right").find(".discount-order-list").after(b)}},initKeyboardDefault:function(b){var c=/mobile|android/i.test(navigator.userAgent);if(!c){var d=a("#value").keyboard().getkeyboard();d.destroy(),b.keyboard({layout:"custom",customLayout:{normal:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","q w e r t y u i o p [ ] \\","a s d f g h j k l ; ' ","{shift} z x c v b n m , . / {shift}","{accept} {space} {left} {right}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","Q W E R T Y U I O P { } |",'A S D F G H J K L : " ',"{shift} Z X C V B N M < > ? {shift}","{accept} {space} {left} {right}"]},restrictInput:!1,preventPaste:!1,autoAccept:!1,lockInput:!1})}},initKeyboardNumber:function(b){var c=/mobile|android/i.test(navigator.userAgent);if(!c){var d=a("#value").keyboard().getkeyboard();d.destroy(),b.keyboard({layout:"custom",customLayout:{"default":["1 2 3","4 5 6","7 8 9","{left} 0 {right}","{bksp} {a} {c}"]},maxLength:16,restrictInput:!1,preventPaste:!1,autoAccept:!1,lockInput:!1})}},getOnlineReservation:function(){a("#get_online_data").on("click",function(){var b=a(this).attr("href");return App.overlayUI.show(),a.ajax({url:b,dataType:"JSON",success:function(a){AppCashier.alert(a.message),App.overlayUI.hide(),1==a.status&&window.location.reload()}}),!1})}}});