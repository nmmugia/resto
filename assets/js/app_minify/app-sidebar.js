define(["jquery","jquery-ui","bootstrap","datatables","datatables-bootstrap","metisMenu","multiselect"],function(a,b){return{overlayUI:a("#cover"),baseUrl:a("#root_base_url").val(),init:function(){App.overlayUI.show(),App.initFunc(App),App.groupsAccessProcess(),App.sideBarProcess(),App.overlayUI.hide(),a("#side-menu").metisMenu(),a(window).bind("load resize",function(){topOffset=50,width=this.window.innerWidth>0?this.window.innerWidth:this.screen.width,width<768?(a("div.navbar-collapse").addClass("collapse"),topOffset=100):a("div.navbar-collapse").removeClass("collapse"),height=this.window.innerHeight>0?this.window.innerHeight:this.screen.height,height-=topOffset,height<1&&(height=1),height>topOffset&&a("#page-wrapper").css("min-height",height+"px")})},groupsAccessProcess:function(){var b=a("#dataTables-groups").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:a("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"id"},{data:"name"},{data:"description"},{data:"actions"}],columnDefs:[{targets:3,orderable:!1,bSearchable:!1,"class":"center-tr"},{targets:[0],visible:!1}],order:[[1,"desc"]]});a("#dataTables-groups tbody").on("click",".btn-edit",function(){var c=a(this).closest("tr").index(),d=b.fnGetData(c).id,e=b.fnGetData(c).name,f=b.fnGetData(c).description;a("#id").val(d),a("#name").val(e),a("#description").val(f)}),a("#dataTables-groups tbody").on("click",".btn-feature",function(){var c=a(this).closest("tr").index(),d=(b.fnGetData(c).id,a(this).data("url")),e=a.ajax({type:"POST",url:d});e.done(function(b){a("#form-feature").attr("action",d),a("#modal-body-feature").html(b),App.groupFeatureProcess()}),a("#form-feature").unbind()}),a("#modal-form").on("show.bs.modal",function(b){var c=a(b.relatedTarget),d=c.data("title"),e=c.data("url"),f=a(this);f.find(".modal-title").text(d),a("form").attr("action",e),a("#modal-type").val(c.data("type"))}),a("#modal-form").on("hide.bs.modal",function(b){a(".result").html(""),a("#id").val(""),a("#name").val(""),a("#description").val("")}),a(".result-detail").html(""),a("#form-ajax").on("submit",function(c){c.preventDefault(),App.overlayUI.show();var d=a.ajax({type:"POST",url:a("form").attr("action"),data:a("#form-ajax").serialize()});d.done(function(c){if(""!=c){var d=JSON.parse(c);1==d.status?(b.api().ajax.reload(),a("#modal-form").modal("toggle"),App.messageSuccess(d.msg,"non")):App.messageError(d.msg,"popup"),App.overlayUI.hide()}else window.location.reload(!0)})})},groupFeatureProcess:function(){a(".multiselect").multiselect({keepRenderingSort:!0}),a("#form-feature").on("submit",function(b){b.preventDefault(),a("#feature_access").val(a("#multiselect_to_1").val()),App.overlayUI.show();var c=a.ajax({type:"POST",url:a("#form-feature").attr("action"),data:a("#form-feature").serialize()});c.done(function(b){if(""!=b){var c=JSON.parse(b);1==c.status?(a("#modal-feature").modal("hide"),App.messageSuccess(c.msg,"non")):App.messageError(c.msg,"popup"),App.overlayUI.hide()}else window.location.reload(!0)})})},sideBarProcess:function(){var b=a("#dataTables-sidebar").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:{url:a("#dataProcessUrl").val(),data:function(b){b.parent_id=a("#ddl_parent_menu").val()}},iDisplayLength:10,bFilter:!0,sDom:"lrtip",order:[[6,"asc"]],columns:[{data:"name"},{data:"url"},{data:"actions_sequence"},{data:"groups_access"},{data:"actions"},{data:"parent_id"},{data:"sequence"}],columnDefs:[{targets:4,orderable:!1,bSearchable:!1,"class":"center-tr"},{targets:5,visible:!1},{targets:6,visible:!1},{targets:2,orderable:!1,bSearchable:!1,"class":"center-tr"}]});a("#ddl_parent_menu").change(function(){b.api().ajax.reload()}),a(".multiselect").multiselect({keepRenderingSort:!0}),a(".form-ajax").on("submit",function(b){a("#menu_access").val(a("#multiselect_to_1").val()),console.log(a("#menu_access").val())}),a("#dataTables-sidebar tbody").on("click",".update-sequence",function(c){App.overlayUI.show();var d=a(this).closest("tr").index(),e=b.fnGetData(d).parent_id,f=b.fnGetData(d).sequence,g=a.ajax({type:"POST",url:a(this).data("url"),data:{parent_id:e,sequence:f}});g.done(function(a){b.api().ajax.reload(function(a){App.overlayUI.hide()})}),g.fail(function(a,b){window.location.reload(!0)})})}}});