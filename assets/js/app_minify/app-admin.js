define(["jquery","jquery-ui","app/app-hrd-dashboard","chained","metisMenu","Morris","datatables","bootstrap","datatables-bootstrap","timepicker","datepair","datetimepicker","highcharts","select2","qtip"],function(b,c,d){return{nodeUrl:b("#node_url").val(),socket:!1,baseUrl:b("#root_base_url").val(),serverBaseUrl:b("#server_base_url").val(),storeID:b("#store_id_config").val(),privateKey:b("#private_key").val(),overlayUI:b("#cover"),sidedishCount:null!=document.getElementById("sidedishCount")?document.getElementById("sidedishCount").value:0,optionsCount:null!=document.getElementById("optionsCount")?document.getElementById("optionsCount").value:0,optionsValueCount:null!=document.getElementById("optionsValueCount")?document.getElementById("optionsValueCount").value:0,printerKitchenCount:null!=document.getElementById("printer_kitchen_count")?document.getElementById("printer_kitchen_count").value:0,printerCheckerCount:null!=document.getElementById("printer_checker_count")?document.getElementById("printer_checker_count").value:0,printerCheckerKitchenCount:null!=document.getElementById("printer_checker_kitchen_count")?document.getElementById("printer_checker_kitchen_count").value:0,dataOutlet:null!=document.getElementById("data_outlet")?JSON.parse(b("#data_outlet").val()):0,leftDataOrder:[],rightDataOrder:[],hrdDashboard:d,enumOrder:{SINGLE:1,ALL:2},listAccounts:[],indexTotalExecuteSync:0,indexTotalFailedSync:0,listFailedSync:[],totalSync:41,initSocketIO:function(){App.socket=io(App.nodeUrl,{reconnectionAttempts:2}),App.socket.on("reconnect_failed",function(){console.log("error init initSocketIO")}),App.socket.on("connected",function(a){console.log("connected")})},init:function(){App.overlayUI.show(),App.buttonSubmitEvent(),App.initFunc(App),App.initEvent(),App.initSetLeftOrder(),App.FeatureSettingUI(),App.topProductDashboard(),App.hrdDashboard.init(),App.reportReceiveStock(),App.initListTransferFilter(),b("#show_printer_format_1").qtip({content:{text:b("#printer_format_1_image")},style:{"max-width":"410px"},position:{at:"top center",my:"bottom center"}}),b("#show_printer_format_2").qtip({content:{text:b("#printer_format_2_image")},style:{"max-width":"410px"},position:{at:"top center",my:"bottom center"}}),b("#show_voucher_method_1").qtip({content:{text:b("#voucher_method_1_image")},style:{"max-width":"410px"}}),b("#show_voucher_method_2").qtip({content:{text:b("#voucher_method_2_image")},style:{"max-width":"410px"}}),b(document).on("click","#filter_stock_opname_daily",function(a){b("#report_content").html(""),a.preventDefault();var c=b.ajax({type:"POST",url:App.baseUrl+"admincms/stock_opname/get_summary_inventory_data",data:{outlet_id:b("#formFilter #outlet_id").val(),inventory_id:b("#formFilter #inventory_id").val()}});c.done(function(a){b("#report_content").html(a)})}),b(document).on("click",".process_inventory",function(){inventory_id=b(this).attr("inventory_id"),b("#ip_inventory_id").val(inventory_id).select2(),b("#process-inventory-modal").modal("show")}),b(document).on("click","#save-process-inventory",function(a){var c=b(".result");return c.html(""),App.overlayUI.show(),check=!0,b(".requiredDropdown,.requiredDropDown").each(function(){("0"==b(this).val()||""==b(this).val()||void 0==b(this).val())&&(c.empty().html('<div class="alert alert-danger" role="alert">Anda harus memilih pilihan pada '+b(this).attr("field-name")+"</div>"),App.overlayUI.hide(),check=!1)}),b(".requiredTextField").each(function(){""==b(this).val()&&(c.empty().html('<div class="alert alert-danger" role="alert">Bagian '+b(this).attr("field-name")+" dibutuhkan</div>"),App.overlayUI.hide(),check=!1)}),1==check&&(el=this,data=b(this).parents("form").serialize(),url=b(this).parents("form").attr("action"),b.ajax({url:url,dataType:"JSON",data:data,type:"POST",success:function(a){App.overlayUI.hide(),App.alert(a.message),0==a.status?b(el).find(".result").html(a.message):b("#process-inventory-modal").modal("hide")}})),!1}),b("#outlet_id_chained").chained("#store_id_chained"),b(".filter_date").datetimepicker({sideBySide:!0,useCurrent:!0,format:"YYYY-MM-DD"}),b("#side-menu").metisMenu(),b(".select2").select2(),b(window).bind("load resize",function(){topOffset=50,width=this.window.innerWidth>0?this.window.innerWidth:this.screen.width,width<768?(b("div.navbar-collapse").addClass("collapse"),topOffset=100):b("div.navbar-collapse").removeClass("collapse"),height=this.window.innerHeight>0?this.window.innerHeight:this.screen.height,height-=topOffset,height<1&&(height=1),height>topOffset&&b("#page-wrapper").css("min-height",height+"px")}),b("#form-opname-single .qty-input").on("keyup",function(){qty=parseFloat(b(this).val()),isNaN(qty)&&(qty=0),stock_system=parseFloat(b("#form-opname-single #jumlah_stok").text()),difference=qty-stock_system,difference>0?(b("#form-opname-single .price input").val(""),b("#form-opname-single .price").show()):(b("#form-opname-single .price input").val(""),b("#form-opname-single .price").hide())}),b("#stock_opname_all_table .qty").on("keyup",function(){qty=parseFloat(b(this).val()),isNaN(qty)&&(qty=0),stock_system=parseFloat(b(this).parents("tr").find(".stock_system").val()),difference=qty-stock_system,difference>0?b(this).parents("tr").find(".price").val("").show():b(this).parents("tr").find(".price").val("").hide()}),b("#add_inventory_composition").click(function(){inventory_id=b("#parent_inventory_id").val(),b.ajax({url:App.baseUrl+"admincms/inventory/add_inventory_composition",type:"POST",data:{inventory_id:inventory_id},dataType:"JSON",success:function(a){b("#inventory_composition tbody").append(a.content),b("#inventory_composition tbody tr:last .select2").select2()}})}),b(document).on("click",".remove_inventory_composition",function(){b(this).parents("tr").remove()}),b(document).on("change",".detail_inventory_id",function(){inventory_id=b(this).val(),el=this,""!=inventory_id?b.ajax({url:App.baseUrl+"admincms/inventory/get_inventory_uoms",type:"POST",dataType:"JSON",data:{inventory_id:inventory_id},success:function(a){b(el).parents("tr").find(".detail_uom_id").html(a.content)}}):(b(this).parents("tr").find(".detail_uom_id").html("<option value=''>Pilih Satuan</option>"),b(this).parents("tr").find(".select2").select2())}),b("#convertion_inventory_id").change(function(){value=b(this).val(),"0"!=value?b.ajax({url:App.baseUrl+"admincms/inventory_convertions/add_detail_convertion",type:"POST",dataType:"JSON",data:{inventory_id:value},success:function(a){b("#inventory_convertion_uom tbody").html(a.content)}}):b("#inventory_convertion_uom tbody").html("")}),b(".target_type").change(function(){target_type=b(this).val(),1==target_type?(b("#target_by_total").val(""),b("#target_by_total_html").show(),b("#target_detail_table tbody").html(""),b("#target_by_item_html").hide()):(b("#target_by_total").val(""),b("#target_by_total_html").hide(),b("#target_detail_table tbody").html(""),b("#target_by_item_html").show())}),b("#add_target_menu").click(function(){menu_html=b("#tmp").html(),content="<tr><td>"+menu_html+'</td><td><input type="text" name="detail[target_qty][]" class="form-control only_numbers"></td><td><a href="javascript:void(0);" class="btn btn-danger remove_target_detail">Hapus</a></td>',"</tr>"+b("#target_detail_table tbody").append(content),b("#target_detail_table tbody tr:last select").select2()}),b(document).on("click",".remove_target_detail",function(){b(this).parents("tr").remove()}),b("#add_reward_kitcen").on("click",function(){b.ajax({url:App.baseUrl+"admincms/target_settings/get_reward_kitchen",dataType:"JSON",success:function(a){""!=a.data&&(b("#outlet_kitchen").val(a.data.outlet_id),b("#kitchen_reward").val(a.data.reward),b("#calculate_to_payroll").val(a.data.calculate_to_payroll))}})}),b(document).on("click","#save-kitchen-reward",function(){outlet_kitchen=b("#outlet_kitchen").val(),void 0==outlet_kitchen&&(outlet_kitchen=""),kitchen_reward=parseFloat(b("#kitchen_reward").val()),isNaN(kitchen_reward)&&(kitchen_reward=0),calculate_to_payroll=b("#calculate_to_payroll").val(),b.ajax({url:App.baseUrl+"admincms/target_settings/reward_kitchen",type:"POST",data:{reward:kitchen_reward,calculate_to_payroll:calculate_to_payroll,outlet_id:outlet_kitchen},success:function(){b("#kitchen-reward-modal").modal("hide")}})}),b("#stock_opname_outlet_id,#stock_opname_inventory_id").change(function(){var a=b("#stock_opname_outlet_id").val(),c=b("#stock_opname_inventory_id").val();App.overlayUI.show(),b.ajax({url:App.baseUrl+"admincms/stock/get_adjustment_by_outlet",type:"POST",dataType:"JSON",data:{outlet_id:a,inventory_id:c},success:function(a){b("#stock_opname_all_table tbody").html(a.content),App.overlayUI.hide()}})}),b(document).on("change","#spoiled_inventory_id",function(){inventory_id=b(this).val(),el=this,""!=inventory_id?(uom_id=b(this).find("option:selected").attr("uom_id"),b.ajax({url:App.baseUrl+"admincms/inventory/get_inventory_uoms",type:"POST",dataType:"JSON",data:{inventory_id:inventory_id},success:function(a){b("#uom_id").html(a.content),b("#uom_id").val(uom_id)}})):b("#uom_id").html("<option value=''>Pilih Satuan</option>")}),b("#save-spoiled").on("click",function(){var a=b("#spoiled_outlet_id").val(),c=b("#spoiled_inventory_id").val(),d=b("#uom_id").val(),e=b("#quantity").val(),f=b("#description").val();if(0===e.length)App.alert("Jumlah Stok harus diisi",function(){});else{var g=App.baseUrl+"admincms/spoiled/save_spoiled";b.ajax({url:g,type:"POST",data:{outlet_id:a,inventory_id:c,quantity:e,uom_id:d,description:f},success:function(a){var b=JSON.parse(a);App.alert(b.message)}})}}),b("#trigger_filter_spoiled").on("click",function(){var c=b("#filter_inventory_id").val(),d=b("#filter_outlet_id").val();a.columns(0).search(d),a.columns(1).search(c).draw()}),b("#dataTables-general-expenses").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:b("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"name"},{data:"description"},{data:"amount"},{data:"actions"}],columnDefs:[{targets:3,orderable:!1,bSearchable:!1,"class":"center-tr"}],order:[[0,"desc"]]}),b("#dataTables-delivery-cost").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:b("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"delivery_cost_name"},{data:"delivery_cost"}]});var a=b("#dataTables-spoiled").DataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:b("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"outlet_name"},{data:"join_name"},{data:"total_spoiled",defaultContent:0},{data:"cost_spoiled",defaultContent:0}],columnDefs:[{targets:[2,3],orderable:!1,bSearchable:!1,"class":"center-tr"}]});b("#dataTables-category").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:b("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"id"},{data:"category_name"},{data:"outlet_name"},{data:"store_name"},{data:"actions"}],columnDefs:[{targets:0,visible:!1,bSearchable:!1},{targets:4,orderable:!1,bSearchable:!1,"class":"center-tr"}],order:[[0,"desc"]]}),b("#dataTables-target-setting").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:b("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"name"},{data:"target_type"},{data:"reward"},{data:"actions"}],columnDefs:[{targets:3,orderable:!1,bSearchable:!1,"class":"center-tr"}]}),b("#dataTables-inventory-convertion").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:b("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"inventory_name"},{data:"actions"}],columnDefs:[{targets:1,orderable:!1,bSearchable:!1,"class":"center-tr"}]}),b("#dataTables-inventory").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:b("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"name"},{data:"price"},{data:"unit"},{data:"minimal_stock"},{data:"actions"}],columnDefs:[{targets:4,orderable:!1,bSearchable:!1,"class":"center-tr"}],order:[[0,"desc"]]}),b("#dataTables-inventory-process").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:b("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"created_at"},{data:"name"},{data:"quantity"},{data:"unit"}],columnDefs:[{targets:3,orderable:!1,bSearchable:!1,"class":"center-tr"}],order:[[0,"desc"]]}),b("#dataTables-menus").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:b("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"id"},{data:"menu_name"},{data:"menu_price"},{data:"outlet_name"},{data:"category_name"},{data:"actions"}],columnDefs:[{targets:0,visible:!1,bSearchable:!1},{targets:5,orderable:!1,bSearchable:!1,"class":"center-tr"}],order:[[0,"desc"]]}),b("#dataTables-outlet").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:b("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"id"},{data:"outlet_name"},{data:"value"},{data:"actions"}],columnDefs:[{targets:0,visible:!1,bSearchable:!1},{targets:3,orderable:!1,bSearchable:!1,"class":"center-tr"}],order:[[0,"desc"]]});var c=b("#dataTables-purchase-order-list").DataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:b("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"number"},{data:"order_at"},{data:"supplier_name"},{data:"description"},{data:"actions"}],columnDefs:[{targets:[4],orderable:!1,bSearchable:!1,"class":"center-tr"}],order:[[0,"desc"]]});b("#trigger_filter_po").on("click",function(){var a=b("#filter_supplier_id").val(),d=b(".filter_date input").val();column=b("#filter_supplier_id").data("target-column"),c.columns(column).search(a),column=b(".filter_date input").data("target-column"),c.columns(column).search(d).draw()});var d=b("#dataTables-receive-purchase-order-list").DataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:b("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"number"},{data:"order_at"},{data:"supplier_name"},{data:"total_po"},{data:"description"},{data:"status"},{data:"actions"}],columnDefs:[{targets:6,orderable:!1,bSearchable:!1,"class":"center-tr"},{targets:3,orderable:!0,bSearchable:!1,"class":"center-tr"}],order:[[0,"desc"]]});b("#trigger_filter_receive_po").on("click",function(){var a=b("#filter_supplier_id").val(),c=b(".filter_date input").val();column=b("#filter_supplier_id").data("target-column"),d.columns(column).search(a),column=b(".filter_date input").data("target-column"),d.columns(column).search(c).draw()});var e=b("#dataTables-received-list").DataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:b("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"number"},{data:"incoming_date"},{data:"name"},{data:"actions"}],columnDefs:[{targets:[0,1,2],orderable:!0,bSearchable:!0,"class":"left-tr"}],order:[[1,"desc"]]});b("#trigger_filter_received_po").on("click",function(){var a=b("#filter_supplier_id").val(),c=b("#filter_start_date").val(),d=b("#filter_end_date").val();column=b("#filter_supplier_id").data("target-column"),e.columns(column).search(a),column=b("#filter_start_date").data("target-column"),e.columns(column).search(c).draw(),column=b("#filter_end_date").data("target-column"),e.columns(column).search(d).draw()}),b("#reprint_billing_start_date").datetimepicker({sideBySide:!0,useCurrent:!0,format:"YYYY-MM-DD HH:mm"}),b("#reprint_billing_end_date").datetimepicker({sideBySide:!0,useCurrent:!0,format:"YYYY-MM-DD HH:mm"}),b("#reprint_billing_start_date").on("dp.change",function(a){b("#reprint_billing_end_date").datetimepicker({sideBySide:!0,useCurrent:!0,format:"YYYY-MM-DD HH:mm"}),b("#reprint_billing_end_date").data("DateTimePicker").minDate(a.date)}),b("#reprint_billing_end_date").on("dp.change",function(a){b("#reprint_billing_end_date").datetimepicker({sideBySide:!0,useCurrent:!0,format:"YYYY-MM-DD HH:mm"}),b("#reprint_billing_start_date").data("DateTimePicker").maxDate(a.date)});b("#table-reprint-billing").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",bFilter:!1,bDestroy:!0,autoWidth:!1,iDisplayLength:10,ajax:{url:b("#dataProcessUrl").val(),type:"POST",data:{param:b("#formFilter").serialize()}},columns:[{data:"payment_date"},{data:"table_name"},{data:"customer_name"},{data:"receipt_number"},{data:"order_type"},{data:"total_price"},{data:"customer_count"},{data:"order_id"},{data:"actions"}],columnDefs:[{targets:[5,6,7],orderable:!1}],order:[[0,"desc"]]});if(b("#reprint_billing_filter_submit").on("click",function(a){b("#formFilter").removeAttr("action"),b("#formFilter").removeAttr("target")}),b("#reprint_billing_export_pdf").on("click",function(a){b("#formFilter").attr("action",App.baseUrl+"admincms/reprint_billings/export_to_pdf"),b("#formFilter").attr("target","_blank")}),b("#dataTables-stock-transfer-request").dataTable({bLengthChange:!1,bPaginate:!1,columnDefs:[{targets:4,orderable:!1,bSearchable:!1,"class":"center-tr"}],order:[[0,"desc"]]}),b("#dataTables-stock-list").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:b("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"name"},{data:"jumlah"},{data:"code"}],columnDefs:[{targets:[1],orderable:!1,bSearchable:!1,"class":"center-tr"}],order:[[0,"desc"]]}),b("#dataTables-stock-detail").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:b("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"tanggal"},{data:"jumlah"},{data:"code"},{data:"price"}],columnDefs:[{targets:1,orderable:!1,bSearchable:!1,"class":"center-tr"}],order:[[0,"desc"]]}),b("#dataTables-store").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:b("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"id"},{data:"store_name"},{data:"store_address"},{data:"store_phone"},{data:"actions"}],columnDefs:[{targets:0,visible:!1,bSearchable:!1},{targets:4,orderable:!1,bSearchable:!1,"class":"center-tr"}],order:[[0,"desc"]]}),b("#dataTables-staff").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:b("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"id"},{data:"store_name"},{data:"outlet_name"},{data:"username"},{data:"name"},{data:"email"},{data:"phone"},{data:"gender"},{data:"actions"}],columnDefs:[{targets:0,visible:!1,bSearchable:!1},{targets:7,orderable:!1,bSearchable:!1},{targets:8,orderable:!1,bSearchable:!1,"class":"center-tr"}],order:[[0,"desc"]]}),b("#dataTables-staff-special").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:b("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"id"},{data:"username"},{data:"name"},{data:"email"},{data:"phone"},{data:"gender"},{data:"actions"}],columnDefs:[{targets:0,visible:!1,bSearchable:!1},{targets:5,orderable:!1,bSearchable:!1},{targets:6,orderable:!1,bSearchable:!1,"class":"center-tr"}],order:[[0,"desc"]]}),b("#dataTables-floor").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:b("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"id"},{data:"floor_name"},{data:"store_name"},{data:"actions"}],columnDefs:[{targets:0,visible:!1,bSearchable:!1},{targets:3,orderable:!1,bSearchable:!1,"class":"center-tr"}],order:[[0,"desc"]]}),b("#dataTables-sync").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:b("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"url"},{data:"controller"},{data:"start_time"},{data:"end_time"},{data:"interval"},{data:"actions"}],columnDefs:[{targets:5,orderable:!1,bSearchable:!1,"class":"center-tr"}],order:[[0,"desc"]],sScrollX:"100%"}),b("#dataTables-tax").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:b("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"tax_name"},{data:"tax_percentage"},{data:"actions"}],columnDefs:[{targets:2,orderable:!1,bSearchable:!1,"class":"center-tr"}],order:[[0,"desc"]]}),b("#dataTables-charges").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:b("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"charge_name"},{data:"charge_value"},{data:"actions"}],columnDefs:[{targets:2,orderable:!1,bSearchable:!1,"class":"center-tr"}],order:[[0,"desc"]]}),b("#dataTables-inventory-stock").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",ajax:b("#dataProcessUrl").val(),iDisplayLength:10,columns:[{data:"date"},{data:"outlet_name"},{data:"name"},{data:"minimal_stock"},{data:"stock"},{data:"unit"}],order:[[0,"desc"]]}),b(document).on("change","#ip_inventory_id",function(){inventory_id=b(this).val(),quantity=parseInt(b("#ip_quantity").val()),isNaN(quantity)&&(quantity=0),App.ShowTreeConvertion(inventory_id,quantity)}),b(document).on("keyup","#ip_quantity",function(){inventory_id=b("#ip_inventory_id").val(),quantity=parseInt(b(this).val()),isNaN(quantity)&&(quantity=0),App.ShowTreeConvertion(inventory_id,quantity)}),b(".sortable").sortable(),b(".sortable > span").disableSelection(),b("#add_side_dish").on("click",function(a){a.preventDefault();var c=b(".countside").length;10>c?(App.sidedishCount++,App.add_option("sidedish",App.sidedishCount)):App.alert("Side dish sudah mencapai batas maksimum")}),b("#add_options").on("click",function(a){a.preventDefault();var c=b(".countopt").length;10>c?(App.optionsCount++,App.add_option("options",App.optionsCount)):App.alert("Opsi sudah mencapai batas maksimum")}),b("#add_printer_kitchen").on("click",function(a){a.preventDefault();b(".printer_kitchen_count").length;App.printerKitchenCount++,App.add_option("printerKitchen",App.printerKitchenCount)}),b("#add_printer_checker").on("click",function(a){a.preventDefault();b("#printer_checker_count").length;App.printerKitchenCount++,App.add_option("printerChecker",App.printerKitchenCount)}),b("#add_printer_checker_kitchen").on("click",function(a){a.preventDefault();b("#printer_checker_kitchen_count").length;App.printerKitchenCount++,App.add_option("printerCheckerKitchen",App.printerKitchenCount)}),b("#sidedish_container").sortable({axis:"y",items:"tr",handle:".handle",forceHelperSize:!0,forcePlaceholderSize:!0}),b("#options_container").sortable({axis:"y",items:"tr",handle:".handle",forceHelperSize:!0,forcePlaceholderSize:!0}),b(".delete-purchase-order").on("click",function(a){a.preventDefault();var c=b(this);deleteNow=function(){window.location=c.attr("href")},App.confirm("Anda yakin ingin menghapus purchase order?",deleteNow)}),b(document).ajaxStop(function(){b(".deleteNow").on("click",function(a){function c(){window.location=d.attr("href")}a.preventDefault();var d=b(this);App.confirm("Anda yakin ingin menghapus "+b(this).attr("rel")+"?",c)})}),App.sidedishCount>0)for(var f=0;f<App.sidedishCount;f++)b("#remove_sidedish_"+f).on("click",function(a){function c(){b("#side-dish-"+d.substr(16)).remove()}var d=b(this).attr("id");App.confirm("Anda yakin ingin menghapus side dish?",c)});if(App.printerKitchenCount>0)for(var f=0;f<App.printerKitchenCount;f++)b("#remove_printer_kitchen_"+f).on("click",function(a){function c(){b("#printer_kitchen_"+d[3]).remove()}var d=b(this).attr("id").split("_");App.confirm("Anda yakin ingin menghapus?",c)});if(App.printerCheckerCount>0)for(var f=0;f<App.printerCheckerCount;f++)b("#remove_printer_checker_"+f).on("click",function(a){function c(){b("#printer_checker_"+d[3]).remove()}var d=b(this).attr("id").split("_");App.confirm("Anda yakin ingin menghapus?",c)});if(App.printerCheckerKitchenCount>0)for(var f=0;f<App.printerCheckerKitchenCount;f++)b("#remove_printer_checker_kitchen_"+f).on("click",function(a){function c(){b("#printer_checker_kitchen_"+d[4]).remove()}var d=b(this).attr("id").split("_");App.confirm("Anda yakin ingin menghapus?",c)});if(App.optionsCount>0)for(var f=0;f<App.optionsCount;f++)if(b("#remove_options_"+f).on("click",function(a){function c(){b("#m-option-"+d.substr(15)).remove()}var d=b(this).attr("id");App.confirm("Anda yakin ingin menghapus option?",c)}),b("#add_option_value_"+f).on("click",function(a){a.preventDefault();var c=b(this).attr("id"),d=c.substr(17),e=b(".countoptvalue-"+d).length;if(10>e){App.optionsValueCount++;var f='<div class="option-values-form countoptvalue-'+d+'"><div class="row"><div class="col-md-1"><a class="handle-item btn btn-mini"><i class="fa fa-bars"></i></a></div><div class="col-md-10"><input type="text" class="form-control requiredTextField" placeholder="Enter Options value" field-name = "Option value" name="options['+d+"][values]["+App.optionsValueCount+'][option_value_name]"/></div><div class="col-md-1"><button id="remove_options_value_'+App.optionsValueCount+'" type="button" class="btn btn-mini btn-danger pull-right"><i class="fa fa-trash-o"></i></button></div></div></div>';b("#option-items-"+d).append(f),b("#remove_options_value_"+App.optionsValueCount).on("click",function(a){function c(){f.closest(".option-values-form").remove()}var e=b(".countoptvalue-"+d).length,f=b(this);e>1?App.confirm("Anda yakin ingin menghapus option value ?",c):App.alert("Tidak dapat menghapus nilai opsi terakhir")})}else App.alert("Nilai opsi sudah mencapai batas maksimum")}),App.optionsValueCount>0)for(var g=0;g<App.optionsValueCount;g++)b("#option-items-"+g).sortable({axis:"y",handle:".handle-item",forceHelperSize:!0,forcePlaceholderSize:!0}),b("#remove_options_value_"+g).on("click",function(a){function c(){b("#remove_options_value_"+g).closest(".option-values-form").remove()}var d=b(this).closest(".option-values-form").attr("class"),e=d.substr(33),f=b(".countoptvalue-"+e).length;f>1?App.confirm("Anda yakin ingin menghapus option value?",c):App.alert("Tidak dapat menghapus nilai opsi terakhir")});b(".removeImageMenu").on("click",function(a){function c(){var a=d.attr("rel"),c=d.attr("url-data"),e=b.ajax({type:"POST",url:c,data:{id:a}});e.done(function(a){var c=JSON.parse(a);App.alert(c.message),b("#primaryimage").remove()}),e.fail(function(a,b){}),e.always(function(){})}a.preventDefault();var d=b(this);App.confirm("Remove this Image?",c)}),b("#datepickertime .time").timepicker({showDuration:!0,timeFormat:"H:i",scrollDefault:"now",step:30}),b("#input_created_date").datepicker({dateFormat:"yy-mm-dd",constrainInput:!0,showOn:"button",buttonImage:App.baseUrl+"assets/img/calendar_icon.png"});var h=document.getElementById("datepickertime");if(null!=h){new Datepair(h)}b("#purchase_date").datetimepicker({sideBySide:!0,useCurrent:!0,format:"YYYY-MM-DD HH:mm"}),b("#purchase_order_date").datetimepicker({sideBySide:!0,useCurrent:!0,format:"YYYY-MM-DD HH:mm"}),b(document).on("click","#add_po_create",function(){b.ajax({url:App.baseUrl+"admincms/purchase_order/add_po_create",dataType:"JSON",success:function(a){b("#po_create_table tbody").append(a.content),b("#po_create_table tbody tr:last .select2").select2()}})}),b("#purchase-qty").on("keyup",function(){value=parseFloat(b(this).val()),isNaN(value)&&(value=0),max=parseFloat(isNaN(b(this).data("max"))?0:b(this).data("max")),value>max?b(this).val(max):value<0&&b(this).val(0)}),b(document).on("change","#stock_add_inventory_id",function(){inventory_id=b(this).val(),el=this,""!=inventory_id?(uom_id=b(this).find("option:selected").attr("uom_id"),b.ajax({url:App.baseUrl+"admincms/inventory/get_inventory_uoms",type:"POST",dataType:"JSON",data:{inventory_id:inventory_id},success:function(a){b("#stock_add_uom_id").html(a.content),b("#stock_add_uom_id").val(uom_id)}})):b("#stock_add_uom_id").html("<option value=''>Pilih Satuan</option>")}),b(document).on("change","#po_create_table tbody .inventory_id",function(){inventory_id=b(this).val(),el=this,""!=inventory_id?(uom_id=b(this).find("option:selected").attr("uom_id"),b.ajax({url:App.baseUrl+"admincms/inventory/get_inventory_uoms",type:"POST",dataType:"JSON",data:{inventory_id:inventory_id},success:function(a){b(el).parents("tr").find("select.uom_id").html(a.content),b(el).parents("tr").find("select.uom_id").val(uom_id)}})):b(this).parents("tr").find(".uom_id").html("<option value=''>Pilih Satuan</option>")}),b(document).on("click","#po_create_table tbody .remote_item_po",function(){b(this).parents("tr").remove()}),App.eventOpname(),b("#sync-me-now").on("click",function(){App.verificationPrivateKey()});var h=document.getElementById("purchase_date");if(null!=h){new Datepair(h)}b("#request-transfer-select-store").change(function(){store_id=b(this).val(),store_id>-1&&b.ajax({url:b("#admin_url").val()+"/stock_transfer/get_outlet/"+store_id,dataType:"json",success:function(a){if(a.status){outlets=a.outlets,b("#request-transfer-select-outlet").empty();for(var c=0;c<outlets.length;c++)option='<option value="'+outlets[c].id+'">'+outlets[c].outlet_name+"</option>",b("#request-transfer-select-outlet").append(option)}}})}),b("#request-transfer-add-inventory").on("click",function(){counter=b(this).data("counter"),counter++,b(this).data("counter",counter),row=b("#inventory-list-0").clone(!0),b("[id^=request-transfer-select-inventory-]").each(function(){this_val=b(this).val(),""!=this_val&&row.find("option[value='"+this_val+"']").remove()}),row.attr("id","inventory-list-"+counter),row.removeClass("hidden"),row.find("label").attr("id","inventory-label-"+counter),row.find("select:first").attr("id","request-transfer-select-inventory-"+counter),row.find("select:first").attr("name","inventory-code[]"),row.find("select:last").attr("name","inventory-uom[]"),row.find(".quantity").attr("name","inventory-quantity[]"),row.find("button#delete-inventory-0").attr("id","delete-inventory-"+counter),row.insertAfter(".inventory-row:last"),b(".inventory-row:last select:first").select2(),b("#save-request").css("visibility","visible")}),b("[id^=delete-inventory-").on("click",function(){b(this).closest("tr").remove()}),b("[id^=request-transfer-select-inventory-").on("change",function(){inventory_id=b(this).val(),el=this,""!=inventory_id?(uom_id=b(this).find("option:selected").attr("uom_id"),b.ajax({url:App.baseUrl+"admincms/inventory/get_inventory_uoms",type:"POST",dataType:"JSON",data:{inventory_id:inventory_id},success:function(a){b(el).parents("tr").find("select.uom_id").html(a.content),b(el).parents("tr").find("select.uom_id").val(uom_id)}})):b(this).parents("tr").find(".uom_id").html("<option value=''>Pilih Satuan</option>")}),b(".stock-request-spinner").each(function(){min=parseInt(isNaN(b(this).data("min"))?0:b(this).data("min")),max=parseInt(isNaN(b(this).data("max"))?0:b(this).data("max")),b(this).spinner({max:max,min:min}),b(this).spinner("value",b(this).data("value"))}),b(".stock-request-spinner").on("keyup",function(){value=parseInt(b(this).val()),isNaN(value)&&(value=0),max=parseInt(isNaN(b(this).data("max"))?0:b(this).data("max")),value>max?b(this).val(max):value<0&&b(this).val(0)}),b(".po-spinner").each(function(){b(this).spinner({max:b(this).data("max"),min:0,change:function(a,c){id=b(this).data("id"),sum=0,b(".spinner-"+id+":enabled").each(function(){sum+=parseInt(b(this).val())}),b("#sum-"+id).html(sum),b("#sum-"+id).closest("tr").find("input").val(sum)}}),b(this).spinner("value",b(this).data("value"))}),b(".receive-spinner").each(function(){min=parseInt(isNaN(b(this).data("min"))?0:b(this).data("min")),max=parseInt(isNaN(b(this).data("max"))?0:b(this).data("max")),b(this).spinner({max:max,min:min,spin:function(a,c){tr=b(this).closest("tr"),pcs=c.value,price=tr.find(".pcs-price").val(),count_order=b("#detail_order").val(),sub_total=pcs*price,tr.find(".sub-total").html(sub_total);for(var d=0;d<count_order;d++)pcs_price=b("#pcs-price"+d).val(),pcs_receive=b("#receive-qty"+d).val(),acc_debit=pcs_receive*pcs_price,b("#debit-hidden"+d).val(acc_debit);grand_total=0,b(".sub-total").each(function(){grand_total+=parseFloat(b(this).html())}),b(".grand-total").html(grand_total),b("#total-hidden").val(grand_total)}}),b(this).spinner("value",b(this).data("value"))}),b(".retur-qty").on("keyup",function(){value=parseFloat(b(this).val()),isNaN(value)&&(value=0),value<0&&b(this).val(0),tr=b(this).closest("tr"),ret_qty=tr.find(".retur-qty").val(),price=tr.find(".pcs-price").val(),count_order=b("#detail_order").val(),sub_total=ret_qty*price,tr.find(".sub-total").html(App.number_format(sub_total)),tr.find(".sub-total").attr("sub_total",sub_total);for(var a=0;a<count_order;a++)pcs_price=b("#pcs-price"+a).val(),pcs_retur=b("#retur-qty"+a).val(),acc_debit=pcs_retur*pcs_price,b("#debit-hidden"+a).val(acc_debit),maxVal=b("#max-retur-"+a).val(),maxReturPrice=maxVal*pcs_price,
parseInt(pcs_retur)>parseInt(maxVal)&&(b("#retur-qty"+a).val(maxVal),tr.find(".sub-total").html(App.number_format(maxReturPrice)),tr.find(".sub-total").attr("sub_total",maxReturPrice));grand_total=0,b(".sub-total").each(function(){grand_total+=parseFloat(b(this).attr("sub_total"))}),b(".grand-total").html(App.number_format(grand_total)),b("#total-hidden").val(grand_total)}),b(".pcs-price,.receive-qty").on("keyup",function(){retur_total=0,tr=b(this).closest("tr"),pcs=tr.find(".receive-qty").val(),price=tr.find(".pcs-price").val(),count_order=b("#detail_order").val(),sub_total=pcs*price,tr.find(".sub-total").html(App.number_format(sub_total)),tr.find(".sub-total").attr("sub_total",sub_total);for(var a=0;a<count_order;a++)pcs_price=b("#pcs-price"+a).val(),pcs_receive=b("#receive-qty"+a).val(),acc_debit=pcs_receive*pcs_price,b("#debit-hidden"+a).val(acc_debit),parseInt(pcs_price)<0&&(b("#pcs-price"+a).val(0),tr.find(".sub-total").html(App.number_format(0)),tr.find(".sub-total").attr("sub_total",0));grand_total=0,b(".sub-total").each(function(){grand_total+=parseFloat(b(this).attr("sub_total"))}),b(".grand-total").html(App.number_format(grand_total)),b("#total-hidden").val(grand_total),b("#discount").trigger("keyup")}),b(".receive-spinner").on("keyup",function(){value=parseFloat(b(this).val()),isNaN(value)&&(value=0),max=parseFloat(isNaN(b(this).data("max"))?0:b(this).data("max")),value>max?b(this).val(max):value<0&&b(this).val(0)}),b(".receive-spinner, .pcs-price, #discount").on("keyup",function(){value=b(this).val(),b.isNumeric(value)===!1&&(this.value=this.value.slice(0,-1))}),b("#discount").on("keyup",function(){grand_total=b(".grand-total:first").siblings("#total-hidden").val(),discount=b(this).val(),discount>grand_total&&(b(this).val(grand_total),discount=grand_total),grand_total_final=grand_total-discount,b(".grand-total-final").html(App.number_format(grand_total_final)),b("#grand-total-hidden").val(grand_total_final)}),b('input[name="method"]').on("change",function(){"cash"==b(this).val()?b("#bon-date").hide():b("#bon-date").show()}),b(".date-input").datetimepicker({sideBySide:!0,useCurrent:!0,format:"YYYY-MM-DD HH:mm"}),b(".bon_date").datetimepicker({sideBySide:!0,useCurrent:!0,format:"YYYY-MM-DD HH:mm",minDate:new Date}),b(".check-order").on("click",function(){parent=b(this).closest("tr"),id=parent.data("id"),status=parent.find(".po-spinner").spinner("option","disabled"),"true"==status?parent.find(".po-spinner").spinner("enable"):parent.find(".po-spinner").spinner("option","disabled",!0),sum=0,b(".spinner-"+id+":enabled").each(function(){sum+=parseInt(b(this).val())}),b("#hidden-sum-"+id).val(sum),b("#sum-"+id).html(sum)}),b("body").on("click",".choose-account",function(a){return a.preventDefault(),console.log(App.listAccounts),console.log(App.listAccounts.indexOf(b(this).data("id"))),App.listAccounts.indexOf(b(this).data("id"))>=0?void App.alert("Account Added"):(row='<tr><td><i class="fa fa-search"></i></td><td>'+b(this).data("code")+'<input type="hidden" name="code['+b(this).data("id")+']" value="'+b(this).data("code")+'"/></td><td>'+b(this).data("name")+'<input type="hidden" name="name['+b(this).data("id")+']" value="'+b(this).data("name")+'"/></td><td><input type="text" name="debit['+b(this).data("id")+']" class="form-control debit" placeholder="debit" /></td><td><input type="text" name="credit['+b(this).data("id")+']" class="form-control credit" placeholder="credit" /></td><td><input type="text" name="info['+b(this).data("id")+']"class="form-control" placeholder="info"/></td><td><a href="#" class="delete-row-account">Hapus</a></td></tr>',b("#sticky-search").before(row),void App.listAccounts.push(b(this).data("id")))}),b("body").on("keyup",".credit",function(){value_credit=b(this).val(),b.isNumeric(value_credit)===!1&&(this.value=this.value.slice(0,-1)),debit=b(this).closest("tr").find(".debit"),console.log(value_credit),0==value_credit.length?debit.removeAttr("disabled"):debit.attr("disabled","disabled"),debit.val("")}),b("body").on("keyup",".debit",function(){value_debit=b(this).val(),b.isNumeric(value_debit)===!1&&(this.value=this.value.slice(0,-1)),credit=b(this).closest("tr").find(".credit"),console.log(value_debit),0==value_debit.length?credit.removeAttr("disabled"):credit.attr("disabled","disabled"),credit.val("")}),b("body").on("change",".debit, .credit",function(){debit=0,credit=0,b(".debit").each(function(){val=parseInt(b(this).val()),isNaN(val)||(debit+=val)}),b(".credit").each(function(){val=parseInt(b(this).val()),isNaN(val)||(credit+=parseInt(val))}),b("#total-debit").html(debit),b("#total-credit").html(credit),debit!=credit?(b("#save-journal").addClass("disabled"),b("#summary").css("color","red")):(b("#save-journal").removeClass("disabled"),b("#summary").css("color",""))}),b("body").on("click",".delete-row-account",function(a){a.preventDefault(),b(this).closest("tr").remove(),debit=0,credit=0,b(".debit").each(function(){val=parseInt(b(this).val()),isNaN(val)||(debit+=val)}),b(".credit").each(function(){val=parseInt(b(this).val()),isNaN(val)||(credit+=parseInt(val))}),b("#total-debit").html(debit),b("#total-credit").html(credit),debit!=credit?(b("#save-journal").addClass("disabled"),b("#summary").css("color","red")):(b("#save-journal").removeClass("disabled"),b("#summary").css("color",""))}),b(".account-pop").on("click",function(){console.log("Test"),rows="",b.ajax({url:b("#admin_url").val()+"/journal/get_accounts/",dataType:"json",async:!1,success:function(a){if(a.status){accounts=a.accounts;for(var b=0;b<accounts.length;b++)rows+="<tr><td>"+accounts[b].code+"</td><td>"+accounts[b].name+'</td><td><a href="#" class="choose-account" data-code="'+accounts[b].code+'" data-name="'+accounts[b].name+'" data-id="'+accounts[b].id+'">Pilih</a></td></tr>'}}});var a='<table class="table table-striped table-bordered table-hover dt-responsive" id="dataTables-account-pop-up"><thead><tr><th class="col-md-1">Kode</th><th class="col-md-2">Nama Akun</th><th class="col-md-2">Aksi</th></tr></thead><tbody>'+rows+"</tbody></table>",c='<div class="modal fade" id="account-pop-up" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h3 class="modal-title" id="exampleModalLabel"> Pilih akun </h3></div><div class="modal-body">'+a+'</div><div class="modal-footer"> <button type="button" class="btn btn-default btn-cancel" data-dismiss="modal">Tutup</button> </div></div> </div></div>';b("body").append(c),b("#dataTables-account-pop-up").dataTable(),b("#account-pop-up").modal("show")}),b(".cancel-request-transfer").on("click",function(){console.log(b(this).data("id"))}),App.overlayUI.hide(),b("body").hasClass("collapse")&&window.location.reload(),b(".pay-bon").on("click",function(a){a.preventDefault();var c=b(this);payNow=function(){var a=b("#payment_bon_date_val").val(),d=b("#account_id").val(),e=b("#payment_amount").val();void 0==d&&(d=0),0==a.length?App.alert("Tanggal Bayar Kosong"):window.location=c.attr("href")+"/"+a+"/"+d+"/"+e},App.confirm("Apakah anda yakin ingin membayar bon ini?",payNow)})},initListTransferFilter:function(){var a={valueNames:["name"],searchClass:"search"};new List("inventories",a)},ShowTreeConvertion:function(a,c){""!=a&&c>0&&b.ajax({url:App.baseUrl+"admincms/inventory_process/show_tree_convertion",dataType:"JSON",data:{inventory_id:a,quantity:c},success:function(a){b("#show_tree_convertion").html(a.content)}})},FeatureSettingUI:function(){b(document).on("click",".clear_feature_setting",function(){b("#users_unlock").val("")}),b(document).on("click",".set_feature_unlock",function(){return url=b(this).attr("href"),b.ajax({url:url,dataType:"JSON",success:function(a){b("#feature_setting_modal").html(a.content),b("#feature_setting_modal").modal()}}),!1})},add_option:function(a,c){function d(a){var b='<select id="printer_kitchen_id_chained_'+a+'" name="printer_kitchen['+a+'][outlet_id]" field-name = "Outlet" class="form-control requiredDropdown ingredient_id_chained" autocomplete="off">';for(var c in App.dataOutlet)b+='<option value="'+c+'">'+App.dataOutlet[c]+"</option>";return b+="</select>"}function e(a){var b='<select id="printer_checker_kitchen_id_chained_'+a+'" name="printer_checker_kitchen['+a+'][outlet_checker_kitchen_id]" field-name = "Outlet" class="form-control requiredDropdown ingredient_id_chained" autocomplete="off">';for(var c in App.dataOutlet)b+='<option value="'+c+'">'+App.dataOutlet[c]+"</option>";return b+="</select>"}if("printerKitchen"==a){var f='<tr id="printer_kitchen_'+c+'" class="count_printer_kitchen"><td><div class="row"> <div class="col-md-10 col-md-offset-1"><div class="col-md-4">'+d(c)+'</div><div class="col-md-4"><input type="text" class="form-control requiredTextField" field-name = "nama printer" placeholder="" name="printer_kitchen['+c+'][printer_name]"/></div><div class="col-md-1"><button id="remove_printer_kitchen_'+c+'" type="button" class="btn btn-mini btn-danger pull-right"><i class="fa fa-trash-o"></i></button></div></div></div></td></tr>';b("#printer_kitchen_container").append(f),b("#remove_printer_kitchen_"+c).on("click",function(a){function d(){b("#printer_kitchen_"+c).remove()}App.confirm("Anda yakin ingin menghapus?",d)})}else if("printerChecker"==a){var f='<tr id="printer_checker_'+c+'" class="count_printer_checker"><td><div class="row"> <div class="col-md-10 col-md-offset-1"><div class="col-md-4"><input type="text" class="form-control requiredTextField" field-name = "nama printer" placeholder="nama printer" name="printer_checker['+c+'][printer_name]"/></div><div class="col-md-1"><button id="remove_printer_checker_'+c+'" type="button" class="btn btn-mini btn-danger pull-right"><i class="fa fa-trash-o"></i></button></div></div></div></td></tr>';b("#printer_checker_container").append(f),b("#remove_printer_checker_"+c).on("click",function(a){function d(){b("#printer_checker_"+c).remove()}App.confirm("Anda yakin ingin menghapus?",d)})}else if("printerCheckerKitchen"==a){var f='<tr id="printer_checker_kitchen_'+c+'" class="count_printer_checker_kitchen"><td><div class="row"> <div class="col-md-10 col-md-offset-1"><div class="col-md-4">'+e(c)+'</div><div class="col-md-4"><input type="text" class="form-control requiredTextField" field-name = "nama printer" placeholder="nama printer" name="printer_checker_kitchen['+c+'][printer_name]"/></div><div class="col-md-1"><button id="remove_printer_checker_kitchen_'+c+'" type="button" class="btn btn-mini btn-danger pull-right"><i class="fa fa-trash-o"></i></button></div></div></div></td></tr>';b("#printer_checker_kitchen_container").append(f),b("#remove_printer_checker_kitchen_"+c).on("click",function(a){function d(){b("#printer_checker_kitchen_"+c).remove()}App.confirm("Anda yakin ingin menghapus?",d)})}},number_format:function(a,b,c,d){a=(a+"").replace(/[^0-9+\-Ee.]/g,"");var e=isFinite(+a)?+a:0,f=isFinite(+b)?Math.abs(b):0,g="undefined"==typeof d?",":d,h="undefined"==typeof c?".":c,i="",j=function(a,b){var c=Math.pow(10,b);return""+(Math.round(a*c)/c).toFixed(b)};return i=(f?j(e,f):""+Math.round(e)).split("."),i[0].length>3&&(i[0]=i[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,g)),(i[1]||"").length<f&&(i[1]=i[1]||"",i[1]+=new Array(f-i[1].length+1).join("0")),i.join(h)},buttonSubmitEvent:function(){var a;b("button[name=btnAction]").on("click",function(c){c.preventDefault(),a=b(this).attr("value"),b(".form-ajax").trigger("submit")}),b(".form-ajax").on("submit",function(c){App.overlayUI.show();var d=b(this);console.log("bening");var e=b(".result");e.html(""),b(".NumericOnly").each(function(){var a=/^([1-9][0-9]*)|([0]+)$/,d=a.test(b(this).val());return d===!1?(e.empty().html('<div class="alert alert-danger" role="alert">'+b(this).attr("field-name")+" hanya menerima numerik</div>"),App.overlayUI.hide(),c.preventDefault(),!1):void 0}),b(".NumericWithZero").each(function(){if(""!=b(this).val()){var a=/^([0-9]*)$/,d=a.test(b(this).val());if(d===!1)return e.empty().html('<div class="alert alert-danger" role="alert">'+b(this).attr("field-name")+" hanya menerima numerik</div>"),App.overlayUI.hide(),c.preventDefault(),!1}}),b(".requiredDropdown").each(function(){return"0"==b(this).val()?(e.empty().html('<div class="alert alert-danger" role="alert">Anda harus memilih pilihan pada '+b(this).attr("field-name")+"</div>"),App.overlayUI.hide(),c.preventDefault(),!1):void 0}),b(".requiredTextField").each(function(){return""==b(this).val()?(e.empty().html('<div class="alert alert-danger" role="alert">Bagian '+b(this).attr("field-name")+" dibutuhkan</div>"),App.overlayUI.hide(),c.preventDefault(),!1):void 0}),b(".maxUploadSize").each(function(){var a=b(this).data("maxsize");if(""!=a){var d=b(this)[0];if(d.files&&1==d.files.length&&d.files[0].size>a)return e.empty().html('<div class="alert alert-danger" role="alert">The file must be less than '+Math.round(a/1024/1024)+"MB</div>"),App.overlayUI.hide(),c.preventDefault(),!1}});var f=b("<input type='hidden'/>");f.attr("name","btnAction").val(a).appendTo(d),f=""})},syncGroups:function(){var c=[],d=0,e="groups";b.when(App.getDataPos(App.serverBaseUrl+"api/store/groups/",e)).done(function(b){void 0!==b&&(d=b.length,d>0?a={groups:b}:a={groups:1},c.push(a)),App.saveSync(c,e,!1)})},syncUser:function(){var c=[],d=0,e="user";b.when(App.getDataPos(App.serverBaseUrl+"api/store/user/id/"+App.storeID,e)).done(function(b){void 0!==b&&(d=b.length,d>0?a={user:b}:a={user:1},c.push(a)),App.saveSync(c,e,!1)})},syncSupplier:function(){var c=[],d=0,e="supplier";b.when(App.getDataPos(App.serverBaseUrl+"api/store/supplier",e)).done(function(b){void 0!==b&&(d=b.supplier.length,d>0?a={supplier:b.supplier}:a={supplier:1},c.push(a)),App.saveSync(c,e,!1)})},syncDeliveryCompany:function(){var c=[],d=0,e="delivery_company";b.when(App.getDataPos(App.serverBaseUrl+"api/store/delivery_company",e)).done(function(b){void 0!==b&&(d=b.delivery_company.length,d>0?a={delivery_company:b.delivery_company}:a={delivery_company:1},c.push(a),d=b.delivery_courier.length,d>0?a={delivery_courier:b.delivery_courier}:a={delivery_courier:1},c.push(a)),App.saveSync(c,e,!1)})},syncVoucher:function(){var c=[],d=0,e="voucher";b.when(App.getDataPos(App.serverBaseUrl+"api/store/voucher",e)).done(function(b){void 0!==b&&(d=b.voucher_group.length,d>0?a={voucher_group:b.voucher_group}:a={voucher_group:1},c.push(a),d=b.voucher_availability.length,d>0?a={voucher_availability:b.voucher_availability}:a={voucher_availability:1},c.push(a),d=b.voucher.length,d>0?a={voucher:b.voucher}:a={voucher:1},c.push(a)),App.saveSync(c,e,!1)})},syncAccount:function(){var c=[],d=0,e="account";b.when(App.getDataPos(App.serverBaseUrl+"api/store/account",e)).done(function(b){void 0!==b&&(d=b.account.length,d>0?a={account:b.account}:a={account:1},c.push(a)),App.saveSync(c,e,!1)})},syncPromo:function(){var c=[],d=0,e="promo";b.when(App.getDataPos(App.serverBaseUrl+"api/store/promo/id/"+App.storeID,e)).done(function(b){void 0!==b&&(d=b.promo_cc.length,d>0?a={promo_cc:b.promo_cc}:a={promo_cc:1},c.push(a),d=b.promo_discount.length,d>0?a={promo_discount:b.promo_discount}:a={promo_discount:1},c.push(a),d=b.promo_cc_category.length,d>0?a={promo_cc_category:b.promo_cc_category}:a={promo_cc_category:1},c.push(a),d=b.promo_discount_category.length,d>0?a={promo_discount_category:b.promo_discount_category}:a={promo_discount_category:1},c.push(a),d=b.promo_discount_menu.length,d>0?a={promo_discount_menu:b.promo_discount_menu}:a={promo_discount_menu:1},c.push(a),d=b.promo_cc_menu.length,d>0?a={promo_cc_menu:b.promo_cc_menu}:a={promo_cc_menu:1},c.push(a),d=b.promo_schedule.length,d>0?a={promo_schedule:b.promo_schedule}:a={promo_schedule:1},c.push(a)),App.saveSync(c,e,!1)})},syncTax:function(){var c=[],d=0,e="tax";b.when(App.getDataPos(App.serverBaseUrl+"api/store/tax",e)).done(function(b){void 0!==b&&(d=b.length,d>0?a={tax:b}:a={tax:1},c.push(a)),App.saveSync(c,e,!1)})},syncCompliment:function(){var c=[],d=0,e="compliment";b.when(App.getDataPos(App.serverBaseUrl+"api/store/compliment",e)).done(function(b){void 0!==b&&(d=b.length,d>0?a={compliment:b}:a={compliment:1},c.push(a)),App.saveSync(c,e,!1)})},syncMember:function(){var c=[],d=0,e="member";b.when(App.getDataPos(App.serverBaseUrl+"api/store/member",e)).done(function(b){void 0!==b&&(d=b.member_category.length,d>0?a={member_category:b.member_category}:a={member_category:1},c.push(a),d=b.member.length,d>0?a={member:b.member}:a={member:1},c.push(a)),App.saveSync(c,e,!1)})},syncFeature:function(){var c=[],d=0,e="feature";b.when(App.getDataPos(App.serverBaseUrl+"api/store/feature",e)).done(function(b){void 0!==b&&(d=b.feature_access.length,d>0?a={feature_access:b.feature_access}:a={feature_access:1},c.push(a),d=b.feature.length,d>0?a={feature:b.feature}:a={feature:1},c.push(a)),App.saveSync(c,e,!1)})},syncStoreData:function(c){var d=[],e=0,f="storedata";b.when(App.getDataPos(App.serverBaseUrl+"api/store/storedata/id/"+App.storeID,f)).done(function(b){void 0!==b&&(e=b.length,e>0?a={store:b}:a={store:1},d.push(a)),App.saveSync(d,f,function(){App.syncOutlet(),App.syncFloor(),App.syncOrderCompany()})})},syncCategoryMenu:function(c){var d=[],e=0,f="category_menu";b.when(App.getDataPos(App.serverBaseUrl+"api/store/category/id/"+App.storeID,f)).done(function(b){void 0!==b&&(e=b.length,e>0?a={category:b}:a={category:1},d.push(a)),App.saveSync(d,f,App.syncMenu())})},syncMenu:function(c){var d=[],e=0,f="menu";b.when(App.getDataPos(App.serverBaseUrl+"api/store/menu/id/"+App.storeID,f)).done(function(b){void 0!==b&&(e=b.length,e>0?a={menu:b}:a={menu:1},d.push(a)),App.saveSync(d,f,function(){App.syncInventory(),App.syncSideDish()})})},syncInventoryCategory:function(c){var d=[],e=0,f="inventory_category";b.when(App.getDataPos(App.serverBaseUrl+"api/store/inventory_category",f)).done(function(b){void 0!==b&&(e=b.length,e>0?a={inventory_category:b}:a={inventory_category:1},d.push(a)),App.saveSync(d,f,App.syncInventory())})},syncInventoryAccount:function(c){var d=[],e=0,f="inventory_account";b.when(App.getDataPos(App.serverBaseUrl+"api/store/inventory_account",f)).done(function(b){void 0!==b&&(e=b.length,e>0?a={inventory_account:b}:a={inventory_account:1},d.push(a)),App.saveSync(d,f,!1)})},syncEnumCoaType:function(c){var d=[],e=0,f="enum_coa_type";b.when(App.getDataPos(App.serverBaseUrl+"api/store/enum_coa_type",f)).done(function(b){void 0!==b&&(e=b.length,e>0?a={enum_coa_type:b}:a={enum_coa_type:1},d.push(a)),App.saveSync(d,f,!1)})},syncInventory:function(c){var d=[],e=0,f="inventory";b.when(App.getDataPos(App.serverBaseUrl+"api/store/inventory",f)).done(function(b){void 0!==b&&(e=b.length,e>0?a={inventory:b}:a={inventory:1},d.push(a)),App.saveSync(d,f,App.syncMenuIngredient())})},syncUoms:function(c){var d=[],e=0,f="uom";b.when(App.getDataPos(App.serverBaseUrl+"api/store/uoms",f)).done(function(b){void 0!==b&&(e=b.length,e>0?a={uom:b}:a={uom:1},d.push(a)),App.saveSync(d,f,!1)})},syncInventoryUoms:function(c){var d=[],e=0,f="inventory_uom";b.when(App.getDataPos(App.serverBaseUrl+"api/store/inventory_uoms",f)).done(function(b){void 0!==b&&(e=b.length,e>0?a={inventory_uom:b}:a={inventory_uom:1},d.push(a)),App.saveSync(d,f,!1)})},syncAppraisalTemplate:function(c){var d=[],e=0,f="appraisal_template";b.when(App.getDataPos(App.serverBaseUrl+"api/hrd/appraisal_template/id/"+App.storeID,f)).done(function(b){void 0!==b&&(e=b.appraisal_template.length,e>0?a={appraisal_template:b}:a={appraisal_template:1},d.push(a)),App.saveSync(d,f,!1)})},syncAuditTemplate:function(c){var d=[],e=0,f="audit_template";b.when(App.getDataPos(App.serverBaseUrl+"api/hrd/audit_template/id/"+App.storeID,f)).done(function(b){void 0!==b&&(e=b.audit_template.length,e>0?a={audit_template:b}:a={audit_template:1},d.push(a)),App.saveSync(d,f,!1)})},syncJobComponent:function(c){var d=[],e=0,f="job_component";b.when(App.getDataPos(App.serverBaseUrl+"api/hrd/job_components/id/"+App.storeID,f)).done(function(b){void 0!==b&&(e=b.length,e>0?a={job_component:b}:a={job_component:1},d.push(a)),App.saveSync(d,f,!1)})},syncJob:function(c){var d=[],e=0,f="job";b.when(App.getDataPos(App.serverBaseUrl+"api/hrd/jobs/id/"+App.storeID,f)).done(function(b){void 0!==b&&(e=b.length,e>0?a={job:b}:a={job:1},d.push(a)),App.saveSync(d,f,!1)})},syncEmployeeAffair:function(c){var d=[],e=0,f="employee_affair";b.when(App.getDataPos(App.serverBaseUrl+"api/hrd/employee_affairs/id/"+App.storeID,f)).done(function(b){void 0!==b&&(e=b.length,e>0?a={employee_affair:b}:a={employee_affair:1},d.push(a)),App.saveSync(d,f,!1)})},syncSalaryComponent:function(c){var d=[],e=0,f="salary_component";b.when(App.getDataPos(App.serverBaseUrl+"api/hrd/salary_components/id/"+App.storeID,f)).done(function(b){void 0!==b&&(e=b.length,e>0?a={salary_component:b}:a={salary_component:1},d.push(a)),App.saveSync(d,f,!1)})},syncInventoryCompositions:function(c){var d=[],e=0,f="inventory_composition";b.when(App.getDataPos(App.serverBaseUrl+"api/store/inventory_compositions",f)).done(function(b){void 0!==b&&(e=b.length,e>0?a={inventory_composition:b}:a={inventory_composition:1},d.push(a)),App.saveSync(d,f,!1)})},syncEnumCardType:function(c){var d=[],e=0,f="enum_card_type";b.when(App.getDataPos(App.serverBaseUrl+"api/store/enum_card_type",f)).done(function(b){void 0!==b&&(e=b.length,e>0?a={enum_card_type:b}:a={enum_card_type:1},d.push(a)),App.saveSync(d,f,!1)})},syncBankAccountCard:function(c){var d=[],e=0,f="bank_account_card";b.when(App.getDataPos(App.serverBaseUrl+"api/store/bank_account_card",f)).done(function(b){void 0!==b&&(e=b.length,e>0?a={bank_account_card:b}:a={bank_account_card:1},d.push(a)),App.saveSync(d,f,!1)})},syncSideDish:function(){var c=[],d=0,e="side_dish";b.when(App.getDataPos(App.serverBaseUrl+"api/store/side_dish/id/"+App.storeID,e)).done(function(b){void 0!==b&&(d=b.side_dish_ingredient.length,d>0?a={side_dish_ingredient:b.side_dish_ingredient}:a={side_dish_ingredient:1},c.push(a),d=b.side_dish.length,d>0?a={side_dish:b.side_dish}:a={side_dish:1},c.push(a)),App.saveSync(c,e,!1)})},syncMenuIngredient:function(){var c=[],d=0,e="menu_ingredient";b.when(App.getDataPos(App.serverBaseUrl+"api/store/menu_ingredient",e)).done(function(b){void 0!==b&&(d=b.length,d>0?a={menu_ingredient:b}:a={menu_ingredient:1},c.push(a)),App.saveSync(c,e,!1)})},syncOutlet:function(){var c=[],d=0,e="outlet";b.when(App.getDataPos(App.serverBaseUrl+"api/store/outlet/id/"+App.storeID,e)).done(function(b){void 0!==b&&(d=b.length,d>0?a={outlet:b}:a={outlet:1},c.push(a)),App.saveSync(c,e,App.syncCategoryMenu())})},syncDeliveryCost:function(){var c=[],d=0,e="delivery_cost";b.when(App.getDataPos(App.serverBaseUrl+"api/store/delivery_cost/id/"+App.storeID,e)).done(function(b){void 0!==b&&(d=b.length,d>0?a={delivery_cost:b}:a={delivery_cost:1},c.push(a)),App.saveSync(c,e,!1)})},syncBankAccount:function(){var c=[],d=0,e="bank_account";b.when(App.getDataPos(App.serverBaseUrl+"api/store/bank_account/id/"+App.storeID,e)).done(function(b){void 0!==b&&(d=b.length,d>0?a={bank_account:b}:a={bank_account:1},c.push(a)),App.saveSync(c,e,!1)})},syncFloor:function(){var c=[],d=0,e="floor";b.when(App.getDataPos(App.serverBaseUrl+"api/store/floor/id/"+App.storeID,e)).done(function(b){void 0!==b&&(d=b.length,d>0?a={floor:b}:a={floor:1},c.push(a)),App.saveSync(c,e,App.syncTable())})},syncOrderCompany:function(){var c=[],d=0,e="Order Company";b.when(App.getDataPos(App.serverBaseUrl+"api/store/order_company/id/"+App.storeID,e)).done(function(b){console.log("DONE  "+e),console.log(b),console.log(b.length),void 0!==b&&(d=b.length,d>0?a={order_company:b}:a={order_company:1},c.push(a)),console.log(c),App.saveSync(c,e,!1)})},syncTable:function(){var c=[],d=0,e="table";b.when(App.getDataPos(App.serverBaseUrl+"api/store/table/id/"+App.storeID,e)).done(function(b){void 0!==b&&(d=b.length,d>0?a={table:b}:a={table:1},c.push(a)),App.saveSync(c,e,!1)})},syncInventoryConvertion:function(){var c=[],d=0,e="inventory_convertion";b.when(App.getDataPos(App.serverBaseUrl+"api/store/inventory_convertion/id/"+App.storeID,e)).done(function(b){void 0!==b&&(d=b.length,d>0?a={inventory_convertion:b}:a={inventory_convertion:1},c.push(a)),App.saveSync(c,e,!1)})},syncGeneralExpenses:function(){var c=[],d=0,e="general_expenses";b.when(App.getDataPos(App.serverBaseUrl+"api/store/general_expenses/id/"+App.storeID,e)).done(function(b){void 0!==b&&(d=b.length,d>0?a={general_expenses:b}:a={general_expenses:1},c.push(a)),App.saveSync(c,e,!1)})},syncRestoTransactionConfiguration:function(){var c=[],d=0,e="transaction_configuration";b.when(App.getDataPos(App.serverBaseUrl+"api/store/transaction_configuration/id/"+App.storeID,e)).done(function(b){void 0!==b&&(d=b.length,d>0?a={transaction_configuration:b}:a={transaction_configuration:1},c.push(a)),App.saveSync(c,e,!1)})},syncModulesDueData:function(){var c=[],d=0,e="modules_due_date";b.when(App.getDataPos(App.serverBaseUrl+"api/module/list/store_id/"+App.storeID,e)).done(function(b){console.log("list",b),b.status&&(d=b.data.length,d>0?a={modules_due_date:b.data}:a={modules_due_date:1},c.push(a)),App.saveSync(c,e,!1)})},saveSync:function(a,c,d){b.each(a,function(e,f){var g=b.ajax({type:"POST",data:f,url:b("#admin_url").val()+"/admin/save_sync"});g.done(function(f){if(e==a.length-1){if(App.indexTotalExecuteSync++,console.log(App.indexTotalExecuteSync+" SAVE "+c),d)return d();App.indexTotalExecuteSync==App.totalSync&&(console.log("SAVE ALL request"),App.overlayUI.hide(),App.indexTotalExecuteSync=0,App.listFailedSync=[],App.indexTotalFailedSync=0,setTimeout(function(){b("#progressbar").progressbar({value:100}),b("#popup-loading").modal("hide"),App.alert("Sync Success")},50))}}),g.fail(function(a,b){App.indexTotalExecuteSync++,App.alert("sync database failed",function(){window.location.reload(!0)})}),g.always(function(){})});var e=App.indexTotalExecuteSync/App.totalSync*100;b("#progressbar").progressbar({value:e})},verificationPrivateKey:function(){return url=App.serverBaseUrl+"api/store/check_private_key/ppk/"+App.privateKey,b.ajax({url:url,dataType:"jsonp",timeout:3e4,crossDomain:!0}).done(function(a,c,d){if(void 0!=a.id){var e='<div class="modal fade" id="popup-loading" tabindex="99999" data-backdrop="static" data-keyboard="false" style="z-index:100000 !important;" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-body"><div id="progressbar"></div></div></div> </div></div>';b("body").append(e),b("#progressbar").progressbar({value:0}),b("#popup-loading").modal("show"),App.storeID=a.id,App.updateMasterGeneralSetting(App.storeID),App.syncDatabaseFromServer()}else App.alert("Incorrect Private key!")}).fail(function(a,b,c){App.alert("Failes request to server,please try again!")})},updateMasterGeneralSetting:function(a){var c=App.baseUrl+"admincms/system/update_master_general_setting",d=b.ajax({type:"POST",url:c,data:{store_id:a}});d.done(function(a){}),d.fail(function(a,b){}),d.always(function(){})},syncDatabaseFromServer:function(){App.overlayUI.show(),App.syncGroups(),App.syncUser(),App.syncStoreData(),App.syncTax(),App.syncCompliment(),App.syncMember(),App.syncPromo(),App.syncVoucher(),App.syncSupplier(),App.syncAccount(),App.syncFeature(),App.syncDeliveryCost(),App.syncBankAccount(),App.syncUoms(),App.syncInventoryUoms(),App.syncEnumCardType(),App.syncBankAccountCard(),App.syncInventoryCompositions(),App.syncJob(),App.syncEmployeeAffair(),App.syncSalaryComponent(),App.syncJobComponent(),App.syncAppraisalTemplate(),App.syncAuditTemplate(),App.syncRestoTransactionConfiguration(),App.syncInventoryConvertion(),App.syncInventoryCategory(),App.syncInventoryAccount(),App.syncEnumCoaType(),App.syncGeneralExpenses(),App.syncModulesDueData(),App.syncDeliveryCompany()},getDataPos:function(a,c){return b.ajax({url:a,dataType:"jsonp",timeout:2e4,crossDomain:!0}).done(function(a,b,d){App.indexTotalFailedSync>0&&(App.listFailedSync.splice(App.listFailedSync.indexOf(c),1),App.indexTotalFailedSync--),App.indexTotalExecuteSync==App.totalSync&&(App.listFailedSync=[],App.indexTotalFailedSync=0)}).fail(function(a,b,d){console.log("FAILED "+c),App.indexTotalFailedSync++,App.listFailedSync.push(c),App.indexTotalFailedSync>0?(App.resync(c),App.listFailedSync.splice(App.listFailedSync.indexOf(c),1),App.indexTotalFailedSync--):(App.overlayUI.hide(),App.listFailedSync=[],App.indexTotalFailedSync=0)})},resync:function(a){switch(console.log("resync "+a),a){case"supplier":App.syncSupplier();break;case"voucher":App.syncVoucher();break;case"account":App.syncAccount();break;case"groups":App.syncGroups();break;case"user":App.syncUser();break;case"feature":App.syncFeature();break;case"promo":App.syncPromo();break;case"member":App.syncMember();break;case"compliment":App.syncCompliment();break;case"tax":App.syncTax();break;case"storedata":App.syncStoreData();break;case"outlet":App.syncOutlet();break;case"floor":App.syncFloor();break;case"category_menu":App.syncCategoryMenu();break;case"menu":App.syncMenu();break;case"inventory":App.syncInventory();break;case"side_dish":App.syncSideDish();break;case"menu_ingredient":App.syncMenuIngredient();break;case"table":App.syncTable();break;case"order_company":App.syncOrderCompany();break;case"delivery_cost":App.syncDeliveryCost();break;case"uom":App.syncUoms();break;case"inventory_uom":App.syncInventoryUoms();break;case"card_type":App.syncEnumCardType();break;case"bank_account_card":App.syncBankAccountCard();break;case"inventory_composition":App.syncInventoryCompositions();break;case"job":App.syncJob();break;case"employee_affair":App.syncEmployeeAffair();break;case"salary_component":App.syncSalaryComponent();break;case"job_component":App.syncJobComponent();break;case"appraisal_template":App.syncAppraisalTemplate();break;case"audit_template":App.syncAuditTemplate();break;case"transaction_configuration":App.syncRestoTransactionConfiguration();break;case"inventory_convertion":App.syncInventoryConvertion();break;case"general_expenses":App.syncGeneralExpenses();break;case"inventory_category":App.syncInventoryCategory();break;case"inventory_account":App.syncInventoryAccount();break;case"coa_type":App.syncEnumCoaType();break;case"modules_due_date":App.syncModulesDueData();break;case"delivery_company":App.syncDeliveryCompany()}},tableCanvas:function(){},initEvent:function(){b("#split-choose-right").on("click",function(a){var c=App.extractDataOrder(b(".highlight-bill-left").get(0));"undefined"!=typeof c.product_id&&(b(".popup-choose-left").hide(),b(".popup-choose-right").show(),b("#right_value").val(""),b(".popup-choose-right").css("left",b(this).offset().left-b(".popup-choose-right").width()/2+20),b(".popup-choose-right").css("top",b(this).offset().top-b(".popup-choose-right").height()-20))}),b("#split-choose-left").on("click",function(a){var c=App.extractDataOrder(b(".highlight-bill-right").get(0));"undefined"!=typeof c.product_id&&(b(".popup-choose-right").hide(),b(".popup-choose-left").show(),b("#left_value").val(""),b(".popup-choose-left").css("left",b(this).offset().left-b(".popup-choose-left").width()/2+20),b(".popup-choose-left").css("top",b(this).offset().top-b(".popup-choose-left").height()-20))}),b(".btn-cancel").click(function(){b(".popup-block").hide()}),b("#store_id").on("change",function(a){var c=App.baseUrl+"admincms/outlet/get_outlet_not_id",d=b(this).val(),e=b("#origin_outlet_id").val();0==d?(b("#outlet_id").html(" "),b("#outlet_id").prop("disabled",!0)):b("#outlet_id").prop("disabled",!1);var f=b.ajax({type:"GET",url:c,data:{outlet_id:e,store_id:d}});f.done(function(a){b("#outlet_id").html("");var c=JSON.parse(a);console.log(c);for(var d="",e=0;e<c.length;e++)d+="<option value='"+c[e].id+"'>"+c[e].outlet_name+"</option>";b("#outlet_id").append(d)}),f.fail(function(a,b){}),f.always(function(){})});var a=0,c="";b(".bill-table").on("click","tbody  > tr",function(){c=b(this).parents("table:first").attr("id"),"bill-table-left"===c?(b(this).parents("table:first").find("tbody  > tr").removeClass("highlight-bill-left"),
b("#bill-table-right").find("tbody  > tr").find("td").removeClass("highlight"),b("#bill-table-right").find("tbody  > tr").removeAttr("class"),b(this).addClass("highlight-bill-left"),b(this).find("td").addClass("highlight")):(b("#bill-table-left").find("tbody  > tr").find("td").removeClass("highlight"),b(this).parents("table:first").find("tbody  > tr").removeClass("highlight-bill-right"),b("#bill-table-left").find("tbody  > tr").removeAttr("class"),b(this).addClass("highlight-bill-right"),b(this).find("td").addClass("highlight"))}).bind("mouseup",function(){b(this).find("td").removeClass("highlight"),clearTimeout(a)}),b("#split-all-right").on("click",function(a){var c=App.extractDataOrder(b(".highlight-bill-left").get(0));"undefined"!=typeof c.product_id&&(App.sendToRight(c,App.enumOrder.ALL,b(".highlight-bill-left").get(0),!1),App.resetHighlight(),b("#bill-table-right").find("tbody  > tr").find("td").removeClass("highlight"),App.updateTransfersField())}),b("#split-single-right").on("click",function(a){var c=App.extractDataOrder(b(".highlight-bill-left").get(0));"undefined"!=typeof c.product_id&&(App.sendToRight(c,App.enumOrder.SINGLE,b(".highlight-bill-left").get(0),1),b("#bill-table-right").find("tbody  > tr").find("td").removeClass("highlight"),App.updateTransfersField())}),b("#btn-ok-right").on("click",function(a){var c=App.extractDataOrder(b(".highlight-bill-left").get(0));if("undefined"!=typeof c.product_id&&0!==b("#right_value").val().length){var d=parseFloat(b("#right_value").val());App.sendToRight(c,App.enumOrder.SINGLE,b(".highlight-bill-left").get(0),d),b("#bill-table-right").find("tbody  > tr").find("td").removeClass("highlight"),App.updateTransfersField()}}),b("#split-single-left").on("click",function(a){var c=App.extractDataOrder(b(".highlight-bill-right").get(0));"undefined"!=typeof c.product_id&&(App.sendToLeft(c,App.enumOrder.SINGLE,b(".highlight-bill-right").get(0),1),b("#bill-table-left").find("tbody  > tr").find("td").removeClass("highlight"),App.updateTransfersField())}),b("#split-all-left").on("click",function(a){var c=App.extractDataOrder(b(".highlight-bill-right").get(0));"undefined"!=typeof c.product_id&&(App.sendToLeft(c,App.enumOrder.ALL,b(".highlight-bill-right").get(0),!1),App.resetHighlight(),b("#bill-table-left").find("tbody  > tr").find("td").removeClass("highlight"),App.updateTransfersField())}),b("#btn-ok-left").on("click",function(a){var c=App.extractDataOrder(b(".highlight-bill-right").get(0));if("undefined"!=typeof c.product_id&&0!==b("#left_value").val().length){var d=parseInt(b("#left_value").val());App.sendToLeft(c,App.enumOrder.SINGLE,b(".highlight-bill-right").get(0),d),b("#bill-table-left").find("tbody  > tr").find("td").removeClass("highlight"),App.updateTransfersField()}}),b("#payment_bon_date").datetimepicker({sideBySide:!0,useCurrent:!0,format:"YYYY-MM-DD"})},sendToLeft:function(a,c,d,e){var f=App.findRightOrder(a),g=App.findLeftOrder(a),h=d;if(!(f.product_amount<e)){if(g){c===App.enumOrder.SINGLE?g.product_amount+=e:g.product_amount+=a.product_amount;var i=b("#bill-table-left").find("tbody  > tr");console.log(b(i).length);for(var j=0;j<b(i).length;j++){var k=b(i)[j];b(k).attr("id")===f.product_id&&b(k).children().eq(1).html(g.product_amount)}}else{c===App.enumOrder.SINGLE&&(a.product_amount=e),App.leftDataOrder.push(a);var l=b(h).clone();b(l).children().eq(1).html(a.product_amount),b(l).removeClass("highlight-bill-right"),b("#bill-table-left").append(b(l))}f&&(c===App.enumOrder.SINGLE?(f.product_amount-=e,f.product_amount<=0?(b(h).remove(),b.each(App.rightDataOrder,function(a){return App.rightDataOrder[a].product_id===f.product_id?(App.rightDataOrder.splice(a,1),!1):void 0})):b(h).children().eq(1).html(f.product_amount)):(b(h).remove(),b.each(App.rightDataOrder,function(a){return App.rightDataOrder[a].product_id===f.product_id?(App.rightDataOrder.splice(a,1),!1):void 0})))}},sendToRight:function(a,c,d,e){var f=App.findRightOrder(a),g=App.findLeftOrder(a),h=d;if(!(g.product_amount<e)){if(f){c===App.enumOrder.SINGLE?f.product_amount+=e:f.product_amount+=a.product_amount;for(var i=b("#bill-table-right").find("tbody  > tr"),j=0;j<b(i).length;j++){var k=b(i)[j];b(k).attr("id")===f.product_id&&(console.log(b(k).children().eq(1)),b(k).children().eq(1).html(f.product_amount))}}else{c===App.enumOrder.SINGLE&&(a.product_amount=e),App.rightDataOrder.push(a);var l=b(h).clone();b(l).children().eq(1).html(a.product_amount),b(l).removeAttr("class"),b("#bill-table-right").append(b(l))}g&&(console.log(g),c===App.enumOrder.SINGLE?(g.product_amount-=e,g.product_amount<=0?(b(h).remove(),b.each(App.leftDataOrder,function(a){return App.leftDataOrder[a].product_id===g.product_id?(App.leftDataOrder.splice(a,1),!1):void 0})):b(h).children().eq(1).html(g.product_amount)):(b(h).remove(),b.each(App.leftDataOrder,function(a){return App.leftDataOrder[a].product_id===g.product_id?(App.leftDataOrder.splice(a,1),!1):void 0})))}},findLeftOrder:function(a){for(var b=0;b<App.leftDataOrder.length;b++)if(a.product_id==App.leftDataOrder[b].product_id)return App.leftDataOrder[b];return!1},findRightOrder:function(a){for(var b=0;b<App.rightDataOrder.length;b++)if(a.product_id==App.rightDataOrder[b].product_id)return App.rightDataOrder[b];return!1},extractDataOrder:function(a){var c={};c.product_id=b(a).attr("id");for(var d=0;d<b(a).children().length;d++){var e=b(b(a).children()[d]);switch(d){case 0:c.product_name=e.text();case 1:c.product_amount=parseFloat(e.text());case 2:c.product_price=e.text()}}return c},resetHighlight:function(){b("#bill-table-right").find("tbody  > tr").removeClass("highlight-bill-right"),b("#bill-table-left").find("tbody  > tr").removeClass("highlight-bill-left"),console.log(App.leftDataOrder),console.log(App.rightDataOrder)},initSetLeftOrder:function(){console.log("INISIALISASI DATA LEFT ORDER");for(var a=b("#bill-table-left > tbody"),c=0;c<b(a).children().length;c++){var d=b(a).children()[c],e=App.extractDataOrder(d);App.leftDataOrder.push(e)}console.log(App.leftDataOrder)},updateTransfersField:function(){console.log("UPDATE FIELD"),b(".popup-block").hide(),b("#transfers").val(JSON.stringify(App.rightDataOrder)),0==App.rightDataOrder.length&&b("#transfers").val("")},eventOpname:function(){b("#tgl_opname").datetimepicker({sideBySide:!0,useCurrent:!0,format:"YYYY-MM-DD HH:mm"}),b("#tgl_opname").on("dp.change",function(a){console.log(b("#opname_date").val());var c=App.baseUrl+"admincms/stock/get_stock_by_date",d=b.ajax({type:"POST",url:c,data:{tgl_opname_value:b("#opname_date").val(),inventory_id:b("#inventory_id").val()}});d.done(function(a){var c=JSON.parse(a),d=parseInt(c[0].jumlah_stok);"null"!==d?b("#jumlah_stok").html(d):b("#jumlah_stok").html(0),App.updateDiffOpname()})}),b("#quantity_opname").on("keyup",function(){App.updateDiffOpname()})},updateDiffOpname:function(){var a=0,c=parseInt(b("#jumlah_stok").html());a=parseInt(b("#quantity_opname").val());var d=c-a;d*=-1,b("#diff_opname").html(d),b("#difference").val(d)},syncDatabaseToServer:function(a){App.overlayUI.show();var c=b.ajax({type:"POST",dataType:"json",url:App.baseUrl+"scheduler/"+a});c.done(function(a){a===!0?App.alert("Sinkronisasi ke server berhasil dilakukan."):a===!1&&App.alert("Sinkronisasi ke server gagal dilakukan."),App.overlayUI.hide()}),c.fail(function(a,b){App.overlayUI.hide()}),c.always(function(){})},reportReceiveStock:function(){var a=b("#is_in_report_page").length;a&&(b("#start_date_picker").datetimepicker({sideBySide:!0,useCurrent:!0,format:"YYYY-MM-DD"}),b("#end_date_picker").datetimepicker({sideBySide:!0,useCurrent:!0,format:"YYYY-MM-DD"}),b("#start_date").on("dp.change",function(a){b("#end_date_picker").datetimepicker({sideBySide:!0,useCurrent:!0,format:"YYYY-MM-DD"}),b("#end_date_picker").data("DateTimePicker").minDate(a.date)}),b("#filter_submit").on("click",function(a){a.preventDefault();b("#table-report-receive").dataTable({bProcessing:!0,bServerSide:!0,sServerMethod:"POST",bFilter:!1,bDestroy:!0,autoWidth:!1,iDisplayLength:10,ajax:{url:b("#dataProcessUrl").val(),type:"POST",data:{param:b("#formFilter").serialize()},dataSrc:function(a){return b("#export_pdf").show(),a.data}},columns:[{data:"incoming_date"},{data:"payment_no"},{data:"supplier_name"},{data:"inventory_name"},{data:"received_quantity"},{data:"price"},{data:"total_per_item"}],columnDefs:[{targets:6,orderable:!1}],order:[[0,"desc"]]})}),b("#export_pdf").on("click",function(a){a.preventDefault(),b.ajax({url:"export_report_to_pdf",type:"POST",dataType:"json",data:{type:"transaction",supplier_id:b("#supplier_id").val(),inventory_id:b("#inventory_id").val(),start_date:b("#start_date").val(),end_date:b("#end_date").val()},success:function(a){""!=a?window.open(App.baseUrl+a,"_newtab"):alert("Export report gagal")}})}))},topProductDashboard:function(){b("#sales_by_department_chart_pie").length>0&&b("#sales_by_department_chart_pie").highcharts({chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie"},title:{text:"Grafik Sales By Department"},tooltip:{pointFormat:"{series.name}: <b>{point.percentage:.1f}%</b>"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.percentage:.1f} %",style:{color:Highcharts.theme&&Highcharts.theme.contrastTextColor||"black"}}}},series:[{name:"Persentase",colorByPoint:!0,data:sales_by_department_series_data_pie}]}),b("#sales_by_day_chart").length>0&&(sales_by_day_chart=b("#sales_by_day_chart").highcharts({chart:{type:"column"},credits:{enabled:!1},title:{text:"Grafik Sales By Day Report"},xAxis:{categories:sales_by_day_categories_data,crosshair:!0,labels:{rotation:-45,style:{fontSize:"13px",fontFamily:"Verdana, sans-serif"}}},tooltip:{valueDecimals:0,valuePrefix:"Rp. "},yAxis:{title:{text:"Jumlah Revenue"}},legend:{enabled:!1},series:[{name:"Revenue",data:sales_by_day_series_data}]})),b("#customer_by_day_chart").length>0&&(customer_by_day_chart=b("#customer_by_day_chart").highcharts({chart:{type:"column"},credits:{enabled:!1},title:{text:"Grafik Customer By Day Report"},xAxis:{categories:customer_by_day_categories_data,crosshair:!0,labels:{rotation:-45,style:{fontSize:"13px",fontFamily:"Verdana, sans-serif"}}},tooltip:{valueDecimals:0,valuePrefix:""},yAxis:{title:{text:"Jumlah Pelanggan"}},legend:{enabled:!1},series:[{name:"Pelanggan",data:customer_by_day_series_data}]})),b("#sales_by_waiter_chart").length>0&&(sales_by_waiter_chart=b("#sales_by_waiter_chart").highcharts({chart:{type:"bar"},title:{text:"Grafik Sales By Waiter"},xAxis:{categories:sales_by_waiter_categories_data,title:null},yAxis:{min:0,title:{text:"Jumlah Revenue",align:"high"},labels:{overflow:"justify"}},tooltip:{valueDecimals:0,valuePrefix:"Rp. "},plotOptions:{bar:{dataLabels:{enabled:!0}}},legend:{layout:"vertical",align:"right",verticalAlign:"top",x:-40,y:80,floating:!0,borderWidth:1,backgroundColor:Highcharts.theme&&Highcharts.theme.legendBackgroundColor||"#FFFFFF",shadow:!0},credits:{enabled:!1},series:[{name:"Revenue",data:sales_by_waiter_series_data}]})),b("#goto_sales_by_waiter,#goto_sales_by_department").click(function(){url=b(this).attr("url"),b("#form_dashboard").attr("action",url),b("#form_dashboard").attr("target","_blank"),b("#form_dashboard").submit()})}}});